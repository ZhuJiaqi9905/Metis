{'DeviceType.A100': {'tp2_bs2': {'time': {'layer-computes': [1.7201900482177734, 32.2415828704834, 32.2415828704834, 32.2415828704834, 32.2415828704834, 32.2415828704834, 32.2415828704834, 32.2415828704834, 32.2415828704834, 0.469207763671875], 'fb_sync': 53.24146747589111}, 'memory': [4279, 2607.5, 2607.5, 2607.5, 2607.5, 2607.5, 2607.5, 2607.5, 2607.5, 8833]}, 'tp4_bs1': {'time': {'layer-computes': [1.0263919830322266, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 16.820335388183594}, 'memory': [2257.25, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 3067.75]}, 'tp2_bs1': {'time': {'layer-computes': [1.1625289916992188, 16.83783531188965, 16.83783531188965, 16.83783531188965, 16.83783531188965, 16.83783531188965, 16.83783531188965, 16.83783531188965, 16.83783531188965, 0.3528594970703125], 'fb_sync': 31.382155418395996}, 'memory': [4378, 2119.5, 2119.5, 2119.5, 2119.5, 2119.5, 2119.5, 2119.5, 2119.5, 6232]}, 'tp2_bs4': {'time': {'layer-computes': [2.507448196411133, 63.25173377990723, 63.25173377990723, 63.25173377990723, 63.25173377990723, 63.25173377990723, 63.25173377990723, 63.25173377990723, 63.25173377990723, 0.6699562072753906], 'fb_sync': 102.50520706176758}, 'memory': [4174, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 11930]}, 'tp1_bs4': {'time': {'layer-computes': [1.0962486267089844, 116.56570434570312, 116.56570434570312, 116.56570434570312, 116.56570434570312, 116.56570434570312, 116.56570434570312, 116.56570434570312, 116.56570434570312, 1.066446304321289], 'fb_sync': 209.2907428741455}, 'memory': [9078, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 26084]}, 'tp1_bs1': {'time': {'layer-computes': [0.2892017364501953, 29.507994651794434, 29.507994651794434, 29.507994651794434, 29.507994651794434, 29.507994651794434, 29.507994651794434, 29.507994651794434, 29.507994651794434, 0.4100799560546875], 'fb_sync': 56.03322982788086}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs4': {'time': {'layer-computes': [2.949237823486328, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 0.67901611328125], 'fb_sync': 45.07613182067871}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp4_bs2': {'time': {'layer-computes': [1.8298625946044922, 19.173383712768555, 19.173383712768555, 19.173383712768555, 19.173383712768555, 19.173383712768555, 19.173383712768555, 19.173383712768555, 19.173383712768555, 0.4038810729980469], 'fb_sync': 24.30126667022705}, 'memory': [2681.25, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 4679.25]}, 'tp1_bs2': {'time': {'layer-computes': [0.6282329559326172, 58.86340141296387, 58.86340141296387, 58.86340141296387, 58.86340141296387, 58.86340141296387, 58.86340141296387, 58.86340141296387, 58.86340141296387, 0.6556510925292969], 'fb_sync': 108.06832313537598}, 'memory': [8078, 4838.5, 4838.5, 4838.5, 4838.5, 4838.5, 4838.5, 4838.5, 4838.5, 14554]}}, 'model': {'optimizer_time': 40.603065490722656, 'num_layers': 10, 'batch_generator': 1.025700569152832, 'parameters': [393216000, 202383360, 202383360, 202383360, 202383360, 202383360, 202383360, 202383360, 202383360, 393220096]}, 'DeviceType.V100': {'tp4_bs1': {'time': {'layer-computes': [1.54, 16.32, 16.32, 16.32, 16.32, 16.32, 16.32, 16.32, 16.32, 0.505], 'fb_sync': 31.275000000000034}, 'memory': [2257.25, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 3067.75]}, 'tp4_bs2': {'time': {'layer-computes': [2.74, 28.76, 28.76, 28.76, 28.76, 28.76, 28.76, 28.76, 28.76, 0.605], 'fb_sync': 126.45500000000001}, 'memory': [2681.25, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 4679.25]}, 'tp1_bs2': {'time': {'layer-computes': [0.63, 58.86, 58.86, 58.86, 58.86, 58.86, 58.86, 58.86, 58.86, 0.66], 'fb_sync': 108.08999999999992}, 'memory': [800, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 3500]}, 'tp2_bs4': {'time': {'layer-computes': [3.76, 94.88, 94.88, 94.88, 94.88, 94.88, 94.88, 94.88, 94.88, 0.824], 'fb_sync': 34.59600000000012}, 'memory': [4174, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 11930]}, 'tp1_bs1': {'time': {'layer-computes': [0.3122434616088867, 44.26185369491577, 44.26185369491577, 44.26185369491577, 44.26185369491577, 44.26185369491577, 44.26185369491577, 44.26185369491577, 44.26185369491577, 0.5181255340576172], 'fb_sync': 161.9959545135498}, 'memory': [1500, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1500]}, 'tp2_bs1': {'time': {'layer-computes': [1.73, 32.5, 32.5, 32.5, 32.5, 32.5, 32.5, 32.5, 32.5, 0.52], 'fb_sync': -1.0199999999999818}, 'memory': [4378, 2119.5, 2119.5, 2119.5, 2119.5, 2119.5, 2119.5, 2119.5, 2119.5, 6232]}, 'tp2_bs2': {'time': {'layer-computes': [2.58, 48.36, 48.36, 48.36, 48.36, 48.36, 48.36, 48.36, 48.36, 0.73], 'fb_sync': 81.35999999999996}, 'memory': [4279, 2607.5, 2607.5, 2607.5, 2607.5, 2607.5, 2607.5, 2607.5, 2607.5, 8833]}, 'tp1_bs4': {'time': {'layer-computes': [1.64, 174.85, 174.85, 174.85, 174.85, 174.85, 174.85, 174.85, 174.85, 1.6], 'fb_sync': 313.9300000000003}, 'memory': [1420, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 3296]}, 'tp4_bs4': {'time': {'layer-computes': [4.42, 53.73, 53.73, 53.73, 53.73, 53.73, 53.73, 53.73, 53.73, 1.02], 'fb_sync': 68.05999999999995}, 'memory': [2591.75, 2067.0, 2067.0, 2067.0, 2067.0, 2067.0, 2067.0, 2067.0, 2067.0, 6305.75]}}}


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8], num_stage=1, batches=128, gbs=128)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: tp_deg(8)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8], num_stage=1, batches=64, gbs=128)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 4)]
stage_memory_capacity: [393216]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [144490.001], memory_state: [248725.999]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8], num_stage: 1, batches: 64, gbs: 128, strategies: [(2, 4)], layer_partition: [0, 10]
data loadbalancer: [1, 1]
execution_cost: 8486.719999999998, fb_sync_cost: 2001.6000000000022, parameter_upate_costs: 10.150766372680664, dp_cost: 12.467752207880434, pp_cost: 0.0
cost: 10576.583355006342


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8], num_stage=1, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
valid_strategies: [(4, 2)]
stage_memory_capacity: [393216]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [551320.0009999999], memory_state: [-158104.00099999993]
Even with the reallocation of layers, memory issues persist.
layer_partition: None
valid_strategies: [(2, 4)]
stage_memory_capacity: [393216]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [187645.001], memory_state: [205570.999]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8], num_stage: 1, batches: 32, gbs: 128, strategies: [(2, 4)], layer_partition: [0, 10]
data loadbalancer: [2, 2]
execution_cost: 7469.599999999999, fb_sync_cost: 4046.5600000000004, parameter_upate_costs: 10.150766372680664, dp_cost: 12.467752207880434, pp_cost: 0.0
cost: 11571.600936793451


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8], num_stage=1, batches=16, gbs=128)
valid_strategies: [(8, 1)]
stage_memory_capacity: [393216]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [2124800.001], memory_state: [-1731584.0010000002]
Even with the reallocation of layers, memory issues persist.
layer_partition: None
valid_strategies: [(4, 2)]
stage_memory_capacity: [393216]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [891040.0009999999], memory_state: [-497824.00099999993]
Even with the reallocation of layers, memory issues persist.
layer_partition: None
valid_strategies: [(2, 4)]
stage_memory_capacity: [393216]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [365480.001], memory_state: [27735.99900000001]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8], num_stage: 1, batches: 16, gbs: 128, strategies: [(2, 4)], layer_partition: [0, 10]
data loadbalancer: [5, 3]
execution_cost: 5973.094940185547, fb_sync_cost: 1088.9599999999991, parameter_upate_costs: 10.150766372680664, dp_cost: 12.467752207880434, pp_cost: 0.0
cost: 7101.084667872552


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8], num_stage=1, batches=8, gbs=128)
valid_strategies: [(8, 1)]
stage_memory_capacity: [393216]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [2453600.001], memory_state: [-2060384.0010000002]
Even with the reallocation of layers, memory issues persist.
layer_partition: None
valid_strategies: [(4, 2)]
stage_memory_capacity: [393216]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [1375440.001], memory_state: [-982224.0009999999]
Even with the reallocation of layers, memory issues persist.
layer_partition: None
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8], num_stage=1, batches=4, gbs=128)
valid_strategies: [(8, 1)]
stage_memory_capacity: [393216]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [5056280.001], memory_state: [-4663064.001]
Even with the reallocation of layers, memory issues persist.
layer_partition: None
invalid_strategy: dp_deg(4), batches(4), mbs(0)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8], num_stage=1, batches=2, gbs=128)
invalid_strategy: dp_deg(8), batches(2), mbs(0)
invalid_strategy: dp_deg(4), batches(2), mbs(0)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8], num_stage=1, batches=1, gbs=128)
invalid_strategy: dp_deg(8), batches(1), mbs(0)
invalid_strategy: dp_deg(4), batches(1), mbs(0)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4], num_stage=2, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 4), (1, 4)]
stage_memory_capacity: [327680, 65536]
stage_compute_performance: [0.6147527579585061, 0.3852472420414939]
layer_partition: [0, 6, 10]
stage_memory_demand: [39798.751, 32446.251], memory_state: [287881.249, 33089.748999999996]
layer_partition: [0, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4], num_stage: 2, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4)], layer_partition: [0, 6, 10]
execution_cost: 6719.69205078125, fb_sync_cost: 4003.2000000000044, parameter_upate_costs: 6.090459823608398, dp_cost: 0.0, pp_cost: 0.08695652173913043
cost: 10860.359139978165


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4], num_stage=2, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 2), (2, 2)]
stage_memory_capacity: [327680, 65536]
stage_compute_performance: [0.6581455807800592, 0.34185441921994075]
layer_partition: [0, 6, 10]
stage_memory_demand: [74877.501, 62952.501], memory_state: [252802.499, 2583.4990000000034]
layer_partition: [0, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4], num_stage: 2, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2)], layer_partition: [0, 6, 10]
execution_cost: 6358.631705551146, fb_sync_cost: -65.27999999999884, parameter_upate_costs: 12.180919647216797, dp_cost: 14.565641983695652, pp_cost: 0.08695652173913043
cost: 6385.8300601295805


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4], num_stage=2, batches=32, gbs=128)
valid_strategies: [(4, 1), (4, 1)]
stage_memory_capacity: [327680, 65536]
stage_compute_performance: [0.5998515030604687, 0.40014849693953125]
layer_partition: [0, 6, 10]
stage_memory_demand: [142750.001, 122850.001], memory_state: [184929.999, -57314.001000000004]
adj_stage_compute_performance(2): [0.8078818191797474, 0.19211818082025256]
layer_partition: [0, 7, 10]
stage_memory_demand: [163480.001, 102120.001], memory_state: [164199.999, -36584.001000000004]
adj_stage_compute_performance(3): [0.8890365131467981, 0.1109634868532019]
layer_partition: [0, 8, 10]
stage_memory_demand: [184210.001, 81390.001], memory_state: [143469.999, -15854.001000000004]
adj_stage_compute_performance(4): [0.9195860340759758, 0.08041396592402421]
layer_partition: None
valid_strategies: [(2, 2), (4, 1)]
stage_memory_capacity: [327680, 65536]
stage_compute_performance: [0.577069799386143, 0.422930200613857]
layer_partition: [0, 6, 10]
stage_memory_demand: [86582.501, 122850.001], memory_state: [241097.499, -57314.001000000004]
adj_stage_compute_performance(2): [0.7969439311222573, 0.2030560688777427]
layer_partition: [0, 7, 10]
stage_memory_demand: [99620.001, 102120.001], memory_state: [228059.999, -36584.001000000004]
adj_stage_compute_performance(3): [0.8827190152791462, 0.11728098472085376]
layer_partition: [0, 8, 10]
stage_memory_demand: [112657.501, 81390.001], memory_state: [215022.499, -15854.001000000004]
adj_stage_compute_performance(4): [0.9150078158470684, 0.08499218415293157]
layer_partition: None
valid_strategies: [(2, 2), (2, 2)]
stage_memory_capacity: [327680, 65536]
stage_compute_performance: [0.6000042495514271, 0.39999575044857294]
layer_partition: [0, 6, 10]
stage_memory_demand: [86582.501, 83277.501], memory_state: [241097.499, -17741.501000000004]
adj_stage_compute_performance(2): [0.7166976786292145, 0.2833023213707854]
layer_partition: [0, 7, 10]
stage_memory_demand: [99620.001, 70240.001], memory_state: [228059.999, -4704.001000000004]
adj_stage_compute_performance(3): [0.762103493705528, 0.2378965062944719]
layer_partition: [0, 7, 10]
stage_memory_demand: [99620.001, 70240.001], memory_state: [228059.999, -4704.001000000004]
adj_stage_compute_performance(4): [0.8002319662144785, 0.19976803378552144]
layer_partition: None
valid_strategies: [(1, 4), (2, 2)]
stage_memory_capacity: [327680, 65536]
stage_compute_performance: [0.5734640450472952, 0.42653595495270485]
layer_partition: [0, 6, 10]
stage_memory_demand: [64633.751, 83277.501], memory_state: [263046.249, -17741.501000000004]
adj_stage_compute_performance(2): [0.6979002250631606, 0.3020997749368394]
layer_partition: [0, 7, 10]
stage_memory_demand: [74968.751, 70240.001], memory_state: [252711.249, -4704.001000000004]
adj_stage_compute_performance(3): [0.7463187711908683, 0.2536812288091317]
layer_partition: [0, 7, 10]
stage_memory_demand: [74968.751, 70240.001], memory_state: [252711.249, -4704.001000000004]
adj_stage_compute_performance(4): [0.7869771142214004, 0.21302288577859968]
layer_partition: None
valid_strategies: [(1, 4), (1, 4)]
stage_memory_capacity: [327680, 65536]
stage_compute_performance: [0.5999734002807658, 0.40002659971923404]
layer_partition: [0, 6, 10]
stage_memory_demand: [64633.751, 62533.751], memory_state: [263046.249, 3002.2490000000034]
layer_partition: [0, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4], num_stage: 2, batches: 32, gbs: 128, strategies: [(1, 4), (1, 4)], layer_partition: [0, 6, 10]
execution_cost: 5988.3971337890625, fb_sync_cost: 2177.9199999999983, parameter_upate_costs: 6.090459823608398, dp_cost: 0.0, pp_cost: 0.34782608695652173
cost: 8205.577837912517


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4], num_stage=2, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1)]
stage_memory_capacity: [327680, 65536]
stage_compute_performance: [0.49998883088668283, 0.5000111691133173]
layer_partition: [0, 5, 10]
stage_memory_demand: [137160.001, 169540.001], memory_state: [190519.999, -104004.00099999999]
adj_stage_compute_performance(2): [0.8260477845513914, 0.1739522154486087]
layer_partition: [0, 8, 10]
stage_memory_demand: [209737.501, 96962.501], memory_state: [117942.49900000001, -31426.501000000004]
adj_stage_compute_performance(3): [0.8941846688497029, 0.10581533115029715]
layer_partition: [0, 8, 10]
stage_memory_demand: [209737.501, 96962.501], memory_state: [117942.49900000001, -31426.501000000004]
adj_stage_compute_performance(4): [0.9356324133178116, 0.06436758668218848]
layer_partition: None
valid_strategies: [(2, 2), (4, 1)]
stage_memory_capacity: [327680, 65536]
stage_compute_performance: [0.48113779522408096, 0.518862204775919]
layer_partition: [0, 5, 10]
stage_memory_demand: [101710.001, 169540.001], memory_state: [225969.999, -104004.00099999999]
adj_stage_compute_performance(2): [0.8194895722162042, 0.1805104277837958]
layer_partition: [0, 8, 10]
stage_memory_demand: [162340.001, 96962.501], memory_state: [165339.999, -31426.501000000004]
adj_stage_compute_performance(3): [0.890195300802782, 0.10980469919721808]
layer_partition: [0, 8, 10]
stage_memory_demand: [162340.001, 96962.501], memory_state: [165339.999, -31426.501000000004]
adj_stage_compute_performance(4): [0.9332056761826926, 0.06679432381730743]
layer_partition: None
valid_strategies: [(2, 2), (2, 2)]
stage_memory_capacity: [327680, 65536]
stage_compute_performance: [0.5999488026369068, 0.40005119736309336]
layer_partition: [0, 6, 10]
stage_memory_demand: [121920.001, 120280.001], memory_state: [205759.999, -54744.001000000004]
adj_stage_compute_performance(2): [0.803824579754128, 0.1961754202458721]
layer_partition: [0, 7, 10]
stage_memory_demand: [142130.001, 100070.001], memory_state: [185549.999, -34534.001000000004]
adj_stage_compute_performance(3): [0.8843719697063847, 0.11562803029361543]
layer_partition: [0, 8, 10]
stage_memory_demand: [162340.001, 79860.001], memory_state: [165339.999, -14324.001000000004]
adj_stage_compute_performance(4): [0.9146003174481536, 0.08539968255184649]
layer_partition: None
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4], num_stage=2, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1)]
stage_memory_capacity: [327680, 65536]
stage_compute_performance: [0.6000012847800784, 0.39999871521992153]
layer_partition: [0, 6, 10]
stage_memory_demand: [201865.001, 224305.001], memory_state: [125814.99900000001, -158769.001]
adj_stage_compute_performance(2): [0.8948178412634344, 0.10518215873656557]
layer_partition: [0, 8, 10]
stage_memory_demand: [264455.001, 161715.001], memory_state: [63224.99900000001, -96179.00099999999]
adj_stage_compute_performance(3): [0.9616368542120368, 0.03836314578796315]
layer_partition: [0, 9, 10]
stage_memory_demand: [295750.001, 130420.001], memory_state: [31929.99900000001, -64884.001000000004]
adj_stage_compute_performance(4): [0.9826502806872087, 0.017349719312791275]
layer_partition: None
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4], num_stage=2, batches=4, gbs=128)
invalid_strategy: dp_deg(4), batches(4), mbs(0)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4], num_stage=2, batches=2, gbs=128)
invalid_strategy: dp_deg(4), batches(2), mbs(0)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4], num_stage=2, batches=1, gbs=128)
invalid_strategy: dp_deg(4), batches(1), mbs(0)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 2, 2], num_stage=3, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 4), (1, 2), (1, 2)]
stage_memory_capacity: [327680, 32768, 32768]
stage_compute_performance: [0.6120912246495446, 0.1939543876752276, 0.1939543876752276]
layer_partition: [0, 6, 8, 10]
stage_memory_demand: [39798.751, 21195.001, 41757.501], memory_state: [287881.249, 11572.999, -8989.500999999997]
adj_stage_compute_performance(2): [0.6632616249759679, 0.19785598334582283, 0.1369801233509561]
layer_partition: [0, 6, 8, 10]
stage_memory_demand: [39798.751, 21195.001, 41757.501], memory_state: [287881.249, 11572.999, -8989.500999999997]
adj_stage_compute_performance(3): [0.6942543006115101, 0.19998025525962665, 0.09674209703707407]
layer_partition: [0, 6, 8, 10]
stage_memory_demand: [39798.751, 21195.001, 41757.501], memory_state: [287881.249, 11572.999, -8989.500999999997]
adj_stage_compute_performance(4): [0.7163171573481183, 0.2014014904580953, 0.06832402475760604]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 2, 2], num_stage=3, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 2), (2, 1), (2, 1)]
stage_memory_capacity: [327680, 32768, 32768]
stage_compute_performance: [0.5657428592256601, 0.21712857038716996, 0.21712857038716996]
layer_partition: [0, 5, 7, 10]
stage_memory_demand: [64280.001, 41460.001, 102120.001], memory_state: [263399.999, -8692.000999999997, -69352.001]
adj_stage_compute_performance(2): [0.7828482899556598, 0.15444722480836667, 0.06270448523597358]
layer_partition: [0, 7, 8, 10]
stage_memory_demand: [85475.001, 20730.001, 81390.001], memory_state: [242204.999, 12037.999, -48622.001000000004]
adj_stage_compute_performance(3): [0.8162436358571983, 0.1555328802617909, 0.02272061054515952]
layer_partition: [0, 8, 9, 10]
stage_memory_demand: [96072.501, 20730.001, 60660.001], memory_state: [231607.499, 12037.999, -27892.000999999997]
adj_stage_compute_performance(4): [0.8260496177954141, 0.15583193405152876, 0.011046126914989804]
layer_partition: None
valid_strategies: [(1, 4), (2, 1), (2, 1)]
stage_memory_capacity: [327680, 32768, 32768]
stage_compute_performance: [0.5327872615062896, 0.23360636924685518, 0.23360636924685518]
layer_partition: [0, 5, 7, 10]
stage_memory_demand: [41916.251, 41460.001, 102120.001], memory_state: [285763.749, -8692.000999999997, -69352.001]
adj_stage_compute_performance(2): [0.7663687350368071, 0.1661681618563602, 0.06746310310683268]
layer_partition: [0, 7, 8, 10]
stage_memory_demand: [56171.251, 20730.001, 81390.001], memory_state: [271508.749, 12037.999, -48622.001000000004]
adj_stage_compute_performance(3): [0.801721577588177, 0.16753405324667495, 0.024444868434689217]
layer_partition: [0, 8, 9, 10]
stage_memory_demand: [63298.751, 20730.001, 60660.001], memory_state: [264381.249, 12037.999, -27892.000999999997]
adj_stage_compute_performance(4): [0.812110981407311, 0.16790931552705318, 0.011884412992032536]
layer_partition: None
valid_strategies: [(1, 4), (1, 2), (2, 1)]
stage_memory_capacity: [327680, 32768, 32768]
stage_compute_performance: [0.5442786170041294, 0.21707650395434477, 0.2386448790415259]
layer_partition: [0, 5, 7, 10]
stage_memory_demand: [41916.251, 26075.001, 102120.001], memory_state: [285763.749, 6692.999, -69352.001]
adj_stage_compute_performance(2): [0.6903441997722601, 0.2336863262927074, 0.06891817261918602]
layer_partition: [0, 6, 8, 10]
stage_memory_demand: [49043.751, 26075.001, 81390.001], memory_state: [278636.249, 6692.999, -48622.001000000004]
adj_stage_compute_performance(3): [0.7231763545064679, 0.23649702302871747, 0.024972104526045386]
layer_partition: [0, 7, 9, 10]
stage_memory_demand: [56171.251, 26075.001, 60660.001], memory_state: [271508.749, 6692.999, -27892.000999999997]
adj_stage_compute_performance(4): [0.7328456225087274, 0.23727627388735475, 0.012140740469135661]
layer_partition: None
valid_strategies: [(1, 4), (1, 2), (1, 2)]
stage_memory_capacity: [327680, 32768, 32768]
stage_compute_performance: [0.5562765993511567, 0.2218617003244217, 0.2218617003244217]
layer_partition: [0, 5, 7, 10]
stage_memory_demand: [41916.251, 26075.001, 70240.001], memory_state: [285763.749, 6692.999, -37472.001000000004]
adj_stage_compute_performance(2): [0.6670435945112828, 0.23445754991264783, 0.09315159002642362]
layer_partition: [0, 6, 8, 10]
stage_memory_demand: [49043.751, 26075.001, 57202.501], memory_state: [278636.249, 6692.999, -24434.500999999997]
adj_stage_compute_performance(3): [0.7004338780055206, 0.23750985577273967, 0.048025036034478004]
layer_partition: [0, 7, 9, 10]
stage_memory_demand: [56171.251, 26075.001, 44165.001], memory_state: [271508.749, 6692.999, -11397.000999999997]
adj_stage_compute_performance(4): [0.712349656929392, 0.23853301159301735, 0.03206874019316784]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 2, 2], num_stage=3, batches=32, gbs=128)
valid_strategies: [(4, 1), (2, 1), (2, 1)]
stage_memory_capacity: [327680, 32768, 32768]
stage_compute_performance: [0.4992828154457884, 0.2503585922771058, 0.2503585922771058]
layer_partition: [0, 5, 7, 10]
stage_memory_demand: [122020.001, 48385.001, 121155.001], memory_state: [205659.999, -15617.000999999997, -88387.001]
adj_stage_compute_performance(2): [0.7864620695309983, 0.15259636589782405, 0.06094156457117755]
layer_partition: [0, 7, 8, 10]
stage_memory_demand: [163480.001, 24192.501, 96962.501], memory_state: [164199.999, 8575.499, -64194.501000000004]
adj_stage_compute_performance(3): [0.8219772510593104, 0.15371614412977516, 0.018535411633838855]
layer_partition: [0, 8, 9, 10]
stage_memory_demand: [184210.001, 24192.501, 72770.001], memory_state: [143469.999, 8575.499, -40002.001000000004]
adj_stage_compute_performance(4): [0.8312641668593601, 0.15398975749560387, 0.007511770290835484]
layer_partition: None
valid_strategies: [(2, 2), (2, 1), (2, 1)]
stage_memory_capacity: [327680, 32768, 32768]
stage_compute_performance: [0.47577920320382194, 0.2621103983980891, 0.2621103983980891]
layer_partition: [0, 5, 7, 10]
stage_memory_demand: [73545.001, 48385.001, 121155.001], memory_state: [254134.999, -15617.000999999997, -88387.001]
adj_stage_compute_performance(2): [0.7764386214219352, 0.15975922334356726, 0.0638021552344977]
layer_partition: [0, 7, 8, 10]
stage_memory_demand: [99620.001, 24192.501, 96962.501], memory_state: [228059.999, 8575.499, -64194.501000000004]
adj_stage_compute_performance(3): [0.8132591583933837, 0.1610520706414702, 0.01940546191616508]
layer_partition: [0, 8, 9, 10]
stage_memory_demand: [112657.501, 24192.501, 72770.001], memory_state: [215022.499, 8575.499, -40002.001000000004]
adj_stage_compute_performance(4): [0.822892524807213, 0.16136741425114826, 0.007864372002166217]
layer_partition: None
valid_strategies: [(1, 4), (2, 1), (2, 1)]
stage_memory_capacity: [327680, 32768, 32768]
stage_compute_performance: [0.448571692801981, 0.2757141535990095, 0.2757141535990095]
layer_partition: [0, 5, 7, 10]
stage_memory_demand: [54298.751, 48385.001, 121155.001], memory_state: [273381.249, -15617.000999999997, -88387.001]
adj_stage_compute_performance(2): [0.764835593517879, 0.16805086449453852, 0.06711354198758257]
layer_partition: [0, 7, 8, 10]
stage_memory_demand: [74968.751, 24192.501, 96962.501], memory_state: [252711.249, 8575.499, -64194.501000000004]
adj_stage_compute_performance(3): [0.8031237747683182, 0.16956634152915845, 0.02041262208638982]
layer_partition: [0, 8, 9, 10]
stage_memory_demand: [85303.751, 24192.501, 72770.001], memory_state: [242376.249, 8575.499, -40002.001000000004]
adj_stage_compute_performance(4): [0.8131475106409255, 0.16993527828903263, 0.008272539675712516]
layer_partition: None
valid_strategies: [(1, 4), (1, 2), (2, 1)]
stage_memory_capacity: [327680, 32768, 32768]
stage_compute_performance: [0.5013276041780909, 0.19053187273544855, 0.30814052308646067]
layer_partition: [0, 5, 7, 10]
stage_memory_demand: [54298.751, 40420.001, 121155.001], memory_state: [273381.249, -7652.000999999997, -88387.001]
adj_stage_compute_performance(2): [0.78597765381062, 0.13901567110836197, 0.07500667508101815]
layer_partition: [0, 7, 8, 10]
stage_memory_demand: [74968.751, 20210.001, 96962.501], memory_state: [252711.249, 12557.999, -64194.501000000004]
adj_stage_compute_performance(3): [0.8303269558998527, 0.14019454001654302, 0.02281332302009539]
layer_partition: [0, 8, 9, 10]
stage_memory_demand: [85303.751, 20210.001, 72770.001], memory_state: [242376.249, 12557.999, -40002.001000000004]
adj_stage_compute_performance(4): [0.8419349015947243, 0.1404776552719944, 0.009245461901948266]
layer_partition: None
valid_strategies: [(1, 4), (1, 2), (1, 2)]
stage_memory_capacity: [327680, 32768, 32768]
stage_compute_performance: [0.5681465535417104, 0.21592672322914477, 0.21592672322914477]
layer_partition: [0, 5, 7, 10]
stage_memory_demand: [54298.751, 40420.001, 100070.001], memory_state: [273381.249, -7652.000999999997, -67302.001]
adj_stage_compute_performance(2): [0.7788209271362533, 0.15754423608488669, 0.06363483677885996]
layer_partition: [0, 7, 8, 10]
stage_memory_demand: [74968.751, 20210.001, 79860.001], memory_state: [252711.249, 12557.999, -47092.001000000004]
adj_stage_compute_performance(3): [0.8122034842693909, 0.1586804020567124, 0.02349947000893119]
layer_partition: [0, 8, 9, 10]
stage_memory_demand: [85303.751, 20210.001, 59650.001], memory_state: [242376.249, 12557.999, -26882.000999999997]
adj_stage_compute_performance(4): [0.8221428629927977, 0.1589977777641541, 0.011618232327060508]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 2, 2], num_stage=3, batches=16, gbs=128)
valid_strategies: [(4, 1), (2, 1), (2, 1)]
stage_memory_capacity: [327680, 32768, 32768]
stage_compute_performance: [0.5975224772227105, 0.20123876138864472, 0.20123876138864472]
layer_partition: [0, 6, 8, 10]
stage_memory_demand: [161352.501, 62590.001, 161715.001], memory_state: [166327.499, -29822.000999999997, -128947.00099999999]
adj_stage_compute_performance(2): [0.8684812198199167, 0.09481981890150153, 0.036698961278581695]
layer_partition: [0, 8, 9, 10]
stage_memory_demand: [209737.501, 31295.001, 130420.001], memory_state: [117942.49900000001, 1472.9989999999998, -97652.001]
adj_stage_compute_performance(3): [0.8940861201764635, 0.09509498750065186, 0.008298546224201519]
layer_partition: [0, 8, 9, 10]
stage_memory_demand: [209737.501, 31295.001, 130420.001], memory_state: [117942.49900000001, 1472.9989999999998, -97652.001]
adj_stage_compute_performance(4): [0.8940861201764635, 0.09509498750065186, 0.001876507318897903]
layer_partition: None
valid_strategies: [(2, 2), (2, 1), (2, 1)]
stage_memory_capacity: [327680, 32768, 32768]
stage_compute_performance: [0.5792542299747009, 0.21037288501264956, 0.21037288501264956]
layer_partition: [0, 5, 7, 10]
stage_memory_demand: [101710.001, 62590.001, 193010.001], memory_state: [225969.999, -29822.000999999997, -160242.001]
adj_stage_compute_performance(2): [0.8687321752324902, 0.09912364159388734, 0.03214418317362245]
layer_partition: [0, 8, 9, 10]
stage_memory_demand: [162340.001, 31295.001, 130420.001], memory_state: [165339.999, 1472.9989999999998, -97652.001]
adj_stage_compute_performance(3): [0.891060109827384, 0.09938456105775068, 0.0072685978189030555]
layer_partition: [0, 8, 9, 10]
stage_memory_demand: [162340.001, 31295.001, 130420.001], memory_state: [165339.999, 1472.9989999999998, -97652.001]
adj_stage_compute_performance(4): [0.891060109827384, 0.09938456105775068, 0.001643610415221771]
layer_partition: None
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 2, 2], num_stage=3, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 2, 2], num_stage=3, batches=4, gbs=128)
invalid_strategy: dp_deg(4), batches(4), mbs(0)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 2, 2], num_stage=3, batches=2, gbs=128)
invalid_strategy: dp_deg(4), batches(2), mbs(0)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 2, 2], num_stage=3, batches=1, gbs=128)
invalid_strategy: dp_deg(4), batches(1), mbs(0)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[2, 4, 2], num_stage=3, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 4), (1, 2)]
stage_memory_capacity: [163840, 196608, 32768]
stage_compute_performance: [0.3165924401226892, 0.5189629021781901, 0.16444465769912062]
layer_partition: [0, 4, 8, 10]
stage_memory_demand: [53682.501, 22810.001, 41757.501], memory_state: [110157.49900000001, 173797.999, -8989.500999999997]
adj_stage_compute_performance(2): [0.3392028758544153, 0.5419829275830463, 0.11613890134700126]
layer_partition: [0, 4, 8, 10]
stage_memory_demand: [53682.501, 22810.001, 41757.501], memory_state: [110157.49900000001, 173797.999, -8989.500999999997]
adj_stage_compute_performance(3): [0.35233541985742545, 0.5548889691730192, 0.08202300150587756]
layer_partition: [0, 4, 8, 10]
stage_memory_demand: [53682.501, 22810.001, 41757.501], memory_state: [110157.49900000001, 173797.999, -8989.500999999997]
adj_stage_compute_performance(4): [0.36169284502102944, 0.563902553454489, 0.057928675904483286]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[2, 4, 2], num_stage=3, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 1), (2, 2), (2, 1)]
stage_memory_capacity: [163840, 196608, 32768]
stage_compute_performance: [0.38912106533104396, 0.35130434224848794, 0.25957459242046815]
layer_partition: [0, 4, 7, 10]
stage_memory_demand: [101290.001, 63585.001000000004, 102120.001], memory_state: [62549.998999999996, 133022.999, -69352.001]
adj_stage_compute_performance(2): [0.5163656540322743, 0.40580983907283474, 0.07496245735436792]
layer_partition: [0, 5, 8, 10]
stage_memory_demand: [122020.001, 63585.001000000004, 81390.001], memory_state: [41819.998999999996, 133022.999, -48622.001000000004]
adj_stage_compute_performance(3): [0.5497262408724375, 0.4173472378162278, 0.027162216429130345]
layer_partition: [0, 6, 9, 10]
stage_memory_demand: [142750.001, 63585.001000000004, 60660.001], memory_state: [21089.99900000001, 133022.999, -27892.000999999997]
adj_stage_compute_performance(4): [0.5576598332586188, 0.4199465535101203, 0.01320551176968772]
layer_partition: None
valid_strategies: [(1, 2), (2, 2), (2, 1)]
stage_memory_capacity: [163840, 196608, 32768]
stage_compute_performance: [0.3670023136101827, 0.3640243970476695, 0.2689732893421478]
layer_partition: [0, 4, 7, 10]
stage_memory_demand: [60507.501, 63585.001000000004, 102120.001], memory_state: [103332.49900000001, 133022.999, -69352.001]
adj_stage_compute_performance(2): [0.49305149445662444, 0.4262829413844095, 0.07767670380895463]
layer_partition: [0, 5, 8, 10]
stage_memory_demand: [73545.001, 63585.001000000004, 81390.001], memory_state: [90294.999, 133022.999, -48622.001000000004]
adj_stage_compute_performance(3): [0.5262216438833598, 0.4395806719164465, 0.028145708062721885]
layer_partition: [0, 5, 9, 10]
stage_memory_demand: [73545.001, 84780.00099999999, 60660.001], memory_state: [90294.999, 111827.99900000001, -27892.000999999997]
adj_stage_compute_performance(4): [0.5341013555528886, 0.4425765942737598, 0.01368365796135321]
layer_partition: None
valid_strategies: [(1, 2), (1, 4), (2, 1)]
stage_memory_capacity: [163840, 196608, 32768]
stage_compute_performance: [0.2937371149284352, 0.490985119580166, 0.21527776549139882]
layer_partition: [0, 3, 7, 10]
stage_memory_demand: [47470.001, 28510.001, 102120.001], memory_state: [116369.99900000001, 168097.999, -69352.001]
adj_stage_compute_performance(2): [0.364470954668323, 0.5649608242945495, 0.06216999192606687]
layer_partition: [0, 4, 9, 10]
stage_memory_demand: [60507.501, 35637.501, 60660.001], memory_state: [103332.49900000001, 160970.499, -27892.000999999997]
adj_stage_compute_performance(3): [0.3769978630359115, 0.5767640340840962, 0.030225315457710317]
layer_partition: [0, 4, 9, 10]
stage_memory_demand: [60507.501, 35637.501, 60660.001], memory_state: [103332.49900000001, 160970.499, -27892.000999999997]
adj_stage_compute_performance(4): [0.3831367190248065, 0.5824434664247992, 0.014694705053275987]
layer_partition: None
valid_strategies: [(1, 2), (1, 4), (1, 2)]
stage_memory_capacity: [163840, 196608, 32768]
stage_compute_performance: [0.2995656100891889, 0.5007275193248231, 0.19970687058598804]
layer_partition: [0, 3, 7, 10]
stage_memory_demand: [47470.001, 28510.001, 70240.001], memory_state: [116369.99900000001, 168097.999, -37472.001000000004]
adj_stage_compute_performance(2): [0.35309019705577965, 0.5567052388288164, 0.08384958966366601]
layer_partition: [0, 4, 8, 10]
stage_memory_demand: [60507.501, 28510.001, 57202.501], memory_state: [103332.49900000001, 168097.999, -24434.500999999997]
adj_stage_compute_performance(3): [0.3688548620564822, 0.5719144240463941, 0.043229316471479234]
layer_partition: [0, 4, 9, 10]
stage_memory_demand: [60507.501, 35637.501, 44165.001], memory_state: [103332.49900000001, 160970.499, -11397.000999999997]
adj_stage_compute_performance(4): [0.3744862459104615, 0.5772225178410904, 0.028866396220022468]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[2, 4, 2], num_stage=3, batches=32, gbs=128)
valid_strategies: [(2, 1), (4, 1), (2, 1)]
stage_memory_capacity: [163840, 196608, 32768]
stage_compute_performance: [0.30026055729907275, 0.39946547052543335, 0.30027397217549395]
layer_partition: [0, 4, 7, 10]
stage_memory_demand: [112967.501, 248760.001, 121155.001], memory_state: [50872.498999999996, -52152.00099999999, -88387.001]
Even with the reallocation of layers, memory issues persist.
layer_partition: None
valid_strategies: [(2, 1), (2, 2), (2, 1)]
stage_memory_capacity: [163840, 196608, 32768]
stage_compute_performance: [0.3133398353319412, 0.37330633011088915, 0.3133538345571696]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [88775.001, 102697.50099999999, 145347.501], memory_state: [75064.999, 93910.49900000001, -112579.50099999999]
adj_stage_compute_performance(2): [0.46261336949826515, 0.4699926240672084, 0.06357990706487897]
layer_partition: [0, 5, 9, 10]
stage_memory_demand: [137160.001, 136930.001, 72770.001], memory_state: [26679.99900000001, 59677.99900000001, -40002.001000000004]
adj_stage_compute_performance(3): [0.4813703404530698, 0.47959609903278455, 0.025766768303765154]
layer_partition: [0, 5, 9, 10]
stage_memory_demand: [137160.001, 136930.001, 72770.001], memory_state: [26679.99900000001, 59677.99900000001, -40002.001000000004]
adj_stage_compute_performance(4): [0.4890466750923211, 0.48341305925723826, 0.01044239256503513]
layer_partition: None
valid_strategies: [(1, 2), (2, 2), (2, 1)]
stage_memory_capacity: [163840, 196608, 32768]
stage_compute_performance: [0.2973411986197477, 0.38200407124269553, 0.3206547301375568]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [61290.001, 102697.50099999999, 145347.501], memory_state: [102549.99900000001, 93910.49900000001, -112579.50099999999]
adj_stage_compute_performance(2): [0.4435209204783287, 0.4876073665766766, 0.06506126842478507]
layer_partition: [0, 5, 9, 10]
stage_memory_demand: [101710.001, 136930.001, 72770.001], memory_state: [62129.998999999996, 59677.99900000001, -40002.001000000004]
adj_stage_compute_performance(3): [0.461951965293504, 0.4982186237711943, 0.026367113549565866]
layer_partition: [0, 5, 9, 10]
stage_memory_demand: [101710.001, 136930.001, 72770.001], memory_state: [62129.998999999996, 59677.99900000001, -40002.001000000004]
adj_stage_compute_performance(4): [0.4694965241206997, 0.5024407240757206, 0.010685692021812077]
layer_partition: None
valid_strategies: [(1, 2), (1, 4), (2, 1)]
stage_memory_capacity: [163840, 196608, 32768]
stage_compute_performance: [0.2608980563621314, 0.4577477409759027, 0.28135420266196587]
layer_partition: [0, 3, 7, 10]
stage_memory_demand: [61290.001, 41340.001, 121155.001], memory_state: [102549.99900000001, 155267.999, -88387.001]
adj_stage_compute_performance(2): [0.36018057171542606, 0.568700845151236, 0.06848642642118065]
layer_partition: [0, 4, 9, 10]
stage_memory_demand: [81500.001, 51675.001, 72770.001], memory_state: [82339.999, 144932.999, -40002.001000000004]
adj_stage_compute_performance(3): [0.3759743978872533, 0.5839685776971802, 0.02775521329005235]
layer_partition: [0, 4, 9, 10]
stage_memory_demand: [81500.001, 51675.001, 72770.001], memory_state: [82339.999, 144932.999, -40002.001000000004]
adj_stage_compute_performance(4): [0.38243957231168607, 0.5900773719343785, 0.011248241513416937]
layer_partition: None
valid_strategies: [(1, 2), (1, 4), (1, 2)]
stage_memory_capacity: [163840, 196608, 32768]
stage_compute_performance: [0.2922851099424669, 0.5128165792517465, 0.19489831080578646]
layer_partition: [0, 3, 7, 10]
stage_memory_demand: [61290.001, 41340.001, 100070.001], memory_state: [102549.99900000001, 155267.999, -67302.001]
adj_stage_compute_performance(2): [0.35372889014143405, 0.581483031960794, 0.05743764371138169]
layer_partition: [0, 4, 9, 10]
stage_memory_demand: [81500.001, 51675.001, 59650.001], memory_state: [82339.999, 144932.999, -26882.000999999997]
adj_stage_compute_performance(3): [0.36471289530938683, 0.5927097872157238, 0.028397401673490336]
layer_partition: [0, 4, 9, 10]
stage_memory_demand: [81500.001, 51675.001, 59650.001], memory_state: [82339.999, 144932.999, -26882.000999999997]
adj_stage_compute_performance(4): [0.37018216863517417, 0.5982122738162042, 0.014039789408104759]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[2, 4, 2], num_stage=3, batches=16, gbs=128)
valid_strategies: [(2, 1), (4, 1), (2, 1)]
stage_memory_capacity: [163840, 196608, 32768]
stage_compute_performance: [0.2742631286672664, 0.5428957643519156, 0.18284110698081804]
layer_partition: [0, 3, 7, 10]
stage_memory_demand: [107980.001, 387080.001, 193010.001], memory_state: [55859.998999999996, -190472.001, -160242.001]
Even with the reallocation of layers, memory issues persist.
layer_partition: None
valid_strategies: [(2, 1), (2, 2), (2, 1)]
stage_memory_capacity: [163840, 196608, 32768]
stage_compute_performance: [0.3226568996551445, 0.4622396520810624, 0.21510344826379305]
layer_partition: [0, 3, 7, 10]
stage_memory_demand: [107980.001, 217770.001, 193010.001], memory_state: [55859.998999999996, -21162.00099999999, -160242.001]
Even with the reallocation of layers, memory issues persist.
layer_partition: None
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[2, 4, 2], num_stage=3, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[2, 4, 2], num_stage=3, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[2, 4, 2], num_stage=3, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[2, 4, 2], num_stage=3, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[2, 2, 4], num_stage=3, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 2), (1, 4)]
stage_memory_capacity: [163840, 163840, 65536]
stage_compute_performance: [0.330333152026438, 0.330333152026438, 0.3393336959471241]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [43085.001, 31792.501, 32446.251], memory_state: [120754.99900000001, 132047.499, 33089.748999999996]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [2, 2, 4], num_stage: 3, batches: 128, gbs: 128, strategies: [(1, 2), (1, 2), (1, 4)], layer_partition: [0, 3, 6, 10]
execution_cost: 6550.031959381104, fb_sync_cost: 4003.2000000000044, parameter_upate_costs: 6.090459823608398, dp_cost: 0.0, pp_cost: 0.17391304347826086
cost: 10690.786005099757


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[2, 2, 4], num_stage=3, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 1), (2, 1), (2, 2)]
stage_memory_capacity: [163840, 163840, 65536]
stage_compute_performance: [0.34449318789723665, 0.34449318789723665, 0.3110136242055267]
layer_partition: [0, 4, 7, 10]
stage_memory_demand: [101290.001, 62190.001, 52355.001], memory_state: [62549.998999999996, 101649.99900000001, 13180.999000000003]
layer_partition: [0, 4, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [2, 2, 4], num_stage: 3, batches: 64, gbs: 128, strategies: [(2, 1), (2, 1), (2, 2)], layer_partition: [0, 4, 7, 10]
execution_cost: 5838.0878682327275, fb_sync_cost: -65.27999999999884, parameter_upate_costs: 16.241226196289062, dp_cost: 20.739639945652172, pp_cost: 0.17391304347826086
cost: 5875.607483843929


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[2, 2, 4], num_stage=3, batches=32, gbs=128)
valid_strategies: [(2, 1), (2, 1), (4, 1)]
stage_memory_capacity: [163840, 163840, 65536]
stage_compute_performance: [0.30026458531137834, 0.30026458531137834, 0.3994708293772433]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [88775.001, 72577.501, 122850.001], memory_state: [75064.999, 91262.499, -57314.001000000004]
adj_stage_compute_performance(2): [0.43655327833556024, 0.3684089318234693, 0.1917928209594424]
layer_partition: [0, 4, 7, 10]
stage_memory_demand: [112967.501, 72577.501, 102120.001], memory_state: [50872.498999999996, 91262.499, -36584.001000000004]
adj_stage_compute_performance(3): [0.49139693169267085, 0.38959127171735874, 0.11077556572838473]
layer_partition: [0, 5, 8, 10]
stage_memory_demand: [137160.001, 72577.501, 81390.001], memory_state: [26679.99900000001, 91262.499, -15854.001000000004]
adj_stage_compute_performance(4): [0.5084079625624196, 0.3955553939577692, 0.08027778164074331]
layer_partition: None
valid_strategies: [(2, 1), (2, 1), (2, 2)]
stage_memory_capacity: [163840, 163840, 65536]
stage_compute_performance: [0.31151125987806244, 0.31151125987806244, 0.3769774802438752]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [88775.001, 72577.501, 83277.501], memory_state: [75064.999, 91262.499, -17741.501000000004]
adj_stage_compute_performance(2): [0.3802476070852334, 0.34587943348164796, 0.26699932471240156]
layer_partition: [0, 4, 7, 10]
stage_memory_demand: [112967.501, 72577.501, 70240.001], memory_state: [50872.498999999996, 91262.499, -4704.001000000004]
adj_stage_compute_performance(3): [0.4082464944440407, 0.35801083987872423, 0.22420644569633127]
layer_partition: [0, 4, 7, 10]
stage_memory_demand: [112967.501, 72577.501, 70240.001], memory_state: [50872.498999999996, 91262.499, -4704.001000000004]
adj_stage_compute_performance(4): [0.4273915775824182, 0.36585510928611586, 0.1882721252045439]
layer_partition: None
valid_strategies: [(1, 2), (2, 1), (2, 2)]
stage_memory_capacity: [163840, 163840, 65536]
stage_compute_performance: [0.2955657996912775, 0.3187258882411075, 0.38570831206761513]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [61290.001, 72577.501, 83277.501], memory_state: [102549.99900000001, 91262.499, -17741.501000000004]
adj_stage_compute_performance(2): [0.36322332264805246, 0.35658077532574617, 0.2731830527154856]
layer_partition: [0, 4, 7, 10]
stage_memory_demand: [81500.001, 72577.501, 70240.001], memory_state: [82339.999, 91262.499, -4704.001000000004]
adj_stage_compute_performance(3): [0.3908403623789212, 0.3700116696764212, 0.22939908683210095]
layer_partition: [0, 4, 7, 10]
stage_memory_demand: [81500.001, 72577.501, 70240.001], memory_state: [82339.999, 91262.499, -4704.001000000004]
adj_stage_compute_performance(4): [0.40972689487107744, 0.3787069474594703, 0.19263252429574582]
layer_partition: None
valid_strategies: [(1, 2), (1, 2), (2, 2)]
stage_memory_capacity: [163840, 163840, 65536]
stage_compute_performance: [0.3025734270546896, 0.3025734270546896, 0.3948531458906208]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [61290.001, 60630.001, 83277.501], memory_state: [102549.99900000001, 103209.99900000001, -17741.501000000004]
adj_stage_compute_performance(2): [0.3745691412661154, 0.3385712841604025, 0.27966000315233946]
layer_partition: [0, 4, 7, 10]
stage_memory_demand: [81500.001, 60630.001, 70240.001], memory_state: [82339.999, 103209.99900000001, -4704.001000000004]
adj_stage_compute_performance(3): [0.40398200283282365, 0.3511933508166503, 0.23483795465681365]
layer_partition: [0, 4, 7, 10]
stage_memory_demand: [81500.001, 60630.001, 70240.001], memory_state: [82339.999, 103209.99900000001, -4704.001000000004]
adj_stage_compute_performance(4): [0.4241166416036381, 0.35933339170498596, 0.19719968649701536]
layer_partition: None
valid_strategies: [(1, 2), (1, 2), (1, 4)]
stage_memory_capacity: [163840, 163840, 65536]
stage_compute_performance: [0.3154771501208744, 0.3154771501208744, 0.3690456997582511]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [61290.001, 60630.001, 62533.751], memory_state: [102549.99900000001, 103209.99900000001, 3002.2490000000034]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [2, 2, 4], num_stage: 3, batches: 32, gbs: 128, strategies: [(1, 2), (1, 2), (1, 4)], layer_partition: [0, 3, 6, 10]
execution_cost: 6363.387358627319, fb_sync_cost: 2177.9199999999983, parameter_upate_costs: 6.090459823608398, dp_cost: 0.0, pp_cost: 0.6956521739130435
cost: 8580.91588883773


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[2, 2, 4], num_stage=3, batches=16, gbs=128)
valid_strategies: [(2, 1), (2, 1), (4, 1)]
stage_memory_capacity: [163840, 163840, 65536]
stage_compute_performance: [0.25128413049324577, 0.25128413049324577, 0.49743173901350834]
layer_partition: [0, 3, 5, 10]
stage_memory_demand: [107980.001, 62590.001, 169540.001], memory_state: [55859.998999999996, 101249.99900000001, -104004.00099999999]
adj_stage_compute_performance(2): [0.38127793627278617, 0.44566722339374953, 0.1730548403334642]
layer_partition: [0, 4, 8, 10]
stage_memory_demand: [139275.001, 125180.001, 96962.501], memory_state: [24564.99900000001, 38659.998999999996, -31426.501000000004]
adj_stage_compute_performance(3): [0.4202976525198047, 0.4702475196620192, 0.10526945684378045]
layer_partition: [0, 4, 8, 10]
stage_memory_demand: [139275.001, 125180.001, 96962.501], memory_state: [24564.99900000001, 38659.998999999996, -31426.501000000004]
adj_stage_compute_performance(4): [0.4446080673363353, 0.484610100250071, 0.06403553071864963]
layer_partition: None
valid_strategies: [(2, 1), (2, 1), (2, 2)]
stage_memory_capacity: [163840, 163840, 65536]
stage_compute_performance: [0.31017211565909547, 0.31017211565909547, 0.37965576868180906]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [107980.001, 93885.001, 120280.001], memory_state: [55859.998999999996, 69954.999, -54744.001000000004]
adj_stage_compute_performance(2): [0.4371445290598596, 0.37365832235947755, 0.18617399588064465]
layer_partition: [0, 4, 7, 10]
stage_memory_demand: [139275.001, 93885.001, 100070.001], memory_state: [24564.99900000001, 69954.999, -34534.001000000004]
adj_stage_compute_performance(3): [0.4885977822828003, 0.39392683328317607, 0.10973307669528788]
layer_partition: [0, 5, 8, 10]
stage_memory_demand: [170570.001, 93885.001, 79860.001], memory_state: [-6730.000999999989, 69954.999, -14324.001000000004]
adj_stage_compute_performance(4): [0.42238772446447137, 0.48882413581800105, 0.08104583197879184]
layer_partition: None
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[2, 2, 4], num_stage=3, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[2, 2, 4], num_stage=3, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[2, 2, 4], num_stage=3, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[2, 2, 4], num_stage=3, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 2, 2, 2], num_stage=4, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 2), (1, 2), (1, 2)]
stage_memory_capacity: [163840, 163840, 32768, 32768]
stage_compute_performance: [0.32907279039002957, 0.32907279039002957, 0.17092720960997035, 0.17092720960997035]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [53682.501, 31792.501, 10597.501, 41757.501], memory_state: [110157.49900000001, 132047.499, 22170.499, -8989.500999999997]
adj_stage_compute_performance(2): [0.3547560295650265, 0.34456192443995687, 0.17577924220319552, 0.12071719818792698]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [53682.501, 31792.501, 10597.501, 41757.501], memory_state: [110157.49900000001, 132047.499, 22170.499, -8989.500999999997]
adj_stage_compute_performance(3): [0.3732727260563188, 0.3552557452050695, 0.17908667611090193, 0.08525641980346939]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [53682.501, 31792.501, 10597.501, 41757.501], memory_state: [110157.49900000001, 132047.499, 22170.499, -8989.500999999997]
adj_stage_compute_performance(4): [0.383572572066603, 0.3610269103513875, 0.18085721586964773, 0.060212274860702915]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 2, 2, 2], num_stage=4, batches=64, gbs=128)
valid_strategies: [(2, 1), (2, 1), (2, 1), (2, 1)]
stage_memory_capacity: [163840, 163840, 32768, 32768]
stage_compute_performance: [0.2999257515302344, 0.2999257515302344, 0.20007424846976563, 0.20007424846976563]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 102120.001], memory_state: [83279.999, 122379.99900000001, -8692.000999999997, -69352.001]
adj_stage_compute_performance(2): [0.43121048442283205, 0.3655681179765332, 0.1423161971576304, 0.05777937346937112]
layer_partition: [0, 4, 7, 9, 10]
stage_memory_demand: [101290.001, 62190.001, 41460.001, 60660.001], memory_state: [62549.998999999996, 101649.99900000001, -8692.000999999997, -27892.000999999997]
adj_stage_compute_performance(3): [0.4790227060792733, 0.3841653614042779, 0.10123191829192454, 0.028090719267543657]
layer_partition: [0, 5, 8, 9, 10]
stage_memory_demand: [122020.001, 62190.001, 20730.001, 60660.001], memory_state: [41819.998999999996, 101649.99900000001, 12037.999, -27892.000999999997]
adj_stage_compute_performance(4): [0.4861919018623851, 0.3870591292121874, 0.10169070978048997, 0.013656923943390365]
layer_partition: None
valid_strategies: [(1, 2), (2, 1), (2, 1), (2, 1)]
stage_memory_capacity: [163840, 163840, 32768, 32768]
stage_compute_performance: [0.2805486444248351, 0.30822729015099065, 0.20561203271208708, 0.20561203271208708]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [47470.001, 41460.001, 41460.001, 102120.001], memory_state: [116369.99900000001, 122379.99900000001, -8692.000999999997, -69352.001]
adj_stage_compute_performance(2): [0.4090434191253174, 0.3821315408919794, 0.14625531675985015, 0.059378628277909073]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [60507.501, 62190.001, 20730.001, 81390.001], memory_state: [103332.49900000001, 101649.99900000001, 12037.999, -48622.001000000004]
adj_stage_compute_performance(3): [0.430220478848929, 0.3932827553457566, 0.1487835006168749, 0.02151550535390056]
layer_partition: [0, 5, 8, 9, 10]
stage_memory_demand: [73545.001, 62190.001, 20730.001, 60660.001], memory_state: [90294.999, 101649.99900000001, 12037.999, -27892.000999999997]
adj_stage_compute_performance(4): [0.43511224798927356, 0.39577584438823005, 0.14934516236424603, 0.010460238394868343]
layer_partition: None
valid_strategies: [(1, 2), (1, 2), (2, 1), (2, 1)]
stage_memory_capacity: [163840, 163840, 32768, 32768]
stage_compute_performance: [0.2885348996930715, 0.2885348996930715, 0.2114651003069285, 0.2114651003069285]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [47470.001, 26075.001, 41460.001, 102120.001], memory_state: [116369.99900000001, 137764.999, -8692.000999999997, -69352.001]
adj_stage_compute_performance(2): [0.4272940824576479, 0.3579144910753597, 0.15041870274368035, 0.0610689336574888]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [60507.501, 39112.501, 20730.001, 81390.001], memory_state: [103332.49900000001, 124727.49900000001, 12037.999, -48622.001000000004]
adj_stage_compute_performance(3): [0.4500850133524814, 0.36828643269664113, 0.15311018626326267, 0.02212797781240639]
layer_partition: [0, 5, 8, 9, 10]
stage_memory_demand: [73545.001, 39112.501, 20730.001, 60660.001], memory_state: [90294.999, 124727.49900000001, 12037.999, -27892.000999999997]
adj_stage_compute_performance(4): [0.45535269316018445, 0.37059979765816436, 0.15370733951404908, 0.01075800541548358]
layer_partition: None
valid_strategies: [(1, 2), (1, 2), (1, 2), (2, 1)]
stage_memory_capacity: [163840, 163840, 32768, 32768]
stage_compute_performance: [0.2941567968744161, 0.2941567968744161, 0.19610105895632596, 0.2155853472948419]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [47470.001, 26075.001, 26075.001, 102120.001], memory_state: [116369.99900000001, 137764.999, 6692.999, -69352.001]
adj_stage_compute_performance(2): [0.3734345736471236, 0.34370527575810256, 0.21674583810838957, 0.062258818369397013]
layer_partition: [0, 4, 7, 9, 10]
stage_memory_demand: [60507.501, 39112.501, 26075.001, 60660.001], memory_state: [103332.49900000001, 124727.49900000001, 6692.999, -27892.000999999997]
adj_stage_compute_performance(3): [0.38622660045824464, 0.3507709734620155, 0.21956169573711307, 0.03026850039609398]
layer_partition: [0, 4, 7, 9, 10]
stage_memory_demand: [60507.501, 39112.501, 26075.001, 60660.001], memory_state: [103332.49900000001, 124727.49900000001, 6692.999, -27892.000999999997]
adj_stage_compute_performance(4): [0.3925063002886699, 0.3541714259874735, 0.22090966080613422, 0.014715700365406963]
layer_partition: None
valid_strategies: [(1, 2), (1, 2), (1, 2), (1, 2)]
stage_memory_capacity: [163840, 163840, 32768, 32768]
stage_compute_performance: [0.3000021247757136, 0.3000021247757136, 0.1999978752242865, 0.1999978752242865]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [47470.001, 26075.001, 26075.001, 70240.001], memory_state: [116369.99900000001, 137764.999, 6692.999, -37472.001000000004]
adj_stage_compute_performance(2): [0.35625915971577227, 0.3351626782278877, 0.21464780751763596, 0.08397177183716836]
layer_partition: [0, 4, 7, 9, 10]
stage_memory_demand: [60507.501, 39112.501, 26075.001, 44165.001], memory_state: [103332.49900000001, 124727.49900000001, 6692.999, -11397.000999999997]
adj_stage_compute_performance(3): [0.36722904675560036, 0.34142511285726457, 0.21717488042694205, 0.05607218977769977]
layer_partition: [0, 4, 7, 9, 10]
stage_memory_demand: [60507.501, 39112.501, 26075.001, 44165.001], memory_state: [103332.49900000001, 124727.49900000001, 6692.999, -11397.000999999997]
adj_stage_compute_performance(4): [0.374618598994995, 0.34557032428863066, 0.21883922461330177, 0.03744223085542553]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 2, 2, 2], num_stage=4, batches=32, gbs=128)
valid_strategies: [(2, 1), (2, 1), (2, 1), (2, 1)]
stage_memory_capacity: [163840, 163840, 32768, 32768]
stage_compute_performance: [0.24999441544334142, 0.24999441544334142, 0.25000558455665867, 0.25000558455665867]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [88775.001, 48385.001, 48385.001, 121155.001], memory_state: [75064.999, 115454.99900000001, -15617.000999999997, -88387.001]
adj_stage_compute_performance(2): [0.4381900687983895, 0.3440922421208655, 0.152381203738682, 0.0608556364526573]
layer_partition: [0, 5, 8, 9, 10]
stage_memory_demand: [137160.001, 72577.501, 24192.501, 72770.001], memory_state: [26679.99900000001, 91262.499, 8575.499, -40002.001000000004]
adj_stage_compute_performance(3): [0.4599245479994056, 0.3531579625880337, 0.15491794323166894, 0.024662714320322833]
layer_partition: [0, 5, 8, 9, 10]
stage_memory_demand: [137160.001, 72577.501, 24192.501, 72770.001], memory_state: [26679.99900000001, 91262.499, 8575.499, -40002.001000000004]
adj_stage_compute_performance(4): [0.4668936166273468, 0.3559666938809825, 0.1557005277017665, 0.009994957133001891]
layer_partition: None
valid_strategies: [(1, 2), (2, 1), (2, 1), (2, 1)]
stage_memory_capacity: [163840, 163840, 32768, 32768]
stage_compute_performance: [0.23611792952865002, 0.25461977298211447, 0.25463114874461784, 0.25463114874461784]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [61290.001, 48385.001, 48385.001, 121155.001], memory_state: [102549.99900000001, 115454.99900000001, -15617.000999999997, -88387.001]
adj_stage_compute_performance(2): [0.4204940070277248, 0.3577795590608208, 0.1552005369155056, 0.06198157791156532]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [81500.001, 72577.501, 24192.501, 96962.501], memory_state: [82339.999, 91262.499, 8575.499, -64194.501000000004]
adj_stage_compute_performance(3): [0.4454120977448905, 0.36943070700938574, 0.1583175329620896, 0.018851732284685552]
layer_partition: [0, 5, 8, 9, 10]
stage_memory_demand: [101710.001, 72577.501, 24192.501, 72770.001], memory_state: [62129.998999999996, 91262.499, 8575.499, -40002.001000000004]
adj_stage_compute_performance(4): [0.4505436849251709, 0.37173886263333017, 0.15893118078901652, 0.007639964264314337]
layer_partition: None
valid_strategies: [(1, 2), (1, 2), (2, 1), (2, 1)]
stage_memory_capacity: [163840, 163840, 32768, 32768]
stage_compute_performance: [0.24056889761204048, 0.24056889761204048, 0.2594311023879595, 0.2594311023879595]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [61290.001, 40420.001, 48385.001, 121155.001], memory_state: [102549.99900000001, 123419.99900000001, -15617.000999999997, -88387.001]
adj_stage_compute_performance(2): [0.4358597584186218, 0.33821432801533113, 0.15812616241846916, 0.06314996874742125]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [81500.001, 60630.001, 24192.501, 96962.501], memory_state: [82339.999, 103209.99900000001, 8575.499, -64194.501000000004]
adj_stage_compute_performance(3): [0.4621938056960354, 0.34909443911425203, 0.16136740843283903, 0.019207099024023212]
layer_partition: [0, 5, 8, 9, 10]
stage_memory_demand: [101710.001, 60630.001, 24192.501, 72770.001], memory_state: [62129.998999999996, 103209.99900000001, 8575.499, -40002.001000000004]
adj_stage_compute_performance(4): [0.4676219279512715, 0.35124609394654377, 0.16200503363663787, 0.00778398228601472]
layer_partition: None
valid_strategies: [(1, 2), (1, 2), (1, 2), (2, 1)]
stage_memory_capacity: [163840, 163840, 32768, 32768]
stage_compute_performance: [0.2670073282928311, 0.2670073282928311, 0.17804286118879678, 0.2879424822255411]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 121155.001], memory_state: [102549.99900000001, 123419.99900000001, -7652.000999999997, -88387.001]
adj_stage_compute_performance(2): [0.44156442461294676, 0.3542858764528889, 0.1299034512119642, 0.0700901263812451]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [81500.001, 60630.001, 20210.001, 96962.501], memory_state: [82339.999, 103209.99900000001, 12557.999, -64194.501000000004]
adj_stage_compute_performance(3): [0.4712845717183297, 0.36675771412073777, 0.13272633916576895, 0.02131795192797858]
layer_partition: [0, 5, 8, 9, 10]
stage_memory_demand: [101710.001, 60630.001, 20210.001, 72770.001], memory_state: [62129.998999999996, 103209.99900000001, 12557.999, -40002.001000000004]
adj_stage_compute_performance(4): [0.4774396815832076, 0.36922226472318964, 0.13328127740320891, 0.008639438989404466]
layer_partition: None
valid_strategies: [(1, 2), (1, 2), (1, 2), (1, 2)]
stage_memory_capacity: [163840, 163840, 32768, 32768]
stage_compute_performance: [0.2999744013184533, 0.2999744013184533, 0.20002559868154665, 0.20002559868154665]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 100070.001], memory_state: [102549.99900000001, 123419.99900000001, -7652.000999999997, -67302.001]
adj_stage_compute_performance(2): [0.4280481768470611, 0.3640112890827572, 0.14594247377275496, 0.058948684689602716]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [81500.001, 60630.001, 20210.001, 79860.001], memory_state: [82339.999, 103209.99900000001, 12557.999, -47092.001000000004]
adj_stage_compute_performance(3): [0.44978105481721253, 0.374058985545246, 0.14840757319280956, 0.021768938494228316]
layer_partition: [0, 5, 8, 9, 10]
stage_memory_demand: [101710.001, 60630.001, 20210.001, 59650.001], memory_state: [62129.998999999996, 103209.99900000001, 12557.999, -26882.000999999997]
adj_stage_compute_performance(4): [0.45487278218240323, 0.37633453189930005, 0.1489630461559946, 0.010762650597792717]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 2, 2, 2], num_stage=4, batches=16, gbs=128)
valid_strategies: [(2, 1), (2, 1), (2, 1), (2, 1)]
stage_memory_capacity: [163840, 163840, 32768, 32768]
stage_compute_performance: [0.3000006423900392, 0.3000006423900392, 0.19999935760996077, 0.19999935760996077]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 193010.001], memory_state: [55859.998999999996, 101249.99900000001, -29822.000999999997, -160242.001]
adj_stage_compute_performance(2): [0.45519637705119137, 0.4200086398559055, 0.09423583577106628, 0.03055914732183684]
layer_partition: [0, 5, 8, 9, 10]
stage_memory_demand: [170570.001, 93885.001, 31295.001, 130420.001], memory_state: [-6730.000999999989, 69954.999, 1472.9989999999998, -97652.001]
adj_stage_compute_performance(3): [0.3935125554373449, 0.5001354318428028, 0.0975302793148317, 0.006910181863115877]
layer_partition: [0, 4, 8, 9, 10]
stage_memory_demand: [139275.001, 125180.001, 31295.001, 130420.001], memory_state: [24564.99900000001, 38659.998999999996, 1472.9989999999998, -97652.001]
adj_stage_compute_performance(4): [0.3935125554373449, 0.5001354318428028, 0.0975302793148317, 0.0015625636696745841]
layer_partition: None
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 2, 2, 2], num_stage=4, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 2, 2, 2], num_stage=4, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 2, 2, 2], num_stage=4, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 2, 2, 2], num_stage=4, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 1, 1, 1, 1], num_stage=5, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 4), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [327680, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.5163873199695448, 0.12090317000761379, 0.12090317000761379, 0.12090317000761379, 0.12090317000761379]
layer_partition: [0, 5, 6, 7, 8, 10]
stage_memory_demand: [34096.251, 20730.001, 20730.001, 20730.001, 81390.001], memory_state: [293583.749, -4346.001, -4346.001, -4346.001, -65006.001000000004]
adj_stage_compute_performance(2): [0.7200943115064994, 0.08600046780819112, 0.08600046780819112, 0.08600046780819112, 0.0219042850689272]
layer_partition: [0, 7, 7, 8, 9, 10]
stage_memory_demand: [45501.251, 0.001, 20730.001, 20730.001, 60660.001], memory_state: [282178.749, 16383.999, -4346.001, -4346.001, -44276.001]
adj_stage_compute_performance(3): [0.7792614368885864, 0.08675435542263994, 0.06117358595942485, 0.06117358595942485, 0.0053246261224488434]
layer_partition: [0, 7, 8, 8, 9, 10]
stage_memory_demand: [45501.251, 20730.001, 0.001, 20730.001, 60660.001], memory_state: [282178.749, -4346.001, 16383.999, -4346.001, -44276.001]
adj_stage_compute_performance(4): [0.8225943009679287, 0.06170983895852583, 0.06142119012465405, 0.04351380538395994, 0.001294342328665337]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 1, 1, 1, 1], num_stage=5, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 2), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [327680, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.4642579836237398, 0.13393550409406507, 0.13393550409406507, 0.13393550409406507, 0.13393550409406507]
layer_partition: [0, 5, 6, 7, 8, 10]
stage_memory_demand: [64280.001, 24192.501, 24192.501, 24192.501, 96962.501], memory_state: [263399.999, -7808.501, -7808.501, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.7347261557785094, 0.08163518807623263, 0.08163518807623263, 0.08163518807623263, 0.02036827999279274]
layer_partition: [0, 7, 8, 8, 9, 10]
stage_memory_demand: [85475.001, 24192.501, 0.001, 24192.501, 72770.001], memory_state: [242204.999, -7808.501, 16383.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.8067228741500649, 0.04975756038190908, 0.0824351320374675, 0.04975756038190908, 0.004127284668605743]
layer_partition: [0, 7, 7, 8, 8, 9]
stage_memory_demand: [85475.001, 0.001, 24192.501, 0.001, 24192.501], memory_state: [242204.999, 16383.999, -7808.501, 16383.999, -7808.501]
adj_stage_compute_performance(4): [0.8368127277105055, 0.04996135916642718, 0.05024513517522147, 0.04995016946749232, 0.002515626177276704]
layer_partition: None
valid_strategies: [(1, 4), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [327680, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.4313420697370234, 0.14216448256574418, 0.14216448256574418, 0.14216448256574418, 0.14216448256574418]
layer_partition: [0, 5, 6, 7, 8, 10]
stage_memory_demand: [41916.251, 24192.501, 24192.501, 24192.501, 96962.501], memory_state: [285763.749, -7808.501, -7808.501, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.7184277682227715, 0.0866508425119601, 0.0866508425119601, 0.0866508425119601, 0.02161970424134829]
layer_partition: [0, 7, 7, 8, 9, 10]
stage_memory_demand: [56171.251, 0.001, 24192.501, 24192.501, 72770.001], memory_state: [271508.749, 16383.999, -7808.501, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.7941999594281889, 0.08763447763402805, 0.05281465787040203, 0.05281465787040203, 0.004380864456236923]
layer_partition: [0, 7, 8, 8, 8, 9]
stage_memory_demand: [56171.251, 24192.501, 0.001, 0.001, 24192.501], memory_state: [271508.749, -7808.501, 16383.999, 16383.999, -7808.501]
adj_stage_compute_performance(4): [0.8259130511482544, 0.05341419448118754, 0.053062221899315816, 0.05304769135463483, 0.00267018589462442]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 1, 1, 1, 1], num_stage=5, batches=32, gbs=128)
valid_strategies: [(4, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [327680, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.5968431332788685, 0.10078921668028291, 0.10078921668028291, 0.10078921668028291, 0.10078921668028291]
layer_partition: [0, 6, 7, 7, 8, 10]
stage_memory_demand: [142750.001, 31295.001, 0.001, 31295.001, 161715.001], memory_state: [184929.999, -14911.001, 16383.999, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.787364595927218, 0.047489932129440734, 0.10543742125853543, 0.047489932129440734, 0.009190226412457432]
layer_partition: [0, 7, 7, 8, 8, 9]
stage_memory_demand: [163480.001, 0.001, 31295.001, 0.001, 31295.001], memory_state: [164199.999, 16383.999, -14911.001, 16383.999, -14911.001]
adj_stage_compute_performance(3): [0.8414567665214099, 0.04784113127972991, 0.04968007634541569, 0.047822228884391436, 0.004330257173902385]
layer_partition: [0, 8, 8, 8, 8, 9]
stage_memory_demand: [184210.001, 0.001, 0.001, 0.001, 31295.001], memory_state: [143469.999, 16383.999, 16383.999, 16383.999, -14911.001]
adj_stage_compute_performance(4): [0.8414567665214099, 0.04784113127972991, 0.04968007634541569, 0.047822228884391436, 0.0020403335402831594]
layer_partition: None
valid_strategies: [(2, 2), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [327680, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.5740117863361227, 0.10649705341596936, 0.10649705341596936, 0.10649705341596936, 0.10649705341596936]
layer_partition: [0, 5, 6, 7, 8, 10]
stage_memory_demand: [73545.001, 31295.001, 31295.001, 31295.001, 161715.001], memory_state: [254134.999, -14911.001, -14911.001, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.8397512543378921, 0.0501793545509239, 0.0501793545509239, 0.0501793545509239, 0.0097106820093364]
layer_partition: [0, 8, 8, 8, 8, 9]
stage_memory_demand: [112657.501, 0.001, 0.001, 0.001, 31295.001], memory_state: [215022.499, 16383.999, 16383.999, 16383.999, -14911.001]
adj_stage_compute_performance(3): [0.8397512543378921, 0.0501793545509239, 0.0501793545509239, 0.0501793545509239, 0.004575485798414604]
layer_partition: [0, 8, 8, 8, 8, 9]
stage_memory_demand: [112657.501, 0.001, 0.001, 0.001, 31295.001], memory_state: [215022.499, 16383.999, 16383.999, 16383.999, -14911.001]
adj_stage_compute_performance(4): [0.8397512543378921, 0.0501793545509239, 0.0501793545509239, 0.0501793545509239, 0.0021558805314977427]
layer_partition: None
valid_strategies: [(1, 4), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [327680, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.547048897332382, 0.11323777566690454, 0.11323777566690454, 0.11323777566690454, 0.11323777566690454]
layer_partition: [0, 5, 6, 7, 8, 10]
stage_memory_demand: [54298.751, 31295.001, 31295.001, 31295.001, 161715.001], memory_state: [273381.249, -14911.001, -14911.001, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.8296083231400694, 0.05335545267673607, 0.05335545267673607, 0.05335545267673607, 0.010325318829722593]
layer_partition: [0, 8, 8, 8, 8, 9]
stage_memory_demand: [85303.751, 0.001, 0.001, 0.001, 31295.001], memory_state: [242376.249, 16383.999, 16383.999, 16383.999, -14911.001]
adj_stage_compute_performance(3): [0.8296083231400694, 0.05335545267673607, 0.05335545267673607, 0.05335545267673607, 0.00486509079630825]
layer_partition: [0, 8, 8, 8, 8, 9]
stage_memory_demand: [85303.751, 0.001, 0.001, 0.001, 31295.001], memory_state: [242376.249, 16383.999, 16383.999, 16383.999, -14911.001]
adj_stage_compute_performance(4): [0.8296083231400694, 0.05335545267673607, 0.05335545267673607, 0.05335545267673607, 0.002292336812708296]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 1, 1, 1, 1], num_stage=5, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 1, 1, 1, 1], num_stage=5, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 1, 1, 1, 1], num_stage=5, batches=4, gbs=128)
invalid_strategy: dp_deg(4), batches(4), mbs(0)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 1, 1, 1, 1], num_stage=5, batches=2, gbs=128)
invalid_strategy: dp_deg(4), batches(2), mbs(0)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 1, 1, 1, 1], num_stage=5, batches=1, gbs=128)
invalid_strategy: dp_deg(4), batches(1), mbs(0)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 4, 1, 1], num_stage=5, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 4), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 196608, 16384, 16384]
stage_compute_performance: [0.16172571537176728, 0.16172571537176728, 0.4607808280995025, 0.10788387057848137, 0.10788387057848137]
layer_partition: [0, 2, 3, 7, 8, 10]
stage_memory_demand: [59830.001, 20730.001, 22810.001, 20730.001, 81390.001], memory_state: [22089.999000000003, 61189.998999999996, 173797.999, -4346.001, -65006.001000000004]
adj_stage_compute_performance(2): [0.19276888395847097, 0.18636710873119627, 0.5165096419866024, 0.0767396201284339, 0.01954555083494906]
layer_partition: [0, 3, 4, 8, 9, 10]
stage_memory_demand: [80560.001, 20730.001, 22810.001, 20730.001, 60660.001], memory_state: [1359.9989999999962, 61189.998999999996, 173797.999, -4346.001, -44276.001]
adj_stage_compute_performance(3): [0.19602317251557558, 0.19637293288783397, 0.5379964936127414, 0.05458618851807266, 0.004751250735914509]
layer_partition: [0, 3, 5, 9, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 22810.001, 0.001, 60660.001], memory_state: [1359.9989999999962, 40459.999, 173797.999, 16383.999, -44276.001]
adj_stage_compute_performance(4): [0.19602317251557558, 0.19637293288783397, 0.5379964936127414, 0.05458618851807266, 0.001154962771126578]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 4, 1, 1], num_stage=5, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(1, 1), (1, 1), (2, 2), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 196608, 16384, 16384]
stage_compute_performance: [0.1723951454949353, 0.1723951454949353, 0.3104040136688301, 0.17240284767064973, 0.17240284767064973]
layer_partition: [0, 2, 3, 6, 8, 10]
stage_memory_demand: [64582.501, 24192.501, 63585.001000000004, 48385.001, 96962.501], memory_state: [17337.499000000003, 57727.498999999996, 133022.999, -32001.000999999997, -80578.501]
adj_stage_compute_performance(2): [0.2186754941395828, 0.2676360338984761, 0.4304381309397143, 0.05254073324525369, 0.02621821224075411]
layer_partition: [0, 3, 5, 9, 9, 10]
stage_memory_demand: [88775.001, 48385.001, 84780.00099999999, 0.001, 72770.001], memory_state: [-6855.001000000004, 33534.999, 111827.99900000001, 16383.999, -56386.001000000004]
adj_stage_compute_performance(3): [0.1816108887672461, 0.2935815589987809, 0.45728783863199596, 0.05393870240186341, 0.005312673699389723]
layer_partition: [0, 3, 5, 9, 9, 10]
stage_memory_demand: [88775.001, 48385.001, 84780.00099999999, 0.001, 72770.001], memory_state: [-6855.001000000004, 33534.999, 111827.99900000001, 16383.999, -56386.001000000004]
adj_stage_compute_performance(4): [0.15082858300425725, 0.3063557509037999, 0.46992691591904057, 0.05458244760195274, 0.0010765227459832122]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 4), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 196608, 16384, 16384]
stage_compute_performance: [0.14215993709305133, 0.14215993709305133, 0.4313475489404667, 0.14216628843671536, 0.14216628843671536]
layer_partition: [0, 2, 3, 7, 8, 10]
stage_memory_demand: [64582.501, 24192.501, 28510.001, 24192.501, 96962.501], memory_state: [17337.499000000003, 57727.498999999996, 168097.999, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.1803234911367518, 0.18176699268233712, 0.527160963714424, 0.08665194321051924, 0.02161997886969139]
layer_partition: [0, 2, 4, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 28510.001, 24192.501, 72770.001], memory_state: [17337.499000000003, 33534.999, 168097.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.19335555769091511, 0.19223956881918342, 0.5513252553621508, 0.05281532875848728, 0.0043809201049883366]
layer_partition: [0, 2, 4, 8, 8, 9]
stage_memory_demand: [64582.501, 48385.001, 28510.001, 0.001, 24192.501], memory_state: [17337.499000000003, 33534.999, 168097.999, 16383.999, -7808.501]
adj_stage_compute_performance(4): [0.19335555769091511, 0.19223956881918342, 0.5513252553621508, 0.05281532875848728, 0.0026702198131609467]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 4, 1, 1], num_stage=5, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (4, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 196608, 16384, 16384]
stage_compute_performance: [0.1675938527273285, 0.1675938527273285, 0.4413550204688062, 0.11172863703826846, 0.11172863703826846]
layer_partition: [0, 2, 3, 7, 8, 10]
stage_memory_demand: [76685.001, 31295.001, 331680.001, 31295.001, 161715.001], memory_state: [5234.998999999996, 50624.998999999996, -135072.001, -14911.001, -145331.001]
Even with the reallocation of layers, memory issues persist.
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (2, 2), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 196608, 16384, 16384]
stage_compute_performance: [0.17569675747181485, 0.17569675747181485, 0.4143453958228978, 0.11713054461673633, 0.11713054461673633]
layer_partition: [0, 2, 4, 7, 8, 10]
stage_memory_demand: [76685.001, 62590.001, 102697.50099999999, 31295.001, 161715.001], memory_state: [5234.998999999996, 19329.999000000003, 93910.49900000001, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.1876909197939643, 0.2299581105948708, 0.5136061412996924, 0.05518965021603762, 0.0106802717621759]
layer_partition: [0, 2, 4, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 136930.001, 0.001, 31295.001], memory_state: [5234.998999999996, 19329.999000000003, 59677.99900000001, 16383.999, -14911.001]
adj_stage_compute_performance(3): [0.1876909197939643, 0.2299581105948708, 0.5136061412996924, 0.05518965021603762, 0.005032337762070721]
layer_partition: [0, 2, 4, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 136930.001, 0.001, 31295.001], memory_state: [5234.998999999996, 19329.999000000003, 59677.99900000001, 16383.999, -14911.001]
adj_stage_compute_performance(4): [0.1876909197939643, 0.2299581105948708, 0.5136061412996924, 0.05518965021603762, 0.0023711403525563087]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 4), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 196608, 16384, 16384]
stage_compute_performance: [0.1525795288515454, 0.1525795288515454, 0.49140265955440027, 0.10171914137125448, 0.10171914137125448]
layer_partition: [0, 2, 3, 7, 8, 10]
stage_memory_demand: [76685.001, 31295.001, 41340.001, 31295.001, 161715.001], memory_state: [5234.998999999996, 50624.998999999996, 155267.999, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.16299556419799224, 0.18856191024232216, 0.5836342528737917, 0.047928094682085816, 0.009275019396648121]
layer_partition: [0, 2, 4, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 51675.001, 0.001, 130420.001], memory_state: [5234.998999999996, 19329.999000000003, 144932.999, 16383.999, -114036.001]
adj_stage_compute_performance(3): [0.16299556419799224, 0.18856191024232216, 0.5836342528737917, 0.047928094682085816, 0.0010486560724318238]
layer_partition: [0, 2, 4, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 51675.001, 0.001, 130420.001], memory_state: [5234.998999999996, 19329.999000000003, 144932.999, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.16299556419799224, 0.18856191024232216, 0.5836342528737917, 0.047928094682085816, 0.00011856358582339454]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 4, 1, 1], num_stage=5, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 4, 1, 1], num_stage=5, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 4, 1, 1], num_stage=5, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 4, 1, 1], num_stage=5, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 4, 1, 1], num_stage=5, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 4], num_stage=5, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 4)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 65536]
stage_compute_performance: [0.17284658120131174, 0.17284658120131174, 0.17284658120131174, 0.17284658120131174, 0.30861367519475297]
layer_partition: [0, 2, 4, 5, 6, 10]
stage_memory_demand: [59830.001, 41460.001, 20730.001, 20730.001, 32446.251], memory_state: [22089.999000000003, 40459.999, 61189.998999999996, 61189.998999999996, 33089.748999999996]
layer_partition: [0, 2, 4, 5, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [1, 1, 1, 1, 4], num_stage: 5, batches: 128, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 4)], layer_partition: [0, 2, 4, 5, 6, 10]
execution_cost: 7692.324816551209, fb_sync_cost: 4003.2000000000044, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.34782608695652173
cost: 11835.282928587876


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 4], num_stage=5, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 2)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 65536]
stage_compute_performance: [0.1723978011712501, 0.1723978011712501, 0.1723978011712501, 0.1723978011712501, 0.3104087953149997]
layer_partition: [0, 2, 4, 5, 6, 10]
stage_memory_demand: [64582.501, 48385.001, 24192.501, 24192.501, 62952.501], memory_state: [17337.499000000003, 33534.999, 57727.498999999996, 57727.498999999996, 2583.4990000000034]
layer_partition: [0, 2, 4, 5, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [1, 1, 1, 1, 4], num_stage: 5, batches: 64, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 2)], layer_partition: [0, 2, 4, 5, 6, 10]
execution_cost: 7809.7538180542, fb_sync_cost: -65.27999999999884, parameter_upate_costs: 8.120613098144531, dp_cost: 9.5402734375, pp_cost: 0.6956521739130435
cost: 7828.47519318954


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 4], num_stage=5, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (4, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 65536]
stage_compute_performance: [0.1507504409315991, 0.1507504409315991, 0.1507504409315991, 0.1507504409315991, 0.39699823627360364]
layer_partition: [0, 2, 4, 5, 6, 10]
stage_memory_demand: [76685.001, 62590.001, 31295.001, 31295.001, 122850.001], memory_state: [5234.998999999996, 19329.999000000003, 50624.998999999996, 50624.998999999996, -57314.001000000004]
adj_stage_compute_performance(2): [0.1610416112678488, 0.19730749199247652, 0.24071070099969155, 0.20507709149220038, 0.19060568645159554]
layer_partition: [0, 2, 4, 6, 8, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 81390.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 19329.999000000003, -15854.001000000004]
adj_stage_compute_performance(3): [0.17155077794233334, 0.2126764378708929, 0.25447974502635845, 0.21302243623936246, 0.13812975429945737]
layer_partition: [0, 2, 4, 6, 8, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 81390.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 19329.999000000003, -15854.001000000004]
adj_stage_compute_performance(4): [0.18162362823129136, 0.22264885426827, 0.26343276308866426, 0.21827771618173458, 0.10010104828469427]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 2)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 65536]
stage_compute_performance: [0.15636068090715835, 0.15636068090715835, 0.15636068090715835, 0.15636068090715835, 0.3745572763713666]
layer_partition: [0, 2, 4, 5, 6, 10]
stage_memory_demand: [76685.001, 62590.001, 31295.001, 31295.001, 83277.501], memory_state: [5234.998999999996, 19329.999000000003, 50624.998999999996, 50624.998999999996, -17741.501000000004]
adj_stage_compute_performance(2): [0.1670348414015723, 0.19898374561302218, 0.18683018097801682, 0.1782142736546093, 0.26528518306338816]
layer_partition: [0, 2, 4, 6, 7, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 70240.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 50624.998999999996, -4704.001000000004]
adj_stage_compute_performance(3): [0.17843768702065743, 0.21111119349470112, 0.19511762066841004, 0.18409926411504096, 0.22276703528973446]
layer_partition: [0, 2, 4, 6, 7, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 70240.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 50624.998999999996, -4704.001000000004]
adj_stage_compute_performance(4): [0.1893444671824915, 0.22101998386896565, 0.2017608172363339, 0.1887764456068697, 0.1870634139409143]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 4)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 65536]
stage_compute_performance: [0.16267233910933593, 0.16267233910933593, 0.16267233910933593, 0.16267233910933593, 0.3493106435626564]
layer_partition: [0, 2, 4, 5, 6, 10]
stage_memory_demand: [76685.001, 62590.001, 31295.001, 31295.001, 62533.751], memory_state: [5234.998999999996, 19329.999000000003, 50624.998999999996, 50624.998999999996, 3002.2490000000034]
layer_partition: [0, 2, 4, 5, 6, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [1, 1, 1, 1, 4], num_stage: 5, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 4)], layer_partition: [0, 2, 4, 5, 6, 10]
execution_cost: 7973.208439788818, fb_sync_cost: 2177.9199999999983, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 1.391304347826087
cost: 10193.462775447677


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 4], num_stage=5, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 4], num_stage=5, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 4], num_stage=5, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 4], num_stage=5, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 4], num_stage=5, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[2, 2, 2, 1, 1], num_stage=5, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 2), (1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 163840, 32768, 16384, 16384]
stage_compute_performance: [0.30422802478263733, 0.30422802478263733, 0.15802232478600164, 0.11676081282436176, 0.11676081282436176]
layer_partition: [0, 3, 6, 7, 8, 10]
stage_memory_demand: [43085.001, 31792.501, 10597.501, 20730.001, 81390.001], memory_state: [120754.99900000001, 132047.499, 22170.499, -4346.001, -65006.001000000004]
adj_stage_compute_performance(2): [0.3746528885127077, 0.3467000878791356, 0.17132686678179468, 0.08305393914756246, 0.021153805386768688]
layer_partition: [0, 4, 7, 8, 9, 10]
stage_memory_demand: [53682.501, 31792.501, 10597.501, 20730.001, 60660.001], memory_state: [110157.49900000001, 132047.499, 22170.499, -4346.001, -44276.001]
adj_stage_compute_performance(3): [0.3962489769477034, 0.35829737991209937, 0.17483203548452733, 0.059077670333653, 0.005142194981354127]
layer_partition: [0, 4, 7, 8, 9, 10]
stage_memory_demand: [53682.501, 31792.501, 10597.501, 20730.001, 60660.001], memory_state: [110157.49900000001, 132047.499, 22170.499, -4346.001, -44276.001]
adj_stage_compute_performance(4): [0.4051798896738333, 0.3629298369264595, 0.17622100888639403, 0.04202294518325945, 0.0012499958632881563]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[2, 2, 2, 1, 1], num_stage=5, batches=64, gbs=128)
valid_strategies: [(2, 1), (2, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 163840, 32768, 16384, 16384]
stage_compute_performance: [0.2724831189917157, 0.2724831189917157, 0.1817678374558298, 0.13663296228036942, 0.13663296228036942]
layer_partition: [0, 3, 5, 7, 8, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 24192.501, 96962.501], memory_state: [83279.999, 122379.99900000001, -8692.000999999997, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.41796154360189175, 0.34522233129680374, 0.12929453735366211, 0.08327931901713738, 0.020778496715976986]
layer_partition: [0, 4, 7, 8, 9, 10]
stage_memory_demand: [101290.001, 62190.001, 20730.001, 24192.501, 72770.001], memory_state: [62549.998999999996, 101649.99900000001, 12037.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.44735908639104927, 0.35813236938708864, 0.13225938031557655, 0.050759676583214806, 0.004210408093509718]
layer_partition: [0, 5, 8, 9, 9, 10]
stage_memory_demand: [122020.001, 62190.001, 20730.001, 0.001, 72770.001], memory_state: [41819.998999999996, 101649.99900000001, 12037.999, 16383.999, -56386.001000000004]
adj_stage_compute_performance(4): [0.44735908639104927, 0.35813236938708864, 0.13225938031557655, 0.050759676583214806, 0.0008531674141883947]
layer_partition: None
valid_strategies: [(1, 2), (2, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 163840, 32768, 16384, 16384]
stage_compute_performance: [0.2542351187148498, 0.279317698587877, 0.18632704375716308, 0.1400600694700551, 0.1400600694700551]
layer_partition: [0, 3, 5, 7, 8, 10]
stage_memory_demand: [47470.001, 41460.001, 41460.001, 24192.501, 96962.501], memory_state: [116369.99900000001, 122379.99900000001, -8692.000999999997, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.39626226227543765, 0.36100514194263544, 0.13253757791398144, 0.08536817918815603, 0.021299675019496915]
layer_partition: [0, 4, 7, 8, 9, 10]
stage_memory_demand: [60507.501, 62190.001, 20730.001, 24192.501, 72770.001], memory_state: [103332.49900000001, 101649.99900000001, 12037.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.42495749711106134, 0.3755052211120387, 0.13570125753897067, 0.05203286022544232, 0.004316015990813216]
layer_partition: [0, 4, 7, 8, 9, 10]
stage_memory_demand: [60507.501, 62190.001, 20730.001, 24192.501, 72770.001], memory_state: [103332.49900000001, 101649.99900000001, 12037.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(4): [0.4357428535025445, 0.3807093663558664, 0.13682758321393795, 0.031714610396844964, 0.0008745670539998392]
layer_partition: None
valid_strategies: [(1, 2), (1, 2), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 163840, 32768, 16384, 16384]
stage_compute_performance: [0.26077605494190303, 0.26077605494190303, 0.19112084768461304, 0.14366352121579049, 0.14366352121579049]
layer_partition: [0, 3, 5, 7, 8, 10]
stage_memory_demand: [47470.001, 26075.001, 41460.001, 24192.501, 96962.501], memory_state: [116369.99900000001, 137764.999, -8692.000999999997, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.4137401888639748, 0.3372581219029389, 0.13594749173393558, 0.0875645233388462, 0.02184767097168379]
layer_partition: [0, 4, 7, 8, 9, 10]
stage_memory_demand: [60507.501, 39112.501, 20730.001, 24192.501, 72770.001], memory_state: [103332.49900000001, 124727.49900000001, 12037.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.4445575081746827, 0.35066051563627765, 0.13929568158335284, 0.05337155655569842, 0.004427058027387693]
layer_partition: [0, 4, 7, 8, 8, 9]
stage_memory_demand: [60507.501, 39112.501, 20730.001, 0.001, 24192.501], memory_state: [103332.49900000001, 124727.49900000001, 12037.999, 16383.999, -7808.501]
adj_stage_compute_performance(4): [0.4445575081746827, 0.35066051563627765, 0.13929568158335284, 0.05337155655569842, 0.0026983413930063687]
layer_partition: None
valid_strategies: [(1, 2), (1, 2), (1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 163840, 32768, 16384, 16384]
stage_compute_performance: [0.26535967163219804, 0.26535967163219804, 0.17690331538928597, 0.14618867067315902, 0.14618867067315902]
layer_partition: [0, 3, 5, 7, 8, 10]
stage_memory_demand: [47470.001, 26075.001, 26075.001, 24192.501, 96962.501], memory_state: [116369.99900000001, 137764.999, 6692.999, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.35896780019808655, 0.3238645965985737, 0.20127987108687262, 0.08910363018185402, 0.02223168379576073]
layer_partition: [0, 4, 6, 8, 9, 10]
stage_memory_demand: [60507.501, 26075.001, 26075.001, 24192.501, 72770.001], memory_state: [103332.49900000001, 137764.999, 6692.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.3864914396250132, 0.33861436561949165, 0.20708878222179197, 0.054309659394435765, 0.004504871678904738]
layer_partition: [0, 4, 7, 9, 9, 10]
stage_memory_demand: [60507.501, 39112.501, 26075.001, 0.001, 72770.001], memory_state: [103332.49900000001, 124727.49900000001, 6692.999, 16383.999, -56386.001000000004]
adj_stage_compute_performance(4): [0.3864914396250132, 0.33861436561949165, 0.20708878222179197, 0.054309659394435765, 0.0009128354392692353]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[2, 2, 2, 1, 1], num_stage=5, batches=32, gbs=128)
valid_strategies: [(2, 1), (2, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 163840, 32768, 16384, 16384]
stage_compute_performance: [0.27221092175327233, 0.27221092175327233, 0.2722230834434679, 0.09167753652499377, 0.09167753652499377]
layer_partition: [0, 3, 5, 8, 9, 10]
stage_memory_demand: [88775.001, 48385.001, 72577.501, 31295.001, 130420.001], memory_state: [75064.999, 115454.99900000001, -39809.501000000004, -14911.001, -114036.001]
adj_stage_compute_performance(2): [0.46344272456950003, 0.36782682316138615, 0.1106153461862513, 0.04319668443477437, 0.010365283485797152]
layer_partition: [0, 5, 8, 9, 9, 10]
stage_memory_demand: [137160.001, 72577.501, 24192.501, 0.001, 130420.001], memory_state: [26679.99900000001, 91262.499, 8575.499, 16383.999, -114036.001]
adj_stage_compute_performance(3): [0.46344272456950003, 0.36782682316138615, 0.1106153461862513, 0.04319668443477437, 0.001171923961020139]
layer_partition: [0, 5, 8, 9, 9, 10]
stage_memory_demand: [137160.001, 72577.501, 24192.501, 0.001, 130420.001], memory_state: [26679.99900000001, 91262.499, 8575.499, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.46344272456950003, 0.36782682316138615, 0.1106153461862513, 0.04319668443477437, 0.00013250055073698826]
layer_partition: None
valid_strategies: [(1, 2), (2, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 163840, 32768, 16384, 16384]
stage_compute_performance: [0.2575246879056899, 0.2777039325337656, 0.2777163396376827, 0.09352751996143098, 0.09352751996143098]
layer_partition: [0, 3, 5, 7, 8, 10]
stage_memory_demand: [61290.001, 48385.001, 48385.001, 31295.001, 161715.001], memory_state: [102549.99900000001, 115454.99900000001, -15617.000999999997, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.41085804148367444, 0.3634950837958641, 0.1692712193087033, 0.04406836089710548, 0.008528085767029596]
layer_partition: [0, 4, 7, 9, 9, 10]
stage_memory_demand: [81500.001, 72577.501, 48385.001, 0.001, 130420.001], memory_state: [82339.999, 91262.499, -15617.000999999997, 16383.999, -114036.001]
adj_stage_compute_performance(3): [0.4575226238899297, 0.38405457370418933, 0.10317270393105565, 0.04545385541397446, 0.0009642059540109311]
layer_partition: [0, 5, 8, 9, 9, 10]
stage_memory_demand: [101710.001, 72577.501, 24192.501, 0.001, 130420.001], memory_state: [62129.998999999996, 91262.499, 8575.499, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.4575226238899297, 0.38405457370418933, 0.10317270393105565, 0.04545385541397446, 0.00010901545166729131]
layer_partition: None
valid_strategies: [(1, 2), (1, 2), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 163840, 32768, 16384, 16384]
stage_compute_performance: [0.2628283657942494, 0.2628283657942494, 0.28343586121756115, 0.09545370359697004, 0.09545370359697004]
layer_partition: [0, 3, 5, 7, 8, 10]
stage_memory_demand: [61290.001, 40420.001, 48385.001, 31295.001, 161715.001], memory_state: [102549.99900000001, 123419.99900000001, -15617.000999999997, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.42551685873337314, 0.34417261226381124, 0.1727573317677381, 0.044975941421426434, 0.008703720267481441]
layer_partition: [0, 4, 7, 9, 9, 10]
stage_memory_demand: [81500.001, 60630.001, 48385.001, 0.001, 130420.001], memory_state: [82339.999, 103209.99900000001, -15617.000999999997, 16383.999, -114036.001]
adj_stage_compute_performance(3): [0.47501955119634603, 0.3632986276269205, 0.10529752851774703, 0.04641939279615252, 0.0009840636144158158]
layer_partition: [0, 5, 8, 9, 9, 10]
stage_memory_demand: [101710.001, 60630.001, 24192.501, 0.001, 130420.001], memory_state: [62129.998999999996, 103209.99900000001, 8575.499, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.47501955119634603, 0.3632986276269205, 0.10529752851774703, 0.04641939279615252, 0.00011126060666668644]
layer_partition: None
valid_strategies: [(1, 2), (1, 2), (1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 163840, 32768, 16384, 16384]
stage_compute_performance: [0.2947099626482629, 0.2947099626482629, 0.19651522415592426, 0.10703242527377502, 0.10703242527377502]
layer_partition: [0, 3, 5, 7, 8, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 31295.001, 161715.001], memory_state: [102549.99900000001, 123419.99900000001, -7652.000999999997, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.430558783337331, 0.36263437299279694, 0.1433812378833735, 0.05043161142947326, 0.00975949862633323]
layer_partition: [0, 4, 7, 9, 9, 10]
stage_memory_demand: [81500.001, 60630.001, 40420.001, 0.001, 130420.001], memory_state: [82339.999, 103209.99900000001, -7652.000999999997, 16383.999, -114036.001]
adj_stage_compute_performance(3): [0.46111506404087904, 0.37523543405485255, 0.10461367288600873, 0.051430755410223405, 0.0011034324631270264]
layer_partition: [0, 5, 8, 9, 9, 10]
stage_memory_demand: [101710.001, 60630.001, 20210.001, 0.001, 130420.001], memory_state: [62129.998999999996, 103209.99900000001, 12557.999, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.46111506404087904, 0.37523543405485255, 0.10461367288600873, 0.051430755410223405, 0.00012475673672388547]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[2, 2, 2, 1, 1], num_stage=5, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[2, 2, 2, 1, 1], num_stage=5, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[2, 2, 2, 1, 1], num_stage=5, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[2, 2, 2, 1, 1], num_stage=5, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[2, 2, 2, 1, 1], num_stage=5, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[1, 1, 2, 2, 2], num_stage=5, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 2), (1, 2)]
stage_memory_capacity: [81920, 81920, 163840, 32768, 32768]
stage_compute_performance: [0.1803833406455897, 0.1803833406455897, 0.3135277402448408, 0.1628527892319898, 0.1628527892319898]
layer_partition: [0, 2, 4, 7, 8, 10]
stage_memory_demand: [59830.001, 41460.001, 31792.501, 10597.501, 41757.501], memory_state: [22089.999000000003, 40459.999, 132047.499, 22170.499, -8989.500999999997]
adj_stage_compute_performance(2): [0.19388749462414578, 0.19097770244433354, 0.3279742110906149, 0.16754626896713784, 0.11501464557944831]
layer_partition: [0, 3, 4, 7, 8, 10]
stage_memory_demand: [80560.001, 20730.001, 31792.501, 10597.501, 41757.501], memory_state: [1359.9989999999962, 61189.998999999996, 132047.499, 22170.499, -8989.500999999997]
adj_stage_compute_performance(3): [0.1971606673591032, 0.20097363391609374, 0.3410615104361214, 0.17151629577033892, 0.0812289968145514]
layer_partition: [0, 2, 4, 7, 8, 10]
stage_memory_demand: [59830.001, 41460.001, 31792.501, 10597.501, 41757.501], memory_state: [22089.999000000003, 40459.999, 132047.499, 22170.499, -8989.500999999997]
adj_stage_compute_performance(4): [0.20232636968381926, 0.20509928369621344, 0.3465178730201941, 0.1732326358585692, 0.057367910758292236]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[1, 1, 2, 2, 2], num_stage=5, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1), (2, 1), (2, 1)]
stage_memory_capacity: [81920, 81920, 163840, 32768, 32768]
stage_compute_performance: [0.15025952793057093, 0.15025952793057093, 0.29967156813794055, 0.19990468800045877, 0.19990468800045877]
layer_partition: [0, 2, 3, 6, 8, 10]
stage_memory_demand: [64582.501, 24192.501, 62190.001, 41460.001, 81390.001], memory_state: [17337.499000000003, 57727.498999999996, 101649.99900000001, -8692.000999999997, -48622.001000000004]
adj_stage_compute_performance(2): [0.19059745809584505, 0.20871594221301254, 0.3833668729112817, 0.14219558592772658, 0.07243431702082335]
layer_partition: [0, 2, 4, 7, 8, 10]
stage_memory_demand: [64582.501, 48385.001, 62190.001, 20730.001, 81390.001], memory_state: [17337.499000000003, 33534.999, 101649.99900000001, 12037.999, -48622.001000000004]
adj_stage_compute_performance(3): [0.20301515366952408, 0.2195117920914992, 0.3987216092292144, 0.145530127374645, 0.026246159280972434]
layer_partition: [0, 3, 5, 8, 9, 10]
stage_memory_demand: [88775.001, 48385.001, 62190.001, 20730.001, 60660.001], memory_state: [-6855.001000000004, 33534.999, 101649.99900000001, 12037.999, -27892.000999999997]
adj_stage_compute_performance(4): [0.16860491220660953, 0.23707262114526978, 0.42145152575343625, 0.14949532465935128, 0.012760150343337684]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 2), (2, 1), (2, 1)]
stage_memory_capacity: [81920, 81920, 163840, 32768, 32768]
stage_compute_performance: [0.1544148860129128, 0.1544148860129128, 0.280304307707198, 0.20543296013348822, 0.20543296013348822]
layer_partition: [0, 2, 3, 5, 7, 10]
stage_memory_demand: [64582.501, 24192.501, 26075.001, 41460.001, 102120.001], memory_state: [17337.499000000003, 57727.498999999996, 137764.999, -8692.000999999997, -69352.001]
adj_stage_compute_performance(2): [0.19586834306986375, 0.22507595804899122, 0.37027399048998927, 0.14612793940571128, 0.05932691396946547]
layer_partition: [0, 2, 4, 7, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 39112.501, 41460.001, 60660.001], memory_state: [17337.499000000003, 33534.999, 124727.49900000001, -8692.000999999997, -27892.000999999997]
adj_stage_compute_performance(3): [0.21901048657478112, 0.24508583609972934, 0.39382816307220275, 0.1039432750279411, 0.028843090280468348]
layer_partition: [0, 3, 5, 8, 9, 10]
stage_memory_demand: [88775.001, 48385.001, 39112.501, 20730.001, 60660.001], memory_state: [-6855.001000000004, 33534.999, 124727.49900000001, 12037.999, -27892.000999999997]
adj_stage_compute_performance(4): [0.181889101349438, 0.2668629450940822, 0.4172765717157218, 0.10685103980554342, 0.014022705737827932]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 2), (2, 1)]
stage_memory_capacity: [81920, 81920, 163840, 32768, 32768]
stage_compute_performance: [0.1573361030258644, 0.1573361030258644, 0.28560709770122367, 0.19040136043011155, 0.20931933581693607]
layer_partition: [0, 2, 3, 5, 7, 10]
stage_memory_demand: [64582.501, 24192.501, 26075.001, 26075.001, 102120.001], memory_state: [17337.499000000003, 57727.498999999996, 137764.999, 6692.999, -69352.001]
adj_stage_compute_performance(2): [0.1990452481407611, 0.19074562143912882, 0.33418622955022814, 0.21108868469610673, 0.060449259067716074]
layer_partition: [0, 3, 4, 7, 9, 10]
stage_memory_demand: [88775.001, 24192.501, 39112.501, 26075.001, 60660.001], memory_state: [-6855.001000000004, 57727.498999999996, 124727.49900000001, 6692.999, -27892.000999999997]
adj_stage_compute_performance(3): [0.16530788949157021, 0.21238269887549188, 0.3622701774481536, 0.22077350666360937, 0.029388743152474202]
layer_partition: [0, 2, 4, 7, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 39112.501, 26075.001, 60660.001], memory_state: [17337.499000000003, 33534.999, 124727.49900000001, 6692.999, -27892.000999999997]
adj_stage_compute_performance(4): [0.16790618770029106, 0.21514652842702758, 0.3659423839662414, 0.22216755003408287, 0.014287986939832844]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 2), (1, 2)]
stage_memory_capacity: [81920, 81920, 163840, 32768, 32768]
stage_compute_performance: [0.1603699783286718, 0.1603699783286718, 0.29111439261547356, 0.19407282536359147, 0.19407282536359147]
layer_partition: [0, 2, 4, 6, 8, 10]
stage_memory_demand: [64582.501, 48385.001, 26075.001, 26075.001, 57202.501], memory_state: [17337.499000000003, 33534.999, 137764.999, 6692.999, -24434.500999999997]
adj_stage_compute_performance(2): [0.18489952696669418, 0.18001843682940422, 0.3196842464017469, 0.20623923935686292, 0.10005577391384947]
layer_partition: [0, 3, 4, 6, 8, 10]
stage_memory_demand: [88775.001, 24192.501, 26075.001, 26075.001, 57202.501], memory_state: [-6855.001000000004, 57727.498999999996, 137764.999, 6692.999, -24434.500999999997]
adj_stage_compute_performance(3): [0.15355981042681632, 0.20624298618685552, 0.35437916516702334, 0.2184860805931892, 0.05158454242495652]
layer_partition: [0, 2, 4, 7, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 39112.501, 26075.001, 44165.001], memory_state: [17337.499000000003, 33534.999, 124727.49900000001, 6692.999, -11397.000999999997]
adj_stage_compute_performance(4): [0.15638166373956325, 0.20940895587273547, 0.35861617492625886, 0.22010577394922254, 0.03444560224424942]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[1, 1, 2, 2, 2], num_stage=5, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1), (2, 1), (2, 1)]
stage_memory_capacity: [81920, 81920, 163840, 32768, 32768]
stage_compute_performance: [0.1259669810109827, 0.1259669810109827, 0.2493479191730038, 0.2493590594025154, 0.2493590594025154]
layer_partition: [0, 2, 3, 5, 7, 10]
stage_memory_demand: [76685.001, 31295.001, 48385.001, 48385.001, 121155.001], memory_state: [5234.998999999996, 50624.998999999996, 115454.99900000001, -15617.000999999997, -88387.001]
adj_stage_compute_performance(2): [0.1345662769753332, 0.23853389964228486, 0.40902380561143525, 0.1519871394164374, 0.06069826116918989]
layer_partition: [0, 2, 4, 7, 8, 10]
stage_memory_demand: [76685.001, 62590.001, 72577.501, 24192.501, 96962.501], memory_state: [5234.998999999996, 19329.999000000003, 91262.499, 8575.499, -64194.501000000004]
adj_stage_compute_performance(3): [0.14247612118249336, 0.2505351386635183, 0.42434777836715243, 0.15518796943918772, 0.018461410765310323]
layer_partition: [0, 2, 4, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 96770.001, 24192.501, 72770.001], memory_state: [5234.998999999996, 19329.999000000003, 67069.999, 8575.499, -40002.001000000004]
adj_stage_compute_performance(4): [0.144084614297779, 0.2529492113884568, 0.4273833282279038, 0.1558137200861805, 0.007481780262197878]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 2), (2, 1), (2, 1)]
stage_memory_capacity: [81920, 81920, 163840, 32768, 32768]
stage_compute_performance: [0.1282914640687261, 0.1282914640687261, 0.2354960507695684, 0.2539605105464897, 0.2539605105464897]
layer_partition: [0, 2, 3, 5, 7, 10]
stage_memory_demand: [76685.001, 31295.001, 40420.001, 48385.001, 121155.001], memory_state: [5234.998999999996, 50624.998999999996, 123419.99900000001, -15617.000999999997, -88387.001]
adj_stage_compute_performance(2): [0.13704944382161566, 0.24913656730066502, 0.3915274232484304, 0.15479177542289682, 0.061818333100658686]
layer_partition: [0, 2, 4, 7, 8, 10]
stage_memory_demand: [76685.001, 62590.001, 60630.001, 24192.501, 96962.501], memory_state: [5234.998999999996, 19329.999000000003, 103209.99900000001, 8575.499, -64194.501000000004]
adj_stage_compute_performance(3): [0.14528366062012005, 0.2619052843603366, 0.40623278637658955, 0.15816456785226848, 0.018802081282310836]
layer_partition: [0, 2, 4, 7, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 60630.001, 48385.001, 72770.001], memory_state: [5234.998999999996, 19329.999000000003, 103209.99900000001, -15617.000999999997, -40002.001000000004]
adj_stage_compute_performance(4): [0.15520163425439915, 0.29058360689904983, 0.43548189341635546, 0.09640307547880016, 0.007619842406115748]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 2), (2, 1)]
stage_memory_capacity: [81920, 81920, 163840, 32768, 32768]
stage_compute_performance: [0.14206142853910067, 0.14206142853910067, 0.2607726525727353, 0.17388552396930004, 0.2812189663797631]
layer_partition: [0, 2, 3, 5, 7, 10]
stage_memory_demand: [76685.001, 31295.001, 40420.001, 40420.001, 121155.001], memory_state: [5234.998999999996, 50624.998999999996, 123419.99900000001, -7652.000999999997, -88387.001]
adj_stage_compute_performance(2): [0.151759432407429, 0.24901937606428037, 0.39887336913917293, 0.12687017906019898, 0.06845350759642906]
layer_partition: [0, 2, 4, 7, 8, 10]
stage_memory_demand: [76685.001, 62590.001, 60630.001, 20210.001, 96962.501], memory_state: [5234.998999999996, 19329.999000000003, 103209.99900000001, 12557.999, -64194.501000000004]
adj_stage_compute_performance(3): [0.16190636029720565, 0.2629421235854001, 0.41518067269368686, 0.12982407963132842, 0.02082017339082259]
layer_partition: [0, 2, 4, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 80840.001, 20210.001, 72770.001], memory_state: [5234.998999999996, 19329.999000000003, 82999.999, 12557.999, -40002.001000000004]
adj_stage_compute_performance(4): [0.1639734773616614, 0.2657387735674438, 0.4183993235332488, 0.13039968211081257, 0.008437706322189376]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 2), (1, 2)]
stage_memory_capacity: [81920, 81920, 163840, 32768, 32768]
stage_compute_performance: [0.15914276986326054, 0.15914276986326054, 0.29212772715144436, 0.19479336656101723, 0.19479336656101723]
layer_partition: [0, 2, 3, 5, 7, 10]
stage_memory_demand: [76685.001, 31295.001, 40420.001, 40420.001, 100070.001], memory_state: [5234.998999999996, 50624.998999999996, 123419.99900000001, -7652.000999999997, -67302.001]
adj_stage_compute_performance(2): [0.17000685319412467, 0.2357809918625599, 0.3910805737549131, 0.1421249378970642, 0.057406716043944796]
layer_partition: [0, 2, 4, 7, 8, 10]
stage_memory_demand: [76685.001, 62590.001, 60630.001, 20210.001, 79860.001], memory_state: [5234.998999999996, 19329.999000000003, 103209.99900000001, 12557.999, -47092.001000000004]
adj_stage_compute_performance(3): [0.17855316109278893, 0.24548781450765425, 0.4031381086313607, 0.1446818245970915, 0.021199510681137918]
layer_partition: [0, 2, 4, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 80840.001, 20210.001, 59650.001], memory_state: [5234.998999999996, 19329.999000000003, 82999.999, 12557.999, -26882.000999999997]
adj_stage_compute_performance(4): [0.1805223749474398, 0.24769781749537007, 0.40585062526735616, 0.14525150208704965, 0.01048112320064462]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[1, 1, 2, 2, 2], num_stage=5, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[1, 1, 2, 2, 2], num_stage=5, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[1, 1, 2, 2, 2], num_stage=5, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[1, 1, 2, 2, 2], num_stage=5, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[1, 1, 2, 2, 2], num_stage=5, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[2, 1, 1, 2, 2], num_stage=5, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 2), (1, 2)]
stage_memory_capacity: [163840, 81920, 81920, 32768, 32768]
stage_compute_performance: [0.3135277402448408, 0.1803833406455897, 0.1803833406455897, 0.1628527892319898, 0.1628527892319898]
layer_partition: [0, 4, 6, 7, 8, 10]
stage_memory_demand: [53682.501, 41460.001, 20730.001, 10597.501, 41757.501], memory_state: [110157.49900000001, 40459.999, 61189.998999999996, 22170.499, -8989.500999999997]
adj_stage_compute_performance(2): [0.3369995689938921, 0.18882992908924923, 0.18700991007595294, 0.16754626896713784, 0.11501464557944831]
layer_partition: [0, 4, 6, 7, 8, 10]
stage_memory_demand: [53682.501, 41460.001, 20730.001, 10597.501, 41757.501], memory_state: [110157.49900000001, 40459.999, 61189.998999999996, 22170.499, -8989.500999999997]
adj_stage_compute_performance(3): [0.3539307131069674, 0.19468542057470245, 0.19156515121606352, 0.17076050083540875, 0.0812289968145514]
layer_partition: [0, 4, 6, 7, 8, 10]
stage_memory_demand: [53682.501, 41460.001, 20730.001, 10597.501, 41757.501], memory_state: [110157.49900000001, 40459.999, 61189.998999999996, 22170.499, -8989.500999999997]
adj_stage_compute_performance(4): [0.3632015263857783, 0.19780363672908716, 0.19397765034188605, 0.1724587592749763, 0.057367910758292236]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[2, 1, 1, 2, 2], num_stage=5, batches=64, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1), (2, 1), (2, 1)]
stage_memory_capacity: [163840, 81920, 81920, 32768, 32768]
stage_compute_performance: [0.29967156813794055, 0.15025952793057093, 0.15025952793057093, 0.19990468800045877, 0.19990468800045877]
layer_partition: [0, 3, 5, 6, 8, 10]
stage_memory_demand: [80560.001, 48385.001, 24192.501, 41460.001, 81390.001], memory_state: [83279.999, 33534.999, 57727.498999999996, -8692.000999999997, -48622.001000000004]
adj_stage_compute_performance(2): [0.4254673899932001, 0.18184195525791125, 0.17393519958504194, 0.14219558592772658, 0.07243431702082335]
layer_partition: [0, 4, 6, 7, 8, 10]
stage_memory_demand: [101290.001, 48385.001, 24192.501, 20730.001, 81390.001], memory_state: [62549.998999999996, 33534.999, 57727.498999999996, 12037.999, -48622.001000000004]
adj_stage_compute_performance(3): [0.45307652804840765, 0.1882051833000818, 0.17882319492777138, 0.145438946023087, 0.026246159280972434]
layer_partition: [0, 5, 7, 8, 9, 10]
stage_memory_demand: [122020.001, 48385.001, 24192.501, 20730.001, 60660.001], memory_state: [41819.998999999996, 33534.999, 57727.498999999996, 12037.999, -27892.000999999997]
adj_stage_compute_performance(4): [0.45940476895858745, 0.1896003856416622, 0.17989044879146202, 0.1461461963473907, 0.012760150343337684]
layer_partition: None
valid_strategies: [(1, 2), (1, 1), (1, 1), (2, 1), (2, 1)]
stage_memory_capacity: [163840, 81920, 81920, 32768, 32768]
stage_compute_performance: [0.280304307707198, 0.1544148860129128, 0.1544148860129128, 0.20543296013348822, 0.20543296013348822]
layer_partition: [0, 3, 5, 6, 8, 10]
stage_memory_demand: [47470.001, 48385.001, 24192.501, 41460.001, 81390.001], memory_state: [116369.99900000001, 33534.999, 57727.498999999996, -8692.000999999997, -48622.001000000004]
adj_stage_compute_performance(2): [0.4040672775500428, 0.19015493389986537, 0.18078729483362638, 0.14612793940571128, 0.07443745471742565]
layer_partition: [0, 4, 6, 7, 8, 10]
stage_memory_demand: [60507.501, 48385.001, 24192.501, 20730.001, 81390.001], memory_state: [103332.49900000001, 33534.999, 57727.498999999996, 12037.999, -48622.001000000004]
adj_stage_compute_performance(3): [0.4311605949126299, 0.1973121008197727, 0.18618717352405711, 0.14963595963474186, 0.026971984735109453]
layer_partition: [0, 4, 6, 8, 9, 10]
stage_memory_demand: [60507.501, 48385.001, 48385.001, 20730.001, 60660.001], memory_state: [103332.49900000001, 33534.999, 33534.999, 12037.999, -27892.000999999997]
adj_stage_compute_performance(4): [0.43735727909360717, 0.19887993857208655, 0.18736389320769986, 0.15039907322928106, 0.01311302642774536]
layer_partition: None
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 2), (2, 1)]
stage_memory_capacity: [163840, 81920, 81920, 32768, 32768]
stage_compute_performance: [0.28560709770122367, 0.1573361030258644, 0.1573361030258644, 0.19040136043011155, 0.20931933581693607]
layer_partition: [0, 3, 5, 6, 7, 10]
stage_memory_demand: [47470.001, 48385.001, 24192.501, 13037.501, 102120.001], memory_state: [116369.99900000001, 33534.999, 57727.498999999996, 19730.499, -69352.001]
adj_stage_compute_performance(2): [0.3613203488544351, 0.1839792064080057, 0.17867754386767729, 0.21108868469610673, 0.060449259067716074]
layer_partition: [0, 4, 6, 7, 9, 10]
stage_memory_demand: [60507.501, 48385.001, 24192.501, 26075.001, 60660.001], memory_state: [103332.49900000001, 33534.999, 57727.498999999996, 6692.999, -27892.000999999997]
adj_stage_compute_performance(3): [0.37332249527045624, 0.1877290427901578, 0.18160278308066846, 0.21388418129926637, 0.029388743152474202]
layer_partition: [0, 4, 6, 7, 9, 10]
stage_memory_demand: [60507.501, 48385.001, 24192.501, 26075.001, 60660.001], memory_state: [103332.49900000001, 33534.999, 57727.498999999996, 6692.999, -27892.000999999997]
adj_stage_compute_performance(4): [0.37921609179102544, 0.18953602836512295, 0.18300773668318346, 0.21522472622056374, 0.014287986939832844]
layer_partition: None
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 2), (1, 2)]
stage_memory_capacity: [163840, 81920, 81920, 32768, 32768]
stage_compute_performance: [0.29111439261547356, 0.1603699783286718, 0.1603699783286718, 0.19407282536359147, 0.19407282536359147]
layer_partition: [0, 3, 5, 6, 8, 10]
stage_memory_demand: [47470.001, 48385.001, 24192.501, 26075.001, 57202.501], memory_state: [116369.99900000001, 33534.999, 57727.498999999996, 6692.999, -24434.500999999997]
adj_stage_compute_performance(2): [0.3356420824443928, 0.17603904319393743, 0.17292108455951508, 0.20623923935686292, 0.10005577391384947]
layer_partition: [0, 4, 5, 6, 8, 10]
stage_memory_demand: [60507.501, 24192.501, 24192.501, 26075.001, 57202.501], memory_state: [103332.49900000001, 57727.498999999996, 57727.498999999996, 6692.999, -24434.500999999997]
adj_stage_compute_performance(3): [0.35956055540817594, 0.18385738383164402, 0.17908333195027448, 0.21216219300796946, 0.05158454242495652]
layer_partition: [0, 4, 6, 7, 9, 10]
stage_memory_demand: [60507.501, 48385.001, 24192.501, 26075.001, 44165.001], memory_state: [103332.49900000001, 33534.999, 57727.498999999996, 6692.999, -11397.000999999997]
adj_stage_compute_performance(4): [0.3661538235592638, 0.18593181997297314, 0.18070643717126797, 0.2137166716797397, 0.03444560224424942]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[2, 1, 1, 2, 2], num_stage=5, batches=32, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1), (2, 1), (2, 1)]
stage_memory_capacity: [163840, 81920, 81920, 32768, 32768]
stage_compute_performance: [0.2493479191730038, 0.1259669810109827, 0.1259669810109827, 0.2493590594025154, 0.2493590594025154]
layer_partition: [0, 3, 4, 5, 7, 10]
stage_memory_demand: [88775.001, 31295.001, 31295.001, 48385.001, 121155.001], memory_state: [75064.999, 50624.998999999996, 50624.998999999996, -15617.000999999997, -88387.001]
adj_stage_compute_performance(2): [0.4430034055966363, 0.17513531435779703, 0.1627798178888734, 0.1519871394164374, 0.06069826116918989]
layer_partition: [0, 5, 6, 7, 8, 10]
stage_memory_demand: [137160.001, 31295.001, 31295.001, 24192.501, 96962.501], memory_state: [26679.99900000001, 50624.998999999996, 50624.998999999996, 8575.499, -64194.501000000004]
adj_stage_compute_performance(3): [0.46897203290581885, 0.18052653830212023, 0.16685000227435923, 0.15512435480858297, 0.018461410765310323]
layer_partition: [0, 5, 7, 8, 9, 10]
stage_memory_demand: [137160.001, 62590.001, 31295.001, 24192.501, 72770.001], memory_state: [26679.99900000001, 19329.999000000003, 50624.998999999996, 8575.499, -40002.001000000004]
adj_stage_compute_performance(4): [0.47427237580539744, 0.18158190701207683, 0.16764415809223376, 0.15573588963254692, 0.007481780262197878]
layer_partition: None
valid_strategies: [(1, 2), (1, 1), (1, 1), (2, 1), (2, 1)]
stage_memory_capacity: [163840, 81920, 81920, 32768, 32768]
stage_compute_performance: [0.2354960507695684, 0.1282914640687261, 0.1282914640687261, 0.2539605105464897, 0.2539605105464897]
layer_partition: [0, 3, 4, 5, 7, 10]
stage_memory_demand: [61290.001, 31295.001, 31295.001, 48385.001, 121155.001], memory_state: [102549.99900000001, 50624.998999999996, 50624.998999999996, -15617.000999999997, -88387.001]
adj_stage_compute_performance(2): [0.42596285503659614, 0.18239509004935175, 0.16828956291649538, 0.15479177542289682, 0.061818333100658686]
layer_partition: [0, 4, 6, 7, 8, 10]
stage_memory_demand: [81500.001, 62590.001, 31295.001, 24192.501, 96962.501], memory_state: [82339.999, 19329.999000000003, 50624.998999999996, 8575.499, -64194.501000000004]
adj_stage_compute_performance(3): [0.4514999860558808, 0.18832925858465743, 0.1726926452564269, 0.15810997654061215, 0.018802081282310836]
layer_partition: [0, 5, 7, 8, 9, 10]
stage_memory_demand: [101710.001, 62590.001, 31295.001, 24192.501, 72770.001], memory_state: [62129.998999999996, 19329.999000000003, 50624.998999999996, 8575.499, -40002.001000000004]
adj_stage_compute_performance(4): [0.4567015262806065, 0.1894896784944049, 0.17355025844178057, 0.15875547045011587, 0.007619842406115748]
layer_partition: None
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 2), (2, 1)]
stage_memory_capacity: [163840, 81920, 81920, 32768, 32768]
stage_compute_performance: [0.2607726525727353, 0.14206142853910067, 0.14206142853910067, 0.17388552396930004, 0.2812189663797631]
layer_partition: [0, 3, 4, 5, 7, 10]
stage_memory_demand: [61290.001, 31295.001, 31295.001, 40420.001, 121155.001], memory_state: [102549.99900000001, 50624.998999999996, 50624.998999999996, -7652.000999999997, -88387.001]
adj_stage_compute_performance(2): [0.43062423503766084, 0.19030913514216963, 0.17773032323718957, 0.12687017906019898, 0.06845350759642906]
layer_partition: [0, 4, 6, 7, 8, 10]
stage_memory_demand: [81500.001, 62590.001, 31295.001, 20210.001, 96962.501], memory_state: [82339.999, 19329.999000000003, 50624.998999999996, 12557.999, -64194.501000000004]
adj_stage_compute_performance(3): [0.4593503015429222, 0.19709758981967482, 0.18276649589946736, 0.12977482925320166, 0.02082017339082259]
layer_partition: [0, 5, 7, 8, 9, 10]
stage_memory_demand: [101710.001, 62590.001, 31295.001, 20210.001, 72770.001], memory_state: [62129.998999999996, 19329.999000000003, 50624.998999999996, 12557.999, -40002.001000000004]
adj_stage_compute_performance(4): [0.46522022236853994, 0.19842227656149813, 0.18374500720391873, 0.1303385790186158, 0.008437706322189376]
layer_partition: None
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 2), (1, 2)]
stage_memory_capacity: [163840, 81920, 81920, 32768, 32768]
stage_compute_performance: [0.29212772715144436, 0.15914276986326054, 0.15914276986326054, 0.19479336656101723, 0.19479336656101723]
layer_partition: [0, 3, 5, 6, 8, 10]
stage_memory_demand: [61290.001, 62590.001, 31295.001, 40420.001, 79860.001], memory_state: [102549.99900000001, 19329.999000000003, 50624.998999999996, -7652.000999999997, -47092.001000000004]
adj_stage_compute_performance(2): [0.406892122915487, 0.19174251850820143, 0.1832433351225966, 0.1421249378970642, 0.07193451114437466]
layer_partition: [0, 4, 6, 7, 8, 10]
stage_memory_demand: [81500.001, 62590.001, 31295.001, 20210.001, 79860.001], memory_state: [82339.999, 19329.999000000003, 50624.998999999996, 12557.999, -47092.001000000004]
adj_stage_compute_performance(3): [0.43288221715962205, 0.198596726191719, 0.18843443308491667, 0.14535272781190528, 0.02656442560100872]
layer_partition: [0, 4, 6, 8, 9, 10]
stage_memory_demand: [81500.001, 62590.001, 62590.001, 20210.001, 59650.001], memory_state: [82339.999, 19329.999000000003, 19329.999000000003, 12557.999, -26882.000999999997]
adj_stage_compute_performance(4): [0.43890540954808444, 0.2001208032361245, 0.1895829996331973, 0.14606574328051455, 0.013133558678137633]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[2, 1, 1, 2, 2], num_stage=5, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[2, 1, 1, 2, 2], num_stage=5, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[2, 1, 1, 2, 2], num_stage=5, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[2, 1, 1, 2, 2], num_stage=5, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[2, 1, 1, 2, 2], num_stage=5, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[2, 2, 1, 1, 2], num_stage=5, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 2), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [163840, 163840, 16384, 16384, 32768]
stage_compute_performance: [0.30422802478263733, 0.30422802478263733, 0.11676081282436176, 0.11676081282436176, 0.15802232478600164]
layer_partition: [0, 3, 6, 7, 8, 10]
stage_memory_demand: [43085.001, 31792.501, 20730.001, 20730.001, 41757.501], memory_state: [120754.99900000001, 132047.499, -4346.001, -4346.001, -8989.500999999997]
adj_stage_compute_performance(2): [0.3753736110432426, 0.33980081791294, 0.08305393914756246, 0.08305393914756246, 0.11160313412263183]
layer_partition: [0, 4, 7, 8, 8, 10]
stage_memory_demand: [53682.501, 31792.501, 20730.001, 0.001, 41757.501], memory_state: [110157.49900000001, 132047.499, -4346.001, 16383.999, -8989.500999999997]
adj_stage_compute_performance(3): [0.40934099255922696, 0.35608953249671166, 0.059077670333653, 0.08534041269075826, 0.07881961971424872]
layer_partition: [0, 4, 7, 8, 8, 10]
stage_memory_demand: [53682.501, 31792.501, 20730.001, 0.001, 41757.501], memory_state: [110157.49900000001, 132047.499, -4346.001, 16383.999, -8989.500999999997]
adj_stage_compute_performance(4): [0.4339377323634363, 0.36719151813280054, 0.04202294518325945, 0.08688747972531895, 0.055666290205365794]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[2, 2, 1, 1, 2], num_stage=5, batches=64, gbs=128)
valid_strategies: [(2, 1), (2, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [163840, 163840, 16384, 16384, 32768]
stage_compute_performance: [0.2724831189917157, 0.2724831189917157, 0.13663296228036942, 0.13663296228036942, 0.1817678374558298]
layer_partition: [0, 3, 5, 7, 8, 10]
stage_memory_demand: [80560.001, 41460.001, 48385.001, 24192.501, 81390.001], memory_state: [83279.999, 122379.99900000001, -32001.000999999997, -7808.501, -48622.001000000004]
adj_stage_compute_performance(2): [0.44589865764028414, 0.3591908883159999, 0.041639660369158935, 0.08327931901713738, 0.06586253326102512]
layer_partition: [0, 4, 7, 7, 8, 9]
stage_memory_demand: [101290.001, 62190.001, 0.001, 24192.501, 20730.001], memory_state: [62549.998999999996, 101649.99900000001, 16383.999, -7808.501, 12037.999]
adj_stage_compute_performance(3): [0.4617879806302104, 0.36573648691716043, 0.042099805177179817, 0.050759676583214806, 0.06655714721786797]
layer_partition: [0, 5, 8, 8, 8, 10]
stage_memory_demand: [122020.001, 62190.001, 0.001, 0.001, 81390.001], memory_state: [41819.998999999996, 101649.99900000001, 16383.999, 16383.999, -48622.001000000004]
adj_stage_compute_performance(4): [0.4888467565410958, 0.3764146120625583, 0.04284052641616896, 0.05161191197129845, 0.0241166005149894]
layer_partition: None
valid_strategies: [(1, 2), (2, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [163840, 163840, 16384, 16384, 32768]
stage_compute_performance: [0.2542351187148498, 0.279317698587877, 0.1400600694700551, 0.1400600694700551, 0.18632704375716308]
layer_partition: [0, 3, 5, 6, 7, 10]
stage_memory_demand: [47470.001, 41460.001, 24192.501, 24192.501, 102120.001], memory_state: [116369.99900000001, 122379.99900000001, -7808.501, -7808.501, -69352.001]
adj_stage_compute_performance(2): [0.40542467422811235, 0.3662749374804003, 0.08536817918815603, 0.08536817918815603, 0.05380932294400632]
layer_partition: [0, 4, 7, 8, 9, 10]
stage_memory_demand: [60507.501, 62190.001, 24192.501, 24192.501, 60660.001], memory_state: [103332.49900000001, 101649.99900000001, -7808.501, -7808.501, -27892.000999999997]
adj_stage_compute_performance(3): [0.46733301838480906, 0.39282130703025575, 0.05203286022544232, 0.05203286022544232, 0.02616059147124444]
layer_partition: [0, 5, 8, 8, 8, 9]
stage_memory_demand: [73545.001, 62190.001, 0.001, 0.001, 20730.001], memory_state: [90294.999, 101649.99900000001, 16383.999, 16383.999, 12037.999]
layer_partition: [0, 5, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [2, 2, 1, 1, 2], num_stage: 5, batches: 64, gbs: 128, strategies: [(1, 2), (2, 1), (1, 1), (1, 1), (2, 1)], layer_partition: [0, 5, 8, 8, 8, 9]
execution_cost: 8496.723215579987, fb_sync_cost: 10367.741088867188, parameter_upate_costs: 12.180919647216797, dp_cost: 12.587466032608695, pp_cost: 0.5808695652173913
cost: 18955.458396117996
valid_strategies: [(1, 2), (2, 1), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [163840, 163840, 16384, 16384, 32768]
stage_compute_performance: [0.258589761417854, 0.28410196593899717, 0.14245907540827132, 0.14245907540827132, 0.1723901218266062]
layer_partition: [0, 3, 5, 7, 8, 10]
stage_memory_demand: [47470.001, 41460.001, 48385.001, 24192.501, 57202.501], memory_state: [116369.99900000001, 122379.99900000001, -32001.000999999997, -7808.501, -24434.500999999997]
adj_stage_compute_performance(2): [0.40745685280160265, 0.3697234308923495, 0.043415200969825464, 0.08683040014507824, 0.08887708530109215]
layer_partition: [0, 4, 7, 7, 7, 9]
stage_memory_demand: [60507.501, 62190.001, 0.001, 0.001, 26075.001], memory_state: [103332.49900000001, 101649.99900000001, 16383.999, 16383.999, 6692.999]
layer_partition: [0, 4, 7, 7, 7, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [2, 2, 1, 1, 2], num_stage: 5, batches: 64, gbs: 128, strategies: [(1, 2), (2, 1), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 4, 7, 7, 7, 9]
execution_cost: 6485.720058174134, fb_sync_cost: 5207.039999999997, parameter_upate_costs: 12.180919647216797, dp_cost: 12.587466032608695, pp_cost: 0.5808695652173913
cost: 11783.754149844955
valid_strategies: [(1, 2), (1, 2), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [163840, 163840, 16384, 16384, 32768]
stage_compute_performance: [0.26535967163219804, 0.26535967163219804, 0.14618867067315902, 0.14618867067315902, 0.17690331538928597]
layer_partition: [0, 3, 5, 6, 7, 10]
stage_memory_demand: [47470.001, 26075.001, 24192.501, 24192.501, 70240.001], memory_state: [116369.99900000001, 137764.999, -7808.501, -7808.501, -37472.001000000004]
adj_stage_compute_performance(2): [0.407633479288627, 0.3364965754604125, 0.08910363018185402, 0.08910363018185402, 0.07427521327638521]
layer_partition: [0, 4, 7, 8, 9, 10]
stage_memory_demand: [60507.501, 39112.501, 24192.501, 24192.501, 44165.001], memory_state: [103332.49900000001, 124727.49900000001, -7808.501, -7808.501, -11397.000999999997]
adj_stage_compute_performance(3): [0.47206388518161935, 0.3605475940141883, 0.054309659394435765, 0.054309659394435765, 0.04959730827984204]
layer_partition: [0, 5, 8, 8, 8, 9]
stage_memory_demand: [73545.001, 39112.501, 0.001, 0.001, 13037.501], memory_state: [90294.999, 124727.49900000001, 16383.999, 16383.999, 19730.499]
layer_partition: [0, 5, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [2, 2, 1, 1, 2], num_stage: 5, batches: 64, gbs: 128, strategies: [(1, 2), (1, 2), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 5, 8, 8, 8, 9]
execution_cost: 8509.022126541138, fb_sync_cost: 5207.039999999997, parameter_upate_costs: 10.150766372680664, dp_cost: 0.0, pp_cost: 0.6678260869565218
cost: 13792.525555426553


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[2, 2, 1, 1, 2], num_stage=5, batches=32, gbs=128)
valid_strategies: [(2, 1), (2, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [163840, 163840, 16384, 16384, 32768]
stage_compute_performance: [0.27221092175327233, 0.27221092175327233, 0.09167753652499377, 0.09167753652499377, 0.2722230834434679]
layer_partition: [0, 3, 5, 6, 7, 10]
stage_memory_demand: [88775.001, 48385.001, 31295.001, 31295.001, 121155.001], memory_state: [75064.999, 115454.99900000001, -14911.001, -14911.001, -88387.001]
adj_stage_compute_performance(2): [0.47100284889727007, 0.3716068853252712, 0.04319668443477437, 0.04319668443477437, 0.0662637557854339]
layer_partition: [0, 5, 8, 8, 8, 9]
stage_memory_demand: [137160.001, 72577.501, 0.001, 0.001, 24192.501], memory_state: [26679.99900000001, 91262.499, 16383.999, 16383.999, 8575.499]
layer_partition: [0, 5, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [2, 2, 1, 1, 2], num_stage: 5, batches: 32, gbs: 128, strategies: [(2, 1), (2, 1), (1, 1), (1, 1), (2, 1)], layer_partition: [0, 5, 8, 8, 8, 9]
execution_cost: 7790.06903968811, fb_sync_cost: 3458.8799999999974, parameter_upate_costs: 20.301532745361328, dp_cost: 24.93546195652174, pp_cost: 0.9878260869565219
cost: 11327.99627868984
valid_strategies: [(2, 1), (2, 1), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [163840, 163840, 16384, 16384, 32768]
stage_compute_performance: [0.3037729170822593, 0.3037729170822593, 0.1023072568938096, 0.1023072568938096, 0.1878396520478623]
layer_partition: [0, 3, 6, 7, 8, 10]
stage_memory_demand: [88775.001, 72577.501, 31295.001, 31295.001, 79860.001], memory_state: [75064.999, 91262.499, -14911.001, -14911.001, -47092.001000000004]
adj_stage_compute_performance(2): [0.45252980274701626, 0.3781513599146378, 0.04820520335670732, 0.04820520335670732, 0.06936660001386573]
layer_partition: [0, 5, 8, 8, 8, 9]
stage_memory_demand: [137160.001, 72577.501, 0.001, 0.001, 20210.001], memory_state: [26679.99900000001, 91262.499, 16383.999, 16383.999, 12557.999]
layer_partition: [0, 5, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [2, 2, 1, 1, 2], num_stage: 5, batches: 32, gbs: 128, strategies: [(2, 1), (2, 1), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 5, 8, 8, 8, 9]
execution_cost: 7826.0890396881105, fb_sync_cost: 1107.0720000000038, parameter_upate_costs: 20.301532745361328, dp_cost: 24.93546195652174, pp_cost: 0.9878260869565219
cost: 9012.208278689846
valid_strategies: [(1, 2), (2, 1), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [163840, 163840, 16384, 16384, 32768]
stage_compute_performance: [0.2880578354340276, 0.3106296112724123, 0.1046165133630567, 0.1046165133630567, 0.1920795265674468]
layer_partition: [0, 3, 6, 7, 8, 10]
stage_memory_demand: [61290.001, 72577.501, 31295.001, 31295.001, 79860.001], memory_state: [102549.99900000001, 91262.499, -14911.001, -14911.001, -47092.001000000004]
adj_stage_compute_performance(2): [0.43437795334312357, 0.3924968050388551, 0.04929328040111867, 0.04929328040111867, 0.07093232736004959]
layer_partition: [0, 5, 8, 8, 8, 9]
stage_memory_demand: [101710.001, 72577.501, 0.001, 0.001, 20210.001], memory_state: [62129.998999999996, 91262.499, 16383.999, 16383.999, 12557.999]
layer_partition: [0, 5, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [2, 2, 1, 1, 2], num_stage: 5, batches: 32, gbs: 128, strategies: [(1, 2), (2, 1), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 5, 8, 8, 8, 9]
execution_cost: 8447.930470352172, fb_sync_cost: 1107.0720000000038, parameter_upate_costs: 12.180919647216797, dp_cost: 12.587466032608695, pp_cost: 1.1617391304347826
cost: 9613.755013375327
valid_strategies: [(1, 2), (1, 2), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [163840, 163840, 16384, 16384, 32768]
stage_compute_performance: [0.2947099626482629, 0.2947099626482629, 0.10703242527377502, 0.10703242527377502, 0.19651522415592426]
layer_partition: [0, 3, 6, 7, 8, 10]
stage_memory_demand: [61290.001, 60630.001, 31295.001, 31295.001, 79860.001], memory_state: [102549.99900000001, 103209.99900000001, -14911.001, -14911.001, -47092.001000000004]
adj_stage_compute_performance(2): [0.450337341705046, 0.37252365217665445, 0.05043161142947326, 0.05043161142947326, 0.0725703694722868]
layer_partition: [0, 5, 8, 8, 8, 10]
stage_memory_demand: [101710.001, 60630.001, 0.001, 0.001, 79860.001], memory_state: [62129.998999999996, 103209.99900000001, 16383.999, 16383.999, -47092.001000000004]
adj_stage_compute_performance(3): [0.4787509138244117, 0.38456889644382236, 0.05140465419724138, 0.05135152999211716, 0.026799239336111513]
layer_partition: [0, 5, 8, 8, 8, 9]
stage_memory_demand: [101710.001, 60630.001, 0.001, 0.001, 20210.001], memory_state: [62129.998999999996, 103209.99900000001, 16383.999, 16383.999, 12557.999]
layer_partition: [0, 5, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [2, 2, 1, 1, 2], num_stage: 5, batches: 32, gbs: 128, strategies: [(1, 2), (1, 2), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 5, 8, 8, 8, 9]
execution_cost: 8461.095467453002, fb_sync_cost: 1107.0720000000038, parameter_upate_costs: 10.150766372680664, dp_cost: 0.0, pp_cost: 1.3356521739130436
cost: 9612.47630421249


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[2, 2, 1, 1, 2], num_stage=5, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[2, 2, 1, 1, 2], num_stage=5, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[2, 2, 1, 1, 2], num_stage=5, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[2, 2, 1, 1, 2], num_stage=5, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[2, 2, 1, 1, 2], num_stage=5, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 2, 1, 1, 1, 1], num_stage=6, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 2), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 163840, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.28287142961282996, 0.28287142961282996, 0.10856428519358495, 0.10856428519358495, 0.10856428519358495, 0.10856428519358495]
layer_partition: [0, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [43085.001, 21195.001, 20730.001, 20730.001, 20730.001, 81390.001], memory_state: [120754.99900000001, 142644.999, -4346.001, -4346.001, -4346.001, -65006.001000000004]
adj_stage_compute_performance(2): [0.40291102989760774, 0.34289122975521885, 0.07722361054157818, 0.07722361054157818, 0.07722361054157818, 0.019668823001372446]
layer_partition: [0, 4, 7, 8, 8, 8, 9]
stage_memory_demand: [53682.501, 31792.501, 20730.001, 0.001, 0.001, 20730.001], memory_state: [110157.49900000001, 132047.499, -4346.001, 16383.999, 16383.999, -4346.001]
adj_stage_compute_performance(3): [0.41542968010273185, 0.3487768723065209, 0.0549304590772521, 0.07804426279010902, 0.07797386704872097, 0.013990766158141408]
layer_partition: [0, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [53682.501, 31792.501, 20730.001, 0.001, 20730.001, 60660.001], memory_state: [110157.49900000001, 132047.499, -4346.001, 16383.999, -4346.001, -44276.001]
adj_stage_compute_performance(4): [0.44608243451919594, 0.36181827002933514, 0.039072963738377466, 0.07975404277564162, 0.055464129208369066, 0.003400960073533298]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 2, 1, 1, 1, 1], num_stage=6, batches=64, gbs=128)
valid_strategies: [(2, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 163840, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.2496414077228942, 0.2496414077228942, 0.1251792961385529, 0.1251792961385529, 0.1251792961385529, 0.1251792961385529]
layer_partition: [0, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [80560.001, 41460.001, 24192.501, 24192.501, 24192.501, 96962.501], memory_state: [83279.999, 122379.99900000001, -7808.501, -7808.501, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.4155321961175762, 0.33258680192023515, 0.07629818137201463, 0.07629818137201463, 0.07629818137201463, 0.01903667717008089]
layer_partition: [0, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [101290.001, 62190.001, 24192.501, 0.001, 24192.501, 72770.001], memory_state: [62549.998999999996, 101649.99900000001, -7808.501, 16383.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.4633351706189821, 0.35156300767563664, 0.04650459509081673, 0.07889527060572779, 0.04650459509081673, 0.0038574580599379784]
layer_partition: [0, 5, 8, 8, 9, 9, 10]
stage_memory_demand: [122020.001, 62190.001, 0.001, 24192.501, 0.001, 72770.001], memory_state: [41819.998999999996, 101649.99900000001, 16383.999, -7808.501, 16383.999, -56386.001000000004]
adj_stage_compute_performance(4): [0.4806270573713719, 0.3579876809295363, 0.04702536501044442, 0.04808755003229388, 0.0469986902690681, 0.0007816481075576934]
layer_partition: None
valid_strategies: [(1, 2), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 163840, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.23243437889167384, 0.2553661198063775, 0.12804987532548717, 0.12804987532548717, 0.12804987532548717, 0.12804987532548717]
layer_partition: [0, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [47470.001, 41460.001, 24192.501, 24192.501, 24192.501, 96962.501], memory_state: [116369.99900000001, 122379.99900000001, -7808.501, -7808.501, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.3940498140099535, 0.3483198423872111, 0.07804783149950076, 0.07804783149950076, 0.07804783149950076, 0.019473221318822044]
layer_partition: [0, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [60507.501, 62190.001, 24192.501, 0.001, 24192.501, 72770.001], memory_state: [103332.49900000001, 101649.99900000001, -7808.501, 16383.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.4407242365576537, 0.3697613541654704, 0.047571026416782555, 0.08081244837138699, 0.047571026416782555, 0.003945916288757813]
layer_partition: [0, 4, 7, 7, 8, 8, 9]
stage_memory_demand: [60507.501, 62190.001, 0.001, 24192.501, 0.001, 24192.501], memory_state: [103332.49900000001, 101649.99900000001, 16383.999, -7808.501, 16383.999, -7808.501]
adj_stage_compute_performance(4): [0.45683100550857764, 0.376698424082817, 0.04809911142880866, 0.04925609132785088, 0.04807137205243678, 0.0024050801207988874]
layer_partition: None
valid_strategies: [(1, 2), (1, 2), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 163840, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.23788960160191097, 0.23788960160191097, 0.13105519919904454, 0.13105519919904454, 0.13105519919904454, 0.13105519919904454]
layer_partition: [0, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [47470.001, 26075.001, 24192.501, 24192.501, 24192.501, 96962.501], memory_state: [116369.99900000001, 137764.999, -7808.501, -7808.501, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.41156728624305194, 0.32472844392248146, 0.07987961002086684, 0.07987961002086684, 0.07987961002086684, 0.019930256804219924]
layer_partition: [0, 4, 7, 8, 8, 8, 9]
stage_memory_demand: [60507.501, 39112.501, 24192.501, 0.001, 0.001, 24192.501], memory_state: [103332.49900000001, 124727.49900000001, -7808.501, 16383.999, 16383.999, -7808.501]
adj_stage_compute_performance(3): [0.43458890140211714, 0.3345496167609906, 0.04868751591758513, 0.08141999291967446, 0.08128267412554124, 0.012147714481123936]
layer_partition: [0, 4, 7, 7, 7, 8, 9]
stage_memory_demand: [60507.501, 39112.501, 0.001, 0.001, 24192.501, 24192.501], memory_state: [103332.49900000001, 124727.49900000001, 16383.999, 16383.999, -7808.501, -7808.501]
adj_stage_compute_performance(4): [0.4571421871284045, 0.3435207189035163, 0.049507375318705325, 0.0827168093110263, 0.04954269918540381, 0.00740416787222045]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 2, 1, 1, 1, 1], num_stage=6, batches=32, gbs=128)
valid_strategies: [(2, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 163840, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.29876123861135534, 0.29876123861135534, 0.10061938069432239, 0.10061938069432239, 0.10061938069432239, 0.10061938069432239]
layer_partition: [0, 3, 6, 7, 7, 8, 10]
stage_memory_demand: [88775.001, 72577.501, 31295.001, 0.001, 31295.001, 161715.001], memory_state: [75064.999, 91262.499, -14911.001, 16383.999, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.4137932920716841, 0.3645667367776744, 0.04740990869328301, 0.11329773483250659, 0.04740990869328301, 0.009174740319645427]
layer_partition: [0, 4, 7, 7, 8, 8, 9]
stage_memory_demand: [112967.501, 72577.501, 0.001, 31295.001, 0.001, 31295.001], memory_state: [50872.498999999996, 91262.499, 16383.999, -14911.001, 16383.999, -14911.001]
adj_stage_compute_performance(3): [0.45289722895892925, 0.38269218080418743, 0.04878288985705394, 0.053383704277440644, 0.04870834288727151, 0.004322960426087336]
layer_partition: [0, 5, 8, 8, 8, 8, 9]
stage_memory_demand: [137160.001, 72577.501, 0.001, 0.001, 0.001, 31295.001], memory_state: [26679.99900000001, 91262.499, 16383.999, 16383.999, 16383.999, -14911.001]
adj_stage_compute_performance(4): [0.45289722895892925, 0.38269218080418743, 0.04878288985705394, 0.053383704277440644, 0.04870834288727151, 0.0020368954536513174]
layer_partition: None
valid_strategies: [(1, 2), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 163840, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.28319996479301623, 0.3053910852432371, 0.10285223749093672, 0.10285223749093672, 0.10285223749093672, 0.10285223749093672]
layer_partition: [0, 3, 6, 7, 7, 8, 10]
stage_memory_demand: [61290.001, 72577.501, 31295.001, 0.001, 31295.001, 161715.001], memory_state: [102549.99900000001, 91262.499, -14911.001, 16383.999, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.3958077566329513, 0.3770869533825393, 0.048461987687629625, 0.116333823473563, 0.048461987687629625, 0.009378338087178176]
layer_partition: [0, 4, 7, 7, 8, 8, 9]
stage_memory_demand: [81500.001, 72577.501, 0.001, 31295.001, 0.001, 31295.001], memory_state: [82339.999, 91262.499, 16383.999, -14911.001, 16383.999, -14911.001]
adj_stage_compute_performance(3): [0.4343857710217309, 0.3971158349536074, 0.04992012429623784, 0.054814250602253395, 0.04983888414865294, 0.0044188917616041785]
layer_partition: [0, 5, 8, 8, 9, 9, 10]
stage_memory_demand: [101710.001, 72577.501, 0.001, 31295.001, 0.001, 130420.001], memory_state: [62129.998999999996, 91262.499, 16383.999, -14911.001, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.44973480243570957, 0.40460267168279457, 0.05045993882323394, 0.02582741613207131, 0.05034893057245804, 0.0004996105647929765]
layer_partition: None
valid_strategies: [(1, 2), (1, 2), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 163840, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.2896271149873505, 0.2896271149873505, 0.1051864425063248, 0.1051864425063248, 0.1051864425063248, 0.1051864425063248]
layer_partition: [0, 3, 6, 7, 7, 8, 10]
stage_memory_demand: [61290.001, 60630.001, 31295.001, 0.001, 31295.001, 161715.001], memory_state: [102549.99900000001, 103209.99900000001, -14911.001, 16383.999, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.4087451303344265, 0.35833929018624483, 0.04956182000509485, 0.11958140355847062, 0.04956182000509485, 0.009591177052407546]
layer_partition: [0, 4, 7, 7, 8, 8, 9]
stage_memory_demand: [81500.001, 60630.001, 0.001, 31295.001, 0.001, 31295.001], memory_state: [82339.999, 103209.99900000001, 16383.999, -14911.001, 16383.999, -14911.001]
adj_stage_compute_performance(3): [0.4498501186898027, 0.3773706602267816, 0.051105126408397816, 0.056344447610395816, 0.05101682305766897, 0.004519177370979497]
layer_partition: [0, 5, 8, 8, 9, 9, 10]
stage_memory_demand: [101710.001, 60630.001, 0.001, 31295.001, 0.001, 130420.001], memory_state: [62129.998999999996, 103209.99900000001, 16383.999, -14911.001, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.46621313539352344, 0.384452884552706, 0.05167477523888793, 0.026548415406149137, 0.051554216393170926, 0.0005109490977654208]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 2, 1, 1, 1, 1], num_stage=6, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 2, 1, 1, 1, 1], num_stage=6, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 2, 1, 1, 1, 1], num_stage=6, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 2, 1, 1, 1, 1], num_stage=6, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 2, 1, 1, 1, 1], num_stage=6, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 2, 2, 1, 1], num_stage=6, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 163840, 32768, 16384, 16384]
stage_compute_performance: [0.1673614202200749, 0.1673614202200749, 0.29089409087318746, 0.1510964038869668, 0.11164333239984783, 0.11164333239984783]
layer_partition: [0, 2, 4, 6, 7, 8, 10]
stage_memory_demand: [59830.001, 41460.001, 21195.001, 10597.501, 20730.001, 81390.001], memory_state: [22089.999000000003, 40459.999, 142644.999, 22170.499, -4346.001, -65006.001000000004]
adj_stage_compute_performance(2): [0.20482701613541088, 0.19675415957737966, 0.3309740277555665, 0.16411787975825104, 0.0794137888481142, 0.020226660548083742]
layer_partition: [0, 3, 4, 7, 8, 8, 9]
stage_memory_demand: [80560.001, 20730.001, 31792.501, 10597.501, 0.001, 20730.001], memory_state: [1359.9989999999962, 61189.998999999996, 132047.499, 22170.499, 16383.999, -4346.001]
adj_stage_compute_performance(3): [0.20482701613541088, 0.19675415957737966, 0.3309740277555665, 0.16411787975825104, 0.0794137888481142, 0.014387565431271501]
layer_partition: [0, 3, 4, 7, 8, 9, 10]
stage_memory_demand: [80560.001, 20730.001, 31792.501, 10597.501, 20730.001, 60660.001], memory_state: [1359.9989999999962, 61189.998999999996, 132047.499, 22170.499, -4346.001, -44276.001]
adj_stage_compute_performance(4): [0.20828486784419054, 0.20688885706361582, 0.34390189340786104, 0.167935580640665, 0.05648836991559975, 0.0034974164412453113]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 2, 2, 1, 1], num_stage=6, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 163840, 32768, 16384, 16384]
stage_compute_performance: [0.1365216549233389, 0.1365216549233389, 0.27227330592019056, 0.18162787550727974, 0.13652775436292594, 0.13652775436292594]
layer_partition: [0, 2, 3, 5, 7, 8, 10]
stage_memory_demand: [64582.501, 24192.501, 41460.001, 41460.001, 24192.501, 96962.501], memory_state: [17337.499000000003, 57727.498999999996, 122379.99900000001, -8692.000999999997, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.17317158360466597, 0.2111293841645573, 0.3790933480650998, 0.12919498005222646, 0.083215193614499, 0.020762497191919183]
layer_partition: [0, 2, 4, 7, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 62190.001, 20730.001, 24192.501, 72770.001], memory_state: [17337.499000000003, 33534.999, 101649.99900000001, 12037.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.18556891752866386, 0.22331169855772903, 0.3957933270481144, 0.13246914644356939, 0.050720591432938514, 0.004207166062745602]
layer_partition: [0, 2, 4, 8, 9, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 82920.001, 20730.001, 0.001, 72770.001], memory_state: [17337.499000000003, 33534.999, 80919.999, 12037.999, 16383.999, -56386.001000000004]
adj_stage_compute_performance(4): [0.18556891752866386, 0.22331169855772903, 0.3957933270481144, 0.13246914644356939, 0.050720591432938514, 0.0008525104719295188]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 2), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 163840, 32768, 16384, 16384]
stage_compute_performance: [0.13994326741716823, 0.13994326741716823, 0.2540344503338384, 0.18617997538046363, 0.1399495197256808, 0.1399495197256808]
layer_partition: [0, 2, 3, 5, 7, 8, 10]
stage_memory_demand: [64582.501, 24192.501, 26075.001, 41460.001, 24192.501, 96962.501], memory_state: [17337.499000000003, 57727.498999999996, 137764.999, -8692.000999999997, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.17751174527623856, 0.2216097594885974, 0.35801685781696146, 0.13243296568999913, 0.08530079788224453, 0.021282863135584744]
layer_partition: [0, 2, 4, 7, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 39112.501, 20730.001, 24192.501, 72770.001], memory_state: [17337.499000000003, 33534.999, 124727.49900000001, 12037.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.1906117701754857, 0.23470065837619872, 0.3738970137250529, 0.13594302446178708, 0.051991790565697395, 0.004312609349175059]
layer_partition: [0, 3, 5, 8, 9, 9, 10]
stage_memory_demand: [88775.001, 48385.001, 39112.501, 20730.001, 0.001, 72770.001], memory_state: [-6855.001000000004, 33534.999, 124727.49900000001, 12037.999, 16383.999, -56386.001000000004]
adj_stage_compute_performance(4): [0.15830385168340588, 0.24828931256849782, 0.3891662382424815, 0.13888869631592193, 0.052926099195030975, 0.0008738767561538958]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 163840, 32768, 16384, 16384]
stage_compute_performance: [0.14233834837999035, 0.14233834837999035, 0.25838216271132514, 0.17225172513946235, 0.14234470769461594, 0.14234470769461594]
layer_partition: [0, 2, 3, 5, 7, 8, 10]
stage_memory_demand: [64582.501, 24192.501, 26075.001, 26075.001, 24192.501, 96962.501], memory_state: [17337.499000000003, 57727.498999999996, 137764.999, 6692.999, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.18054979783593098, 0.1857184110563674, 0.3210111201433351, 0.19851480599653323, 0.08676069174417844, 0.021647112029234156]
layer_partition: [0, 2, 4, 7, 8, 8, 9]
stage_memory_demand: [64582.501, 48385.001, 39112.501, 13037.501, 0.001, 24192.501], memory_state: [17337.499000000003, 33534.999, 124727.49900000001, 19730.499, 16383.999, -7808.501]
adj_stage_compute_performance(3): [0.18054979783593098, 0.1857184110563674, 0.3210111201433351, 0.19851480599653323, 0.08676069174417844, 0.013194156947157929]
layer_partition: [0, 2, 3, 6, 8, 9, 10]
stage_memory_demand: [64582.501, 24192.501, 39112.501, 26075.001, 24192.501, 72770.001], memory_state: [17337.499000000003, 57727.498999999996, 124727.49900000001, 6692.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(4): [0.192416865127131, 0.19543711080311377, 0.33428767824995487, 0.20374969110006855, 0.05288161220631788, 0.002673570949655641]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 2, 2, 1, 1], num_stage=6, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 163840, 32768, 16384, 16384]
stage_compute_performance: [0.13712990127710664, 0.13712990127710664, 0.27144459020467265, 0.2714567176571278, 0.09141944479199314, 0.09141944479199314]
layer_partition: [0, 2, 3, 5, 8, 9, 10]
stage_memory_demand: [76685.001, 31295.001, 48385.001, 72577.501, 31295.001, 130420.001], memory_state: [5234.998999999996, 50624.998999999996, 115454.99900000001, -39809.501000000004, -14911.001, -114036.001]
adj_stage_compute_performance(2): [0.146491248172776, 0.25123285188681976, 0.4332993340794872, 0.11030394049761905, 0.04307507659529438, 0.010336103011721446]
layer_partition: [0, 2, 4, 8, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 96770.001, 24192.501, 0.001, 130420.001], memory_state: [5234.998999999996, 19329.999000000003, 67069.999, 8575.499, 16383.999, -114036.001]
adj_stage_compute_performance(3): [0.146491248172776, 0.25123285188681976, 0.4332993340794872, 0.11030394049761905, 0.04307507659529438, 0.0011686247462123524]
layer_partition: [0, 2, 4, 8, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 96770.001, 24192.501, 0.001, 130420.001], memory_state: [5234.998999999996, 19329.999000000003, 67069.999, 8575.499, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.146491248172776, 0.25123285188681976, 0.4332993340794872, 0.11030394049761905, 0.04307507659529438, 0.00013212753355023254]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 2), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 163840, 32768, 16384, 16384]
stage_compute_performance: [0.13988913215886137, 0.13988913215886137, 0.25678511355475875, 0.2769187777289553, 0.09325892219928164, 0.09325892219928164]
layer_partition: [0, 2, 3, 5, 7, 8, 10]
stage_memory_demand: [76685.001, 31295.001, 40420.001, 48385.001, 31295.001, 161715.001], memory_state: [5234.998999999996, 50624.998999999996, 123419.99900000001, -15617.000999999997, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.14943884145550082, 0.23939398856929328, 0.3852626347682815, 0.16878509639299516, 0.04394180281961734, 0.008503594315172577]
layer_partition: [0, 2, 4, 7, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 60630.001, 48385.001, 0.001, 130420.001], memory_state: [5234.998999999996, 19329.999000000003, 103209.99900000001, -15617.000999999997, 16383.999, -114036.001]
adj_stage_compute_performance(3): [0.1596404737874963, 0.26592308264583553, 0.4146182468263209, 0.102876406569571, 0.045613667337611984, 0.0009614368913692061]
layer_partition: [0, 2, 4, 8, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 80840.001, 24192.501, 0.001, 130420.001], memory_state: [5234.998999999996, 19329.999000000003, 82999.999, 8575.499, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.1596404737874963, 0.26592308264583553, 0.4146182468263209, 0.102876406569571, 0.045613667337611984, 0.00010870237476362052]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 163840, 32768, 16384, 16384]
stage_compute_performance: [0.1564216806205839, 0.1564216806205839, 0.2871328058206018, 0.1914627085942784, 0.10428056217197602, 0.10428056217197602]
layer_partition: [0, 2, 3, 5, 7, 8, 10]
stage_memory_demand: [76685.001, 31295.001, 40420.001, 40420.001, 31295.001, 161715.001], memory_state: [5234.998999999996, 50624.998999999996, 123419.99900000001, -7652.000999999997, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.1671000053379178, 0.23811354172734553, 0.39261075128915873, 0.13969482662050364, 0.04913498668886733, 0.00950857649602395]
layer_partition: [0, 2, 4, 8, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 80840.001, 20210.001, 0.001, 130420.001], memory_state: [5234.998999999996, 19329.999000000003, 82999.999, 12557.999, 16383.999, -114036.001]
adj_stage_compute_performance(3): [0.1671000053379178, 0.23811354172734553, 0.39261075128915873, 0.13969482662050364, 0.04913498668886733, 0.0010750626016309474]
layer_partition: [0, 2, 4, 8, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 80840.001, 20210.001, 0.001, 130420.001], memory_state: [5234.998999999996, 19329.999000000003, 82999.999, 12557.999, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.1671000053379178, 0.23811354172734553, 0.39261075128915873, 0.13969482662050364, 0.04913498668886733, 0.00012154917173025705]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 2, 2, 1, 1], num_stage=6, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 2, 2, 1, 1], num_stage=6, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 2, 2, 1, 1], num_stage=6, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 2, 2, 1, 1], num_stage=6, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 2, 2, 1, 1], num_stage=6, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[2, 1, 1, 2, 1, 1], num_stage=6, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920, 32768, 16384, 16384]
stage_compute_performance: [0.29089409087318746, 0.1673614202200749, 0.1673614202200749, 0.1510964038869668, 0.11164333239984783, 0.11164333239984783]
layer_partition: [0, 3, 4, 6, 7, 8, 10]
stage_memory_demand: [43085.001, 20730.001, 41460.001, 10597.501, 20730.001, 81390.001], memory_state: [120754.99900000001, 61189.998999999996, 40459.999, 22170.499, -4346.001, -65006.001000000004]
adj_stage_compute_performance(2): [0.3560137609171119, 0.19079542948832018, 0.18574601306292496, 0.16411787975825104, 0.0794137888481142, 0.020226660548083742]
layer_partition: [0, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [53682.501, 41460.001, 20730.001, 10597.501, 20730.001, 60660.001], memory_state: [110157.49900000001, 40459.999, 61189.998999999996, 22170.499, -4346.001, -44276.001]
adj_stage_compute_performance(3): [0.37586207209223316, 0.19720921311508752, 0.19066143879536074, 0.16756128751893037, 0.05648836991559975, 0.004916819005291866]
layer_partition: [0, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [53682.501, 41460.001, 41460.001, 10597.501, 0.001, 60660.001], memory_state: [110157.49900000001, 40459.999, 40459.999, 22170.499, 16383.999, -44276.001]
adj_stage_compute_performance(4): [0.37586207209223316, 0.19720921311508752, 0.19066143879536074, 0.16756128751893037, 0.05648836991559975, 0.0011952101076363605]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[2, 1, 1, 2, 1, 1], num_stage=6, batches=64, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920, 32768, 16384, 16384]
stage_compute_performance: [0.27227330592019056, 0.1365216549233389, 0.1365216549233389, 0.18162787550727974, 0.13652775436292594, 0.13652775436292594]
layer_partition: [0, 3, 4, 5, 7, 8, 10]
stage_memory_demand: [80560.001, 24192.501, 24192.501, 41460.001, 24192.501, 96962.501], memory_state: [83279.999, 57727.498999999996, 57727.498999999996, -8692.000999999997, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.4227496075284597, 0.17430038866775702, 0.16484236904654467, 0.12919498005222646, 0.083215193614499, 0.020762497191919183]
layer_partition: [0, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [101290.001, 48385.001, 24192.501, 20730.001, 24192.501, 72770.001], memory_state: [62549.998999999996, 33534.999, 57727.498999999996, 12037.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.45287548662832466, 0.1808285931455529, 0.16980868171853963, 0.13236727613950597, 0.050720591432938514, 0.004207166062745602]
layer_partition: [0, 5, 7, 8, 9, 9, 10]
stage_memory_demand: [122020.001, 48385.001, 24192.501, 20730.001, 0.001, 72770.001], memory_state: [41819.998999999996, 33534.999, 57727.498999999996, 12037.999, 16383.999, -56386.001000000004]
adj_stage_compute_performance(4): [0.45287548662832466, 0.1808285931455529, 0.16980868171853963, 0.13236727613950597, 0.050720591432938514, 0.0008525104719295188]
layer_partition: None
valid_strategies: [(1, 2), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920, 32768, 16384, 16384]
stage_compute_performance: [0.2540344503338384, 0.13994326741716823, 0.13994326741716823, 0.18617997538046363, 0.1399495197256808, 0.1399495197256808]
layer_partition: [0, 3, 4, 5, 7, 8, 10]
stage_memory_demand: [47470.001, 24192.501, 24192.501, 41460.001, 24192.501, 96962.501], memory_state: [116369.99900000001, 57727.498999999996, 57727.498999999996, -8692.000999999997, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.40170569467182604, 0.18258750382218758, 0.17141024361925916, 0.13243296568999913, 0.08530079788224453, 0.021282863135584744]
layer_partition: [0, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [60507.501, 48385.001, 24192.501, 20730.001, 24192.501, 72770.001], memory_state: [103332.49900000001, 33534.999, 57727.498999999996, 12037.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.4312414974802006, 0.18994031066899836, 0.17689385067024865, 0.1358519668157664, 0.051991790565697395, 0.004312609349175059]
layer_partition: [0, 4, 6, 7, 9, 9, 10]
stage_memory_demand: [60507.501, 48385.001, 24192.501, 41460.001, 0.001, 72770.001], memory_state: [103332.49900000001, 33534.999, 57727.498999999996, -8692.000999999997, 16383.999, -56386.001000000004]
adj_stage_compute_performance(4): [0.45903712403229374, 0.19597219860412693, 0.1812562262860673, 0.09663380190842567, 0.05300714760532805, 0.0008738767561538958]
layer_partition: None
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920, 32768, 16384, 16384]
stage_compute_performance: [0.25838216271132514, 0.14233834837999035, 0.14233834837999035, 0.17225172513946235, 0.14234470769461594, 0.14234470769461594]
layer_partition: [0, 3, 4, 5, 7, 8, 10]
stage_memory_demand: [47470.001, 24192.501, 24192.501, 26075.001, 24192.501, 96962.501], memory_state: [116369.99900000001, 57727.498999999996, 57727.498999999996, 6692.999, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.34803653936920065, 0.1738872620717767, 0.1676094012869887, 0.19674821860048144, 0.08676069174417844, 0.021647112029234156]
layer_partition: [0, 4, 5, 6, 8, 9, 10]
stage_memory_demand: [60507.501, 24192.501, 24192.501, 26075.001, 24192.501, 72770.001], memory_state: [103332.49900000001, 57727.498999999996, 57727.498999999996, 6692.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.3743033717516004, 0.18185727257671094, 0.1737844189447497, 0.20262594991166066, 0.05288161220631788, 0.004386418177158953]
layer_partition: [0, 4, 6, 7, 9, 9, 10]
stage_memory_demand: [60507.501, 48385.001, 24192.501, 26075.001, 0.001, 72770.001], memory_state: [103332.49900000001, 33534.999, 57727.498999999996, 6692.999, 16383.999, -56386.001000000004]
adj_stage_compute_performance(4): [0.3743033717516004, 0.18185727257671094, 0.1737844189447497, 0.20262594991166066, 0.05288161220631788, 0.000888832856730551]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[2, 1, 1, 2, 1, 1], num_stage=6, batches=32, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920, 32768, 16384, 16384]
stage_compute_performance: [0.27144459020467265, 0.13712990127710664, 0.13712990127710664, 0.2714567176571278, 0.09141944479199314, 0.09141944479199314]
layer_partition: [0, 3, 4, 5, 8, 9, 10]
stage_memory_demand: [88775.001, 31295.001, 31295.001, 72577.501, 31295.001, 130420.001], memory_state: [75064.999, 50624.998999999996, 50624.998999999996, -39809.501000000004, -14911.001, -114036.001]
adj_stage_compute_performance(2): [0.46817909642457556, 0.18707998511558166, 0.1745280427884842, 0.11030394049761905, 0.04307507659529438, 0.010336103011721446]
layer_partition: [0, 5, 7, 8, 9, 9, 10]
stage_memory_demand: [137160.001, 62590.001, 31295.001, 24192.501, 0.001, 130420.001], memory_state: [26679.99900000001, 19329.999000000003, 50624.998999999996, 8575.499, 16383.999, -114036.001]
adj_stage_compute_performance(3): [0.46817909642457556, 0.18707998511558166, 0.1745280427884842, 0.11030394049761905, 0.04307507659529438, 0.0011686247462123524]
layer_partition: [0, 5, 7, 8, 9, 9, 10]
stage_memory_demand: [137160.001, 62590.001, 31295.001, 24192.501, 0.001, 130420.001], memory_state: [26679.99900000001, 19329.999000000003, 50624.998999999996, 8575.499, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.46817909642457556, 0.18707998511558166, 0.1745280427884842, 0.11030394049761905, 0.04307507659529438, 0.00013212753355023254]
layer_partition: None
valid_strategies: [(1, 2), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920, 32768, 16384, 16384]
stage_compute_performance: [0.25678511355475875, 0.13988913215886137, 0.13988913215886137, 0.2769187777289553, 0.09325892219928164, 0.09325892219928164]
layer_partition: [0, 3, 4, 5, 7, 8, 10]
stage_memory_demand: [61290.001, 31295.001, 31295.001, 48385.001, 31295.001, 161715.001], memory_state: [102549.99900000001, 50624.998999999996, 50624.998999999996, -15617.000999999997, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.41514590711852883, 0.1848727878564568, 0.17314495696754892, 0.16878509639299516, 0.04394180281961734, 0.008503594315172577]
layer_partition: [0, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [81500.001, 62590.001, 62590.001, 24192.501, 0.001, 130420.001], memory_state: [82339.999, 19329.999000000003, 19329.999000000003, 8575.499, 16383.999, -114036.001]
adj_stage_compute_performance(3): [0.41514590711852883, 0.1848727878564568, 0.17314495696754892, 0.16878509639299516, 0.04394180281961734, 0.0009614368913692061]
layer_partition: [0, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [81500.001, 62590.001, 62590.001, 24192.501, 0.001, 130420.001], memory_state: [82339.999, 19329.999000000003, 19329.999000000003, 8575.499, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.41514590711852883, 0.1848727878564568, 0.17314495696754892, 0.16878509639299516, 0.04394180281961734, 0.00010870237476362052]
layer_partition: None
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920, 32768, 16384, 16384]
stage_compute_performance: [0.2871328058206018, 0.1564216806205839, 0.1564216806205839, 0.1914627085942784, 0.10428056217197602, 0.10428056217197602]
layer_partition: [0, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [61290.001, 62590.001, 31295.001, 20210.001, 31295.001, 161715.001], memory_state: [102549.99900000001, 19329.999000000003, 50624.998999999996, 12557.999, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.36369661260117686, 0.1829992014831734, 0.17774636313023204, 0.21240566221488946, 0.04913498668886733, 0.00950857649602395]
layer_partition: [0, 4, 6, 7, 9, 9, 10]
stage_memory_demand: [81500.001, 62590.001, 31295.001, 40420.001, 0.001, 130420.001], memory_state: [82339.999, 19329.999000000003, 50624.998999999996, -7652.000999999997, 16383.999, -114036.001]
adj_stage_compute_performance(3): [0.4036975432073034, 0.19366353465046432, 0.18565422053556419, 0.15497520313054294, 0.05081870043596313, 0.0010750626016309474]
layer_partition: [0, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [81500.001, 62590.001, 62590.001, 20210.001, 0.001, 130420.001], memory_state: [82339.999, 19329.999000000003, 19329.999000000003, 12557.999, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.4036975432073034, 0.19366353465046432, 0.18565422053556419, 0.15497520313054294, 0.05081870043596313, 0.00012154917173025705]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[2, 1, 1, 2, 1, 1], num_stage=6, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[2, 1, 1, 2, 1, 1], num_stage=6, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[2, 1, 1, 2, 1, 1], num_stage=6, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[2, 1, 1, 2, 1, 1], num_stage=6, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[2, 1, 1, 2, 1, 1], num_stage=6, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[1, 1, 2, 1, 1, 2], num_stage=6, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [81920, 81920, 163840, 16384, 16384, 32768]
stage_compute_performance: [0.1673614202200749, 0.1673614202200749, 0.29089409087318746, 0.11164333239984783, 0.11164333239984783, 0.1510964038869668]
layer_partition: [0, 2, 4, 6, 7, 8, 10]
stage_memory_demand: [59830.001, 41460.001, 21195.001, 20730.001, 20730.001, 41757.501], memory_state: [22089.999000000003, 40459.999, 142644.999, -4346.001, -4346.001, -8989.500999999997]
adj_stage_compute_performance(2): [0.20483712888761607, 0.1948118442247044, 0.32584253181717043, 0.0794137888481142, 0.0794137888481142, 0.10671170830628289]
layer_partition: [0, 3, 4, 7, 8, 8, 10]
stage_memory_demand: [80560.001, 20730.001, 31792.501, 20730.001, 0.001, 41757.501], memory_state: [1359.9989999999962, 61189.998999999996, 132047.499, -4346.001, 16383.999, -8989.500999999997]
adj_stage_compute_performance(3): [0.20829515131800344, 0.21381828862676097, 0.34901157698650154, 0.05648836991559975, 0.08251940697639243, 0.0753650543408297]
layer_partition: [0, 2, 4, 7, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 31792.501, 20730.001, 20730.001, 31160.001], memory_state: [22089.999000000003, 40459.999, 132047.499, -4346.001, -4346.001, 1607.9989999999998]
adj_stage_compute_performance(4): [0.22114864746365323, 0.22376589139752176, 0.361147421826413, 0.04018113204275618, 0.05869744856795194, 0.07690516753489691]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[1, 1, 2, 1, 1, 2], num_stage=6, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [81920, 81920, 163840, 16384, 16384, 32768]
stage_compute_performance: [0.1365216549233389, 0.1365216549233389, 0.27227330592019056, 0.13652775436292594, 0.13652775436292594, 0.18162787550727974]
layer_partition: [0, 2, 3, 5, 7, 8, 10]
stage_memory_demand: [64582.501, 24192.501, 41460.001, 48385.001, 24192.501, 81390.001], memory_state: [17337.499000000003, 57727.498999999996, 122379.99900000001, -32001.000999999997, -7808.501, -48622.001000000004]
adj_stage_compute_performance(2): [0.17317158360466597, 0.2282972660509035, 0.40367356093700124, 0.04160759766717709, 0.083215193614499, 0.06581181885180573]
layer_partition: [0, 2, 4, 7, 7, 8, 9]
stage_memory_demand: [64582.501, 48385.001, 62190.001, 0.001, 24192.501, 20730.001], memory_state: [17337.499000000003, 33534.999, 101649.99900000001, 16383.999, -7808.501, 12037.999]
adj_stage_compute_performance(3): [0.17933789645186837, 0.23488386248334048, 0.4124063385262933, 0.04210954121277742, 0.050720591432938514, 0.06656955701492988]
layer_partition: [0, 2, 4, 8, 8, 8, 9]
stage_memory_demand: [64582.501, 48385.001, 82920.001, 0.001, 0.001, 20730.001], memory_state: [17337.499000000003, 33534.999, 80919.999, 16383.999, 16383.999, 12037.999]
layer_partition: [0, 2, 4, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [1, 1, 2, 1, 1, 2], num_stage: 6, batches: 64, gbs: 128, strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (2, 1)], layer_partition: [0, 2, 4, 8, 8, 8, 9]
execution_cost: 7775.526921749115, fb_sync_cost: 10367.741088867188, parameter_upate_costs: 16.241226196289062, dp_cost: 16.78328804347826, pp_cost: 0.7547826086956522
cost: 18242.69214389055
valid_strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [81920, 81920, 163840, 16384, 16384, 32768]
stage_compute_performance: [0.13880009480494118, 0.13880009480494118, 0.2768173349187594, 0.13880629603941502, 0.13880629603941502, 0.16796988339252825]
layer_partition: [0, 2, 3, 5, 7, 8, 10]
stage_memory_demand: [64582.501, 24192.501, 41460.001, 48385.001, 24192.501, 57202.501], memory_state: [17337.499000000003, 57727.498999999996, 122379.99900000001, -32001.000999999997, -7808.501, -24434.500999999997]
adj_stage_compute_performance(2): [0.17606168219500792, 0.21742592138198397, 0.3893903108564583, 0.04230199600241402, 0.08460399025626983, 0.08659819655622626]
layer_partition: [0, 2, 4, 7, 7, 7, 9]
stage_memory_demand: [64582.501, 48385.001, 62190.001, 0.001, 0.001, 26075.001], memory_state: [17337.499000000003, 33534.999, 101649.99900000001, 16383.999, 16383.999, 6692.999]
layer_partition: [0, 2, 4, 7, 7, 7, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [1, 1, 2, 1, 1, 2], num_stage: 6, batches: 64, gbs: 128, strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 2, 4, 7, 7, 7, 9]
execution_cost: 7779.250999183655, fb_sync_cost: 5207.039999999997, parameter_upate_costs: 12.180919647216797, dp_cost: 12.587466032608695, pp_cost: 0.7547826086956522
cost: 13077.459003897955
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [81920, 81920, 163840, 16384, 16384, 32768]
stage_compute_performance: [0.14233834837999035, 0.14233834837999035, 0.25838216271132514, 0.14234470769461594, 0.14234470769461594, 0.17225172513946235]
layer_partition: [0, 2, 3, 5, 6, 7, 10]
stage_memory_demand: [64582.501, 24192.501, 26075.001, 24192.501, 24192.501, 70240.001], memory_state: [17337.499000000003, 57727.498999999996, 137764.999, -7808.501, -7808.501, -37472.001000000004]
adj_stage_compute_performance(2): [0.18054979783593098, 0.2168473574231765, 0.35325125703603133, 0.08676069174417844, 0.08676069174417844, 0.07232218115191816]
layer_partition: [0, 2, 4, 7, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 39112.501, 24192.501, 24192.501, 44165.001], memory_state: [17337.499000000003, 33534.999, 124727.49900000001, -7808.501, -7808.501, -11397.000999999997]
adj_stage_compute_performance(3): [0.20893920670298363, 0.24274301193943626, 0.38324974267675443, 0.05288161220631788, 0.05288161220631788, 0.04829317016855607]
layer_partition: [0, 3, 5, 8, 8, 8, 9]
stage_memory_demand: [88775.001, 48385.001, 39112.501, 0.001, 0.001, 13037.501], memory_state: [-6855.001000000004, 33534.999, 124727.49900000001, 16383.999, 16383.999, 19730.499]
adj_stage_compute_performance(4): [0.17352486238549947, 0.256911489024808, 0.39865816386827924, 0.053963120870457994, 0.0538898025137446, 0.049151464137818096]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[1, 1, 2, 1, 1, 2], num_stage=6, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [81920, 81920, 163840, 16384, 16384, 32768]
stage_compute_performance: [0.13712990127710664, 0.13712990127710664, 0.27144459020467265, 0.09141944479199314, 0.09141944479199314, 0.2714567176571278]
layer_partition: [0, 2, 3, 5, 6, 7, 10]
stage_memory_demand: [76685.001, 31295.001, 48385.001, 31295.001, 31295.001, 121155.001], memory_state: [5234.998999999996, 50624.998999999996, 115454.99900000001, -14911.001, -14911.001, -88387.001]
adj_stage_compute_performance(2): [0.146491248172776, 0.2558939394826639, 0.4399110749238051, 0.04307507659529438, 0.04307507659529438, 0.0660772092418198]
layer_partition: [0, 2, 4, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 96770.001, 0.001, 0.001, 24192.501], memory_state: [5234.998999999996, 19329.999000000003, 67069.999, 16383.999, 16383.999, 8575.499]
layer_partition: [0, 2, 4, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [1, 1, 2, 1, 1, 2], num_stage: 6, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (2, 1)], layer_partition: [0, 2, 4, 8, 8, 8, 9]
execution_cost: 7944.168742523193, fb_sync_cost: 3458.8799999999974, parameter_upate_costs: 16.241226196289062, dp_cost: 16.78328804347826, pp_cost: 1.5095652173913043
cost: 11470.40524019324
valid_strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [81920, 81920, 163840, 16384, 16384, 32768]
stage_compute_performance: [0.15297974468725434, 0.15297974468725434, 0.30281888719757827, 0.10198595050009311, 0.10198595050009311, 0.18724972242772692]
layer_partition: [0, 2, 3, 6, 7, 8, 10]
stage_memory_demand: [76685.001, 31295.001, 72577.501, 31295.001, 31295.001, 79860.001], memory_state: [5234.998999999996, 50624.998999999996, 91262.499, -14911.001, -14911.001, -47092.001000000004]
adj_stage_compute_performance(2): [0.16342310127608753, 0.24042644074175526, 0.42686180210003616, 0.04805380999010587, 0.04805380999010587, 0.06914874711885591]
layer_partition: [0, 2, 4, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 96770.001, 0.001, 0.001, 20210.001], memory_state: [5234.998999999996, 19329.999000000003, 67069.999, 16383.999, 16383.999, 12557.999]
layer_partition: [0, 2, 4, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [1, 1, 2, 1, 1, 2], num_stage: 6, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 2, 4, 8, 8, 8, 9]
execution_cost: 7980.1887425231935, fb_sync_cost: 1107.0720000000038, parameter_upate_costs: 16.241226196289062, dp_cost: 16.78328804347826, pp_cost: 1.5095652173913043
cost: 9154.617240193247
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [81920, 81920, 163840, 16384, 16384, 32768]
stage_compute_performance: [0.1564216806205839, 0.1564216806205839, 0.2871328058206018, 0.10428056217197602, 0.10428056217197602, 0.1914627085942784]
layer_partition: [0, 2, 3, 6, 7, 8, 10]
stage_memory_demand: [76685.001, 31295.001, 60630.001, 31295.001, 31295.001, 79860.001], memory_state: [5234.998999999996, 50624.998999999996, 103209.99900000001, -14911.001, -14911.001, -47092.001000000004]
adj_stage_compute_performance(2): [0.1671000053379178, 0.25067218000687913, 0.4088260675478592, 0.04913498668886733, 0.04913498668886733, 0.07070454496607861]
layer_partition: [0, 2, 4, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 80840.001, 0.001, 0.001, 20210.001], memory_state: [5234.998999999996, 19329.999000000003, 82999.999, 16383.999, 16383.999, 12557.999]
layer_partition: [0, 2, 4, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [1, 1, 2, 1, 1, 2], num_stage: 6, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (1, 2), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 2, 4, 8, 8, 8, 9]
execution_cost: 8541.895285491943, fb_sync_cost: 1107.0720000000038, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 1.6834782608695653
cost: 9691.59379506385


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[1, 1, 2, 1, 1, 2], num_stage=6, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[1, 1, 2, 1, 1, 2], num_stage=6, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[1, 1, 2, 1, 1, 2], num_stage=6, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[1, 1, 2, 1, 1, 2], num_stage=6, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[1, 1, 2, 1, 1, 2], num_stage=6, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[1, 1, 1, 1, 2, 2], num_stage=6, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 2), (1, 2)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 32768, 32768]
stage_compute_performance: [0.17224659394861833, 0.17224659394861833, 0.17224659394861833, 0.17224659394861833, 0.15550681210276335, 0.15550681210276335]
layer_partition: [0, 2, 3, 5, 7, 8, 10]
stage_memory_demand: [59830.001, 20730.001, 41460.001, 41460.001, 10597.501, 41757.501], memory_state: [22089.999000000003, 61189.998999999996, 40459.999, 40459.999, 22170.499, -8989.500999999997]
adj_stage_compute_performance(2): [0.18461604361192346, 0.18209311553617627, 0.1800847751137728, 0.17848606475376175, 0.15999095033763078, 0.10982655540342358]
layer_partition: [0, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [80560.001, 41460.001, 20730.001, 20730.001, 10597.501, 41757.501], memory_state: [1359.9989999999962, 40459.999, 61189.998999999996, 61189.998999999996, 22170.499, -8989.500999999997]
adj_stage_compute_performance(3): [0.1877326974299413, 0.19122280891201837, 0.18708855662860666, 0.1838936910469977, 0.1637804717377085, 0.07756491248634456]
layer_partition: [0, 2, 4, 6, 7, 8, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 10597.501, 41757.501], memory_state: [22089.999000000003, 40459.999, 40459.999, 61189.998999999996, 22170.499, -8989.500999999997]
adj_stage_compute_performance(4): [0.19241405761061975, 0.19501148524985146, 0.190019570308396, 0.1861847606836069, 0.16541029213515332, 0.05478015427976126]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[1, 1, 1, 1, 2, 2], num_stage=6, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (2, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 32768, 32768]
stage_compute_performance: [0.15013229265568917, 0.15013229265568917, 0.15013229265568917, 0.15013229265568917, 0.19973541468862166, 0.19973541468862166]
layer_partition: [0, 2, 3, 5, 6, 8, 10]
stage_memory_demand: [64582.501, 24192.501, 48385.001, 24192.501, 41460.001, 81390.001], memory_state: [17337.499000000003, 57727.498999999996, 33534.999, 57727.498999999996, -8692.000999999997, -48622.001000000004]
adj_stage_compute_performance(2): [0.19043606586796719, 0.21269306514628253, 0.19485445130358323, 0.18220829782824238, 0.14207517895778826, 0.07237298180725024]
layer_partition: [0, 2, 4, 6, 7, 8, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 24192.501, 20730.001, 81390.001], memory_state: [17337.499000000003, 33534.999, 33534.999, 57727.498999999996, 12037.999, -48622.001000000004]
adj_stage_compute_performance(3): [0.20308002898490898, 0.2238988285912398, 0.20275285713531588, 0.18803363934425624, 0.14572003986291227, 0.026223934818160013]
layer_partition: [0, 2, 4, 6, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 48385.001, 20730.001, 60660.001], memory_state: [17337.499000000003, 33534.999, 33534.999, 33534.999, 12037.999, -27892.000999999997]
adj_stage_compute_performance(4): [0.2059201550738553, 0.22637011034652865, 0.20447069156422518, 0.18929151214917556, 0.14650460698565593, 0.01274934542960724]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 2), (2, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 32768, 32768]
stage_compute_performance: [0.15289227255801086, 0.15289227255801086, 0.15289227255801086, 0.15289227255801086, 0.1850236286169561, 0.20340728115100057]
layer_partition: [0, 2, 3, 5, 6, 7, 10]
stage_memory_demand: [64582.501, 24192.501, 48385.001, 24192.501, 13037.501, 102120.001], memory_state: [17337.499000000003, 57727.498999999996, 33534.999, 57727.498999999996, 19730.499, -69352.001]
adj_stage_compute_performance(2): [0.19272240448118566, 0.1850776956583149, 0.17890025722006653, 0.1739084718502716, 0.20557511860648914, 0.058741918832143254]
layer_partition: [0, 3, 5, 6, 7, 9, 10]
stage_memory_demand: [88775.001, 48385.001, 24192.501, 24192.501, 26075.001, 60660.001], memory_state: [-6855.001000000004, 33534.999, 57727.498999999996, 57727.498999999996, 6692.999, -27892.000999999997]
adj_stage_compute_performance(3): [0.16005674207301734, 0.20566903460756036, 0.19384938337717347, 0.18494361994199965, 0.21556829758457804, 0.02855868196676263]
layer_partition: [0, 2, 4, 6, 7, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 24192.501, 26075.001, 60660.001], memory_state: [17337.499000000003, 33534.999, 33534.999, 57727.498999999996, 6692.999, -27892.000999999997]
adj_stage_compute_performance(4): [0.1625030954513544, 0.20828848367817518, 0.19578940654202995, 0.18642080441556458, 0.21695841579894592, 0.01388443435103455]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 2), (1, 2)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 32768, 32768]
stage_compute_performance: [0.15575562993903122, 0.15575562993903122, 0.15575562993903122, 0.15575562993903122, 0.18848874012193761, 0.18848874012193761]
layer_partition: [0, 2, 3, 5, 6, 8, 10]
stage_memory_demand: [64582.501, 24192.501, 48385.001, 24192.501, 26075.001, 57202.501], memory_state: [17337.499000000003, 57727.498999999996, 33534.999, 57727.498999999996, 6692.999, -24434.500999999997]
adj_stage_compute_performance(2): [0.179018254010653, 0.17455339339139953, 0.17094548598120726, 0.16803005434950344, 0.20049175298316385, 0.09717685477920077]
layer_partition: [0, 3, 4, 5, 6, 8, 10]
stage_memory_demand: [88775.001, 24192.501, 24192.501, 24192.501, 26075.001, 57202.501], memory_state: [-6855.001000000004, 57727.498999999996, 57727.498999999996, 57727.498999999996, 6692.999, -24434.500999999997]
adj_stage_compute_performance(3): [0.14867538927650842, 0.19946112242972946, 0.18937516616353567, 0.1818083756011931, 0.2130630546706094, 0.05010029298656654]
layer_partition: [0, 2, 4, 6, 7, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 24192.501, 26075.001, 44165.001], memory_state: [17337.499000000003, 33534.999, 33534.999, 57727.498999999996, 6692.999, -11397.000999999997]
adj_stage_compute_performance(4): [0.15132968515983597, 0.2024542707301063, 0.19160902824449041, 0.18351739217670995, 0.2146753332381824, 0.033454493990058586]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[1, 1, 1, 1, 2, 2], num_stage=6, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (2, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 32768, 32768]
stage_compute_performance: [0.1256420652466229, 0.1256420652466229, 0.1256420652466229, 0.1256420652466229, 0.24871586950675423, 0.24871586950675423]
layer_partition: [0, 2, 3, 4, 5, 7, 10]
stage_memory_demand: [76685.001, 31295.001, 31295.001, 31295.001, 48385.001, 121155.001], memory_state: [5234.998999999996, 50624.998999999996, 50624.998999999996, 50624.998999999996, -15617.000999999997, -88387.001]
adj_stage_compute_performance(2): [0.13421918042360526, 0.24868114139773093, 0.21343307055820165, 0.18849311802913876, 0.15159510797153009, 0.06054169774467329]
layer_partition: [0, 2, 4, 6, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 24192.501, 72770.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 19329.999000000003, 8575.499, -40002.001000000004]
adj_stage_compute_performance(3): [0.14105819735435815, 0.25953625804072983, 0.22027543983616626, 0.1931586404620154, 0.1545920519265555, 0.024535485667063667]
layer_partition: [0, 2, 4, 6, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 24192.501, 72770.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 19329.999000000003, 8575.499, -40002.001000000004]
adj_stage_compute_performance(4): [0.14318321300335693, 0.2628767381616751, 0.2223509321156602, 0.19456474443906788, 0.15549299479952342, 0.009943395698242577]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 2), (2, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 32768, 32768]
stage_compute_performance: [0.13881995421865564, 0.13881995421865564, 0.13881995421865564, 0.13881995421865564, 0.16991790611243415, 0.2748022770129432]
layer_partition: [0, 2, 3, 4, 5, 7, 10]
stage_memory_demand: [76685.001, 31295.001, 31295.001, 31295.001, 40420.001, 121155.001], memory_state: [5234.998999999996, 50624.998999999996, 50624.998999999996, 50624.998999999996, -7652.000999999997, -88387.001]
adj_stage_compute_performance(2): [0.14829667472511698, 0.24446190344059676, 0.2143390986423726, 0.19298443420795075, 0.1239753297567464, 0.0668915756258721]
layer_partition: [0, 2, 4, 6, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 20210.001, 72770.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 19329.999000000003, 12557.999, -40002.001000000004]
adj_stage_compute_performance(3): [0.15675508984324116, 0.2561676095031091, 0.22188722871486294, 0.19820415553578621, 0.12662823714238444, 0.027108874645992095]
layer_partition: [0, 2, 4, 6, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 20210.001, 72770.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 19329.999000000003, 12557.999, -40002.001000000004]
adj_stage_compute_performance(4): [0.15938867028308384, 0.25976837062537617, 0.22417357231766755, 0.19977424634656848, 0.12742415422446318, 0.010986302500667577]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 2), (1, 2)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 32768, 32768]
stage_compute_performance: [0.15508605782954774, 0.15508605782954774, 0.15508605782954774, 0.15508605782954774, 0.18982788434090453, 0.18982788434090453]
layer_partition: [0, 2, 3, 5, 6, 8, 10]
stage_memory_demand: [76685.001, 31295.001, 62590.001, 31295.001, 40420.001, 79860.001], memory_state: [5234.998999999996, 50624.998999999996, 19329.999000000003, 50624.998999999996, -7652.000999999997, -47092.001000000004]
adj_stage_compute_performance(2): [0.1656732045605183, 0.2244540718118624, 0.20298210024627658, 0.19121636744442463, 0.13850202781228246, 0.0701008268541655]
layer_partition: [0, 2, 4, 6, 7, 8, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 20210.001, 79860.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 50624.998999999996, 12557.999, -47092.001000000004]
adj_stage_compute_performance(3): [0.176201199283479, 0.23615673658728048, 0.21099117299331174, 0.19710166332886273, 0.14188158018583008, 0.02588727121255064]
layer_partition: [0, 2, 4, 6, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 20210.001, 59650.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 19329.999000000003, 12557.999, -26882.000999999997]
adj_stage_compute_performance(4): [0.17859767848175181, 0.23878056277815668, 0.21276012310859782, 0.19839185339698726, 0.14262009075339124, 0.012798770829585963]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[1, 1, 1, 1, 2, 2], num_stage=6, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[1, 1, 1, 1, 2, 2], num_stage=6, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[1, 1, 1, 1, 2, 2], num_stage=6, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[1, 1, 1, 1, 2, 2], num_stage=6, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[1, 1, 1, 1, 2, 2], num_stage=6, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[2, 1, 1, 1, 1, 2], num_stage=6, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [163840, 81920, 81920, 16384, 16384, 32768]
stage_compute_performance: [0.29089409087318746, 0.1673614202200749, 0.1673614202200749, 0.11164333239984783, 0.11164333239984783, 0.1510964038869668]
layer_partition: [0, 3, 4, 6, 7, 8, 10]
stage_memory_demand: [43085.001, 20730.001, 41460.001, 20730.001, 20730.001, 41757.501], memory_state: [120754.99900000001, 61189.998999999996, 40459.999, -4346.001, -4346.001, -8989.500999999997]
adj_stage_compute_performance(2): [0.3560313380854646, 0.18741198954589824, 0.18204817729812808, 0.0794137888481142, 0.0794137888481142, 0.10671170830628289]
layer_partition: [0, 4, 5, 7, 8, 8, 10]
stage_memory_demand: [53682.501, 20730.001, 41460.001, 20730.001, 0.001, 41757.501], memory_state: [110157.49900000001, 61189.998999999996, 40459.999, -4346.001, 16383.999, -8989.500999999997]
adj_stage_compute_performance(3): [0.38720072336223366, 0.19656190341287083, 0.18886674942399828, 0.05648836991559975, 0.08171547798313773, 0.0753650543408297]
layer_partition: [0, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [53682.501, 41460.001, 20730.001, 20730.001, 20730.001, 31160.001], memory_state: [110157.49900000001, 40459.999, 61189.998999999996, -4346.001, -4346.001, 1607.9989999999998]
adj_stage_compute_performance(4): [0.41080359242498254, 0.20307281091841067, 0.1936726427024237, 0.04018113204275618, 0.05812560029052366, 0.07685566830127369]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[2, 1, 1, 1, 1, 2], num_stage=6, batches=64, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [163840, 81920, 81920, 16384, 16384, 32768]
stage_compute_performance: [0.27227330592019056, 0.1365216549233389, 0.1365216549233389, 0.13652775436292594, 0.13652775436292594, 0.18162787550727974]
layer_partition: [0, 3, 4, 5, 7, 8, 10]
stage_memory_demand: [80560.001, 24192.501, 24192.501, 48385.001, 24192.501, 81390.001], memory_state: [83279.999, 57727.498999999996, 57727.498999999996, -32001.000999999997, -7808.501, -48622.001000000004]
adj_stage_compute_performance(2): [0.45164649453675965, 0.18155527059043386, 0.17028096945914062, 0.04160759766717709, 0.083215193614499, 0.06581181885180573]
layer_partition: [0, 5, 6, 8, 8, 9, 10]
stage_memory_demand: [122020.001, 24192.501, 48385.001, 0.001, 24192.501, 60660.001], memory_state: [41819.998999999996, 57727.498999999996, 33534.999, 16383.999, -7808.501, -27892.000999999997]
adj_stage_compute_performance(3): [0.49692012283490566, 0.19002823012639905, 0.17652051743180544, 0.04282500978856077, 0.050720591432938514, 0.031995870097700344]
layer_partition: [0, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [122020.001, 48385.001, 24192.501, 0.001, 0.001, 20730.001], memory_state: [41819.998999999996, 33534.999, 57727.498999999996, 16383.999, 16383.999, 12037.999]
layer_partition: [0, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [2, 1, 1, 1, 1, 2], num_stage: 6, batches: 64, gbs: 128, strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)], layer_partition: [0, 5, 7, 8, 8, 8, 9]
execution_cost: 7793.407599925995, fb_sync_cost: 10367.741088867188, parameter_upate_costs: 20.301532745361328, dp_cost: 24.93546195652174, pp_cost: 0.7547826086956522
cost: 18272.78530252954
valid_strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [163840, 81920, 81920, 16384, 16384, 32768]
stage_compute_performance: [0.2768173349187594, 0.13880009480494118, 0.13880009480494118, 0.13880629603941502, 0.13880629603941502, 0.16796988339252825]
layer_partition: [0, 3, 4, 5, 7, 8, 10]
stage_memory_demand: [80560.001, 24192.501, 24192.501, 48385.001, 24192.501, 57202.501], memory_state: [83279.999, 57727.498999999996, 57727.498999999996, -32001.000999999997, -7808.501, -24434.500999999997]
adj_stage_compute_performance(2): [0.43447238749160755, 0.17838113308774659, 0.1684719011045004, 0.04230199600241402, 0.08460399025626983, 0.08659819655622626]
layer_partition: [0, 5, 6, 7, 7, 8, 9]
stage_memory_demand: [122020.001, 24192.501, 24192.501, 0.001, 24192.501, 13037.501], memory_state: [41819.998999999996, 57727.498999999996, 57727.498999999996, 16383.999, -7808.501, 19730.499]
adj_stage_compute_performance(3): [0.4502416931359695, 0.18176514589923337, 0.17104158857219293, 0.042827800584120876, 0.05156707852250796, 0.0876245685853553]
layer_partition: [0, 5, 7, 8, 8, 8, 10]
stage_memory_demand: [122020.001, 48385.001, 24192.501, 0.001, 0.001, 57202.501], memory_state: [41819.998999999996, 33534.999, 57727.498999999996, 16383.999, 16383.999, -24434.500999999997]
adj_stage_compute_performance(4): [0.47768629214521074, 0.18728615075629731, 0.17518463674622828, 0.04366748070862913, 0.05252985256952861, 0.04517553659173802]
layer_partition: None
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [163840, 81920, 81920, 16384, 16384, 32768]
stage_compute_performance: [0.25838216271132514, 0.14233834837999035, 0.14233834837999035, 0.14234470769461594, 0.14234470769461594, 0.17225172513946235]
layer_partition: [0, 3, 4, 5, 6, 7, 10]
stage_memory_demand: [47470.001, 24192.501, 24192.501, 24192.501, 24192.501, 70240.001], memory_state: [116369.99900000001, 57727.498999999996, 57727.498999999996, -7808.501, -7808.501, -37472.001000000004]
adj_stage_compute_performance(2): [0.39567060561782846, 0.18198425805744997, 0.17159287376255836, 0.08676069174417844, 0.08676069174417844, 0.07232218115191816]
layer_partition: [0, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [60507.501, 48385.001, 24192.501, 24192.501, 24192.501, 44165.001], memory_state: [103332.49900000001, 33534.999, 57727.498999999996, -7808.501, -7808.501, -11397.000999999997]
adj_stage_compute_performance(3): [0.4574946944601383, 0.19540314480576004, 0.18117233969185814, 0.05288161220631788, 0.05288161220631788, 0.04829317016855607]
layer_partition: [0, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [73545.001, 48385.001, 24192.501, 0.001, 0.001, 13037.501], memory_state: [90294.999, 33534.999, 57727.498999999996, 16383.999, 16383.999, 19730.499]
layer_partition: [0, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [2, 1, 1, 1, 1, 2], num_stage: 6, batches: 64, gbs: 128, strategies: [(1, 2), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 5, 7, 8, 8, 8, 9]
execution_cost: 8588.88758216858, fb_sync_cost: 5207.039999999997, parameter_upate_costs: 10.150766372680664, dp_cost: 0.0, pp_cost: 0.8417391304347827
cost: 13872.564924097474


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[2, 1, 1, 1, 1, 2], num_stage=6, batches=32, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [163840, 81920, 81920, 16384, 16384, 32768]
stage_compute_performance: [0.27144459020467265, 0.13712990127710664, 0.13712990127710664, 0.09141944479199314, 0.09141944479199314, 0.2714567176571278]
layer_partition: [0, 3, 4, 5, 6, 7, 10]
stage_memory_demand: [88775.001, 31295.001, 31295.001, 31295.001, 31295.001, 121155.001], memory_state: [75064.999, 50624.998999999996, 50624.998999999996, -14911.001, -14911.001, -88387.001]
adj_stage_compute_performance(2): [0.4759567636571239, 0.1890547029106354, 0.17600653431180713, 0.04307507659529438, 0.04307507659529438, 0.0660772092418198]
layer_partition: [0, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [137160.001, 62590.001, 31295.001, 0.001, 0.001, 24192.501], memory_state: [26679.99900000001, 19329.999000000003, 50624.998999999996, 16383.999, 16383.999, 8575.499]
layer_partition: [0, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [2, 1, 1, 1, 1, 2], num_stage: 6, batches: 32, gbs: 128, strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)], layer_partition: [0, 5, 7, 8, 8, 8, 9]
execution_cost: 7963.175948486328, fb_sync_cost: 3458.8799999999974, parameter_upate_costs: 20.301532745361328, dp_cost: 24.93546195652174, pp_cost: 1.5095652173913043
cost: 11501.624926618491
valid_strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [163840, 81920, 81920, 16384, 16384, 32768]
stage_compute_performance: [0.30281888719757827, 0.15297974468725434, 0.15297974468725434, 0.10198595050009311, 0.10198595050009311, 0.18724972242772692]
layer_partition: [0, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [88775.001, 62590.001, 31295.001, 31295.001, 31295.001, 79860.001], memory_state: [75064.999, 19329.999000000003, 50624.998999999996, -14911.001, -14911.001, -47092.001000000004]
adj_stage_compute_performance(2): [0.4558063212981674, 0.1918226264286807, 0.18206180974990863, 0.04805380999010587, 0.04805380999010587, 0.06914874711885591]
layer_partition: [0, 5, 6, 8, 8, 8, 9]
stage_memory_demand: [137160.001, 31295.001, 62590.001, 0.001, 0.001, 20210.001], memory_state: [26679.99900000001, 50624.998999999996, 19329.999000000003, 16383.999, 16383.999, 12557.999]
layer_partition: [0, 5, 6, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [2, 1, 1, 1, 1, 2], num_stage: 6, batches: 32, gbs: 128, strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 5, 6, 8, 8, 8, 9]
execution_cost: 7999.195948486328, fb_sync_cost: 1107.0720000000038, parameter_upate_costs: 20.301532745361328, dp_cost: 24.93546195652174, pp_cost: 1.5095652173913043
cost: 9185.836926618498
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [163840, 81920, 81920, 16384, 16384, 32768]
stage_compute_performance: [0.2871328058206018, 0.1564216806205839, 0.1564216806205839, 0.10428056217197602, 0.10428056217197602, 0.1914627085942784]
layer_partition: [0, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [61290.001, 62590.001, 31295.001, 31295.001, 31295.001, 79860.001], memory_state: [102549.99900000001, 19329.999000000003, 50624.998999999996, -14911.001, -14911.001, -47092.001000000004]
adj_stage_compute_performance(2): [0.438198978353353, 0.19933324060863333, 0.18814563233370224, 0.04913498668886733, 0.04913498668886733, 0.07070454496607861]
layer_partition: [0, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [81500.001, 62590.001, 62590.001, 0.001, 0.001, 20210.001], memory_state: [82339.999, 19329.999000000003, 19329.999000000003, 16383.999, 16383.999, 12557.999]
layer_partition: [0, 4, 6, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [2, 1, 1, 1, 1, 2], num_stage: 6, batches: 32, gbs: 128, strategies: [(1, 2), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 4, 6, 8, 8, 8, 9]
execution_cost: 7980.479136352539, fb_sync_cost: 1107.0720000000038, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 1.6834782608695653
cost: 9130.177645924448


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[2, 1, 1, 1, 1, 2], num_stage=6, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[2, 1, 1, 1, 1, 2], num_stage=6, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[2, 1, 1, 1, 1, 2], num_stage=6, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[2, 1, 1, 1, 1, 2], num_stage=6, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[2, 1, 1, 1, 1, 2], num_stage=6, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 1, 1, 1, 1, 1, 1], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.2713082756651385, 0.1560930240847406, 0.1560930240847406, 0.104126419041345, 0.104126419041345, 0.104126419041345, 0.104126419041345]
layer_partition: [0, 3, 4, 6, 7, 7, 8, 10]
stage_memory_demand: [43085.001, 20730.001, 41460.001, 20730.001, 0.001, 20730.001, 81390.001], memory_state: [120754.99900000001, 61189.998999999996, 40459.999, -4346.001, 16383.999, -4346.001, -65006.001000000004]
adj_stage_compute_performance(2): [0.3516843494741491, 0.1840904232405812, 0.17773488678241034, 0.07406688135789558, 0.11528602921939618, 0.07406688135789558, 0.018864805329294156]
layer_partition: [0, 4, 5, 6, 7, 8, 9, 10]
stage_memory_demand: [53682.501, 20730.001, 20730.001, 20730.001, 20730.001, 20730.001, 60660.001], memory_state: [110157.49900000001, 61189.998999999996, 61189.998999999996, -4346.001, -4346.001, -4346.001, -44276.001]
adj_stage_compute_performance(3): [0.4087831500183162, 0.199247108263364, 0.18859278012738043, 0.052685024267533076, 0.08200490064894489, 0.052685024267533076, 0.004585771000294575]
layer_partition: [0, 4, 6, 7, 7, 8, 8, 9]
stage_memory_demand: [53682.501, 41460.001, 20730.001, 0.001, 20730.001, 0.001, 20730.001], memory_state: [110157.49900000001, 40459.999, 61189.998999999996, 16383.999, -4346.001, 16383.999, -4346.001]
adj_stage_compute_performance(4): [0.42011190669626697, 0.20226643351401583, 0.1908193590558228, 0.05317698484117417, 0.05833147152328077, 0.05314824963783823, 0.0032619364013510505]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 1, 1, 1, 1, 1, 1], num_stage=7, batches=64, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.24946528531375786, 0.12508539344999223, 0.12508539344999223, 0.12509098194656443, 0.12509098194656443, 0.12509098194656443, 0.12509098194656443]
layer_partition: [0, 3, 4, 5, 6, 7, 8, 10]
stage_memory_demand: [80560.001, 24192.501, 24192.501, 24192.501, 24192.501, 24192.501, 96962.501], memory_state: [83279.999, 57727.498999999996, 57727.498999999996, -7808.501, -7808.501, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.4210662891353534, 0.16816771647602996, 0.15738192732639025, 0.07624435288403049, 0.07624435288403049, 0.07624435288403049, 0.019023246764140918]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [101290.001, 48385.001, 24192.501, 24192.501, 0.001, 24192.501, 72770.001], memory_state: [62549.998999999996, 33534.999, 57727.498999999996, -7808.501, 16383.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.47019718122795157, 0.17774901000667226, 0.16451616686912407, 0.046471786025213346, 0.07903952364746789, 0.046471786025213346, 0.0038547366171578904]
layer_partition: [0, 5, 7, 8, 8, 9, 9, 10]
stage_memory_demand: [122020.001, 48385.001, 24192.501, 0.001, 24192.501, 0.001, 72770.001], memory_state: [41819.998999999996, 33534.999, 57727.498999999996, 16383.999, -7808.501, 16383.999, -56386.001000000004]
adj_stage_compute_performance(4): [0.48782176874149613, 0.1809515931504519, 0.16689840479430637, 0.04702243669976923, 0.048175473874987225, 0.04699417344295773, 0.0007810966535779406]
layer_partition: None
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.23226663837083047, 0.1279517492328329, 0.1279517492328329, 0.12795746579087594, 0.12795746579087594, 0.12795746579087594, 0.12795746579087594]
layer_partition: [0, 3, 4, 5, 6, 7, 8, 10]
stage_memory_demand: [47470.001, 24192.501, 24192.501, 24192.501, 24192.501, 24192.501, 96962.501], memory_state: [116369.99900000001, 57727.498999999996, 57727.498999999996, -7808.501, -7808.501, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.40031597905673116, 0.1764807356583484, 0.16376105406971236, 0.0779915068543736, 0.0779915068543736, 0.0779915068543736, 0.019459168112484437]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [60507.501, 48385.001, 24192.501, 24192.501, 0.001, 24192.501, 72770.001], memory_state: [103332.49900000001, 33534.999, 57727.498999999996, -7808.501, 16383.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.4485336133333308, 0.1873418417226946, 0.1716664556612113, 0.047536695915476095, 0.08100324114160308, 0.047536695915476095, 0.003943068646095669]
layer_partition: [0, 5, 7, 8, 8, 9, 9, 10]
stage_memory_demand: [73545.001, 48385.001, 24192.501, 0.001, 24192.501, 0.001, 72770.001], memory_state: [90294.999, 33534.999, 57727.498999999996, 16383.999, -7808.501, 16383.999, -56386.001000000004]
adj_stage_compute_performance(4): [0.47082089004854005, 0.19202488415709867, 0.1750669978523498, 0.04829925941319039, 0.04937238165568836, 0.04825909861710733, 0.0007989956332124868]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 1, 1, 1, 1, 1, 1], num_stage=7, batches=32, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.2978383806112646, 0.15046366442212106, 0.15046366442212106, 0.10030857263612337, 0.10030857263612337, 0.10030857263612337, 0.10030857263612337]
layer_partition: [0, 3, 5, 6, 7, 8, 9, 10]
stage_memory_demand: [88775.001, 62590.001, 31295.001, 31295.001, 31295.001, 31295.001, 130420.001], memory_state: [75064.999, 19329.999000000003, 50624.998999999996, -14911.001, -14911.001, -14911.001, -114036.001]
adj_stage_compute_performance(2): [0.46581379253650884, 0.19311193223076795, 0.18239486117207226, 0.047263461939599266, 0.047263461939599266, 0.047263461939599266, 0.01134112925411817]
layer_partition: [0, 5, 7, 8, 8, 8, 8, 9]
stage_memory_demand: [137160.001, 62590.001, 31295.001, 0.001, 0.001, 0.001, 31295.001], memory_state: [26679.99900000001, 19329.999000000003, 50624.998999999996, 16383.999, 16383.999, 16383.999, -14911.001]
adj_stage_compute_performance(3): [0.46581379253650884, 0.19311193223076795, 0.18239486117207226, 0.047263461939599266, 0.047263461939599266, 0.047263461939599266, 0.005343721047637126]
layer_partition: [0, 5, 7, 8, 8, 8, 8, 9]
stage_memory_demand: [137160.001, 62590.001, 31295.001, 0.001, 0.001, 0.001, 31295.001], memory_state: [26679.99900000001, 19329.999000000003, 50624.998999999996, 16383.999, 16383.999, 16383.999, -14911.001]
adj_stage_compute_performance(4): [0.46581379253650884, 0.19311193223076795, 0.18239486117207226, 0.047263461939599266, 0.047263461939599266, 0.047263461939599266, 0.0025178581422648947]
layer_partition: None
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [163840, 81920, 81920, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.28230582348215005, 0.1537920797028182, 0.1537920797028182, 0.10252750427805343, 0.10252750427805343, 0.10252750427805343, 0.10252750427805343]
layer_partition: [0, 3, 5, 6, 7, 7, 8, 10]
stage_memory_demand: [61290.001, 62590.001, 31295.001, 31295.001, 0.001, 31295.001, 161715.001], memory_state: [102549.99900000001, 19329.999000000003, 50624.998999999996, -14911.001, 16383.999, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.3972688670437199, 0.19088631984060433, 0.18264735932685935, 0.04830897967002669, 0.1174916011627585, 0.04830897967002669, 0.009348728056975153]
layer_partition: [0, 4, 6, 7, 7, 8, 8, 9]
stage_memory_demand: [81500.001, 62590.001, 31295.001, 0.001, 31295.001, 0.001, 31295.001], memory_state: [82339.999, 19329.999000000003, 50624.998999999996, 16383.999, -14911.001, 16383.999, -14911.001]
adj_stage_compute_performance(3): [0.4371305445802168, 0.20126767656046723, 0.1903947020594383, 0.04992662859186315, 0.05535977308662083, 0.049836537374998754, 0.004404940087298058]
layer_partition: [0, 4, 6, 8, 8, 9, 9, 10]
stage_memory_demand: [81500.001, 62590.001, 62590.001, 0.001, 31295.001, 0.001, 130420.001], memory_state: [82339.999, 19329.999000000003, 19329.999000000003, 16383.999, -14911.001, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.4527515328187903, 0.20507413392649754, 0.193215034625983, 0.05051455217943279, 0.02608445578979455, 0.05039184562166439, 0.000498033154832304]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 1, 1, 1, 1, 1, 1], num_stage=7, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 1, 1, 1, 1, 1, 1], num_stage=7, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 1, 1, 1, 1, 1, 1], num_stage=7, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 1, 1, 1, 1, 1, 1], num_stage=7, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[2, 1, 1, 1, 1, 1, 1], num_stage=7, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 2, 1, 1, 1, 1], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 163840, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.1560930240847406, 0.1560930240847406, 0.2713082756651385, 0.104126419041345, 0.104126419041345, 0.104126419041345, 0.104126419041345]
layer_partition: [0, 2, 3, 6, 7, 7, 8, 10]
stage_memory_demand: [59830.001, 20730.001, 31792.501, 20730.001, 0.001, 20730.001, 81390.001], memory_state: [22089.999000000003, 61189.998999999996, 132047.499, -4346.001, 16383.999, -4346.001, -65006.001000000004]
adj_stage_compute_performance(2): [0.2023361561607847, 0.19183875566249603, 0.31933474767385994, 0.07406688135789558, 0.11528602921939618, 0.07406688135789558, 0.018864805329294156]
layer_partition: [0, 3, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [80560.001, 20730.001, 21195.001, 20730.001, 20730.001, 20730.001, 60660.001], memory_state: [1359.9989999999962, 61189.998999999996, 142644.999, -4346.001, -4346.001, -4346.001, -44276.001]
adj_stage_compute_performance(3): [0.20575195763331086, 0.22837930476236928, 0.3614724250889445, 0.052685024267533076, 0.08200490064894489, 0.052685024267533076, 0.004585771000294575]
layer_partition: [0, 2, 4, 7, 7, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 31792.501, 0.001, 20730.001, 0.001, 20730.001], memory_state: [22089.999000000003, 40459.999, 132047.499, 16383.999, -4346.001, 16383.999, -4346.001]
adj_stage_compute_performance(4): [0.21146048801682224, 0.2332686232120361, 0.3672494985069349, 0.05318922128417193, 0.05833147152328077, 0.05315973803622001, 0.0032619364013510505]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 2, 1, 1, 1, 1], num_stage=7, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 163840, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.12508539344999223, 0.12508539344999223, 0.24946528531375786, 0.12509098194656443, 0.12509098194656443, 0.12509098194656443, 0.12509098194656443]
layer_partition: [0, 2, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [64582.501, 24192.501, 41460.001, 24192.501, 24192.501, 24192.501, 96962.501], memory_state: [17337.499000000003, 57727.498999999996, 122379.99900000001, -7808.501, -7808.501, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.15866519990335098, 0.2134825514158089, 0.37602842073461196, 0.07624435288403049, 0.07624435288403049, 0.07624435288403049, 0.019023246764140918]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 62190.001, 24192.501, 0.001, 24192.501, 72770.001], memory_state: [17337.499000000003, 33534.999, 101649.99900000001, -7808.501, 16383.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.17729161959283055, 0.23372094040206187, 0.4024453631514461, 0.046471786025213346, 0.07915760937290257, 0.046471786025213346, 0.0038547366171578904]
layer_partition: [0, 2, 4, 8, 8, 9, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 82920.001, 0.001, 24192.501, 0.001, 72770.001], memory_state: [17337.499000000003, 33534.999, 80919.999, 16383.999, -7808.501, 16383.999, -56386.001000000004]
adj_stage_compute_performance(4): [0.18592472997832374, 0.24287574499980788, 0.4141443066193323, 0.047222891969354044, 0.048247448445659764, 0.04718438228583814, 0.0007810966535779406]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 163840, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.1279517492328329, 0.1279517492328329, 0.23226663837083047, 0.12795746579087594, 0.12795746579087594, 0.12795746579087594, 0.12795746579087594]
layer_partition: [0, 2, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [64582.501, 24192.501, 26075.001, 24192.501, 24192.501, 24192.501, 96962.501], memory_state: [17337.499000000003, 57727.498999999996, 137764.999, -7808.501, -7808.501, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.1623010433918264, 0.2245095898010508, 0.3552095549696377, 0.0779915068543736, 0.0779915068543736, 0.0779915068543736, 0.019459168112484437]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 39112.501, 24192.501, 0.001, 24192.501, 72770.001], memory_state: [17337.499000000003, 33534.999, 124727.49900000001, -7808.501, 16383.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.1819468368547234, 0.24630665320714948, 0.3802539753816724, 0.047536695915476095, 0.08110839867936519, 0.047536695915476095, 0.003943068646095669]
layer_partition: [0, 2, 4, 8, 8, 9, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 52150.001, 0.001, 24192.501, 0.001, 72770.001], memory_state: [17337.499000000003, 33534.999, 111689.99900000001, 16383.999, -7808.501, 16383.999, -56386.001000000004]
adj_stage_compute_performance(4): [0.19107459772303517, 0.2561750332129139, 0.3913361005483005, 0.04833908368902109, 0.049436476351347354, 0.04829687068363233, 0.0007989956332124868]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 2, 1, 1, 1, 1], num_stage=7, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 163840, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.15046366442212106, 0.15046366442212106, 0.2978383806112646, 0.10030857263612337, 0.10030857263612337, 0.10030857263612337, 0.10030857263612337]
layer_partition: [0, 2, 3, 6, 7, 8, 9, 10]
stage_memory_demand: [76685.001, 31295.001, 72577.501, 31295.001, 31295.001, 31295.001, 130420.001], memory_state: [5234.998999999996, 50624.998999999996, 91262.499, -14911.001, -14911.001, -14911.001, -114036.001]
adj_stage_compute_performance(2): [0.16073525759568233, 0.24696221577948038, 0.4347213291307963, 0.047263461939599266, 0.047263461939599266, 0.047263461939599266, 0.01134112925411817]
layer_partition: [0, 2, 4, 8, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 96770.001, 0.001, 0.001, 0.001, 31295.001], memory_state: [5234.998999999996, 19329.999000000003, 67069.999, 16383.999, 16383.999, 16383.999, -14911.001]
adj_stage_compute_performance(3): [0.16073525759568233, 0.24696221577948038, 0.4347213291307963, 0.047263461939599266, 0.047263461939599266, 0.047263461939599266, 0.005343721047637126]
layer_partition: [0, 2, 4, 8, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 96770.001, 0.001, 0.001, 0.001, 31295.001], memory_state: [5234.998999999996, 19329.999000000003, 67069.999, 16383.999, 16383.999, 16383.999, -14911.001]
adj_stage_compute_performance(4): [0.16073525759568233, 0.24696221577948038, 0.4347213291307963, 0.047263461939599266, 0.047263461939599266, 0.047263461939599266, 0.0025178581422648947]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 163840, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.1537920797028182, 0.1537920797028182, 0.28230582348215005, 0.10252750427805343, 0.10252750427805343, 0.10252750427805343, 0.10252750427805343]
layer_partition: [0, 2, 3, 6, 7, 7, 8, 10]
stage_memory_demand: [76685.001, 31295.001, 60630.001, 31295.001, 0.001, 31295.001, 161715.001], memory_state: [5234.998999999996, 50624.998999999996, 103209.99900000001, -14911.001, 16383.999, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.1642908913733321, 0.22355633524831178, 0.37874392549804814, 0.04830897967002669, 0.12175741322473578, 0.04830897967002669, 0.009348728056975153]
layer_partition: [0, 2, 4, 7, 7, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 60630.001, 0.001, 31295.001, 0.001, 31295.001], memory_state: [5234.998999999996, 19329.999000000003, 103209.99900000001, 16383.999, -14911.001, 16383.999, -14911.001]
adj_stage_compute_performance(3): [0.17550641775832232, 0.2454971766015489, 0.4055781665729153, 0.05012549944057288, 0.05736974133493921, 0.05001773653629937, 0.004404940087298058]
layer_partition: [0, 2, 4, 7, 8, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 60630.001, 31295.001, 31295.001, 0.001, 130420.001], memory_state: [5234.998999999996, 19329.999000000003, 103209.99900000001, -14911.001, -14911.001, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.1874875862981571, 0.2653854479405728, 0.42851168531953043, 0.02361816714915304, 0.027031514005335218, 0.05144191448467898, 0.000498033154832304]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 2, 1, 1, 1, 1], num_stage=7, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 2, 1, 1, 1, 1], num_stage=7, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 2, 1, 1, 1, 1], num_stage=7, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 2, 1, 1, 1, 1], num_stage=7, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[1, 1, 2, 1, 1, 1, 1], num_stage=7, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 2, 1, 1], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 32768, 16384, 16384]
stage_compute_performance: [0.16033417386664783, 0.16033417386664783, 0.16033417386664783, 0.16033417386664783, 0.1447521003322144, 0.10695560210059711, 0.10695560210059711]
layer_partition: [0, 2, 4, 5, 6, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 20730.001, 20730.001, 21195.001, 20730.001, 60660.001], memory_state: [22089.999000000003, 40459.999, 61189.998999999996, 61189.998999999996, 11572.999, -4346.001, -44276.001]
adj_stage_compute_performance(2): [0.19306453245255456, 0.18638870265790927, 0.18107450485791815, 0.1768442145230623, 0.1566174182219328, 0.07607932707454114, 0.025999414776378998]
layer_partition: [0, 3, 5, 6, 7, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 20730.001, 20730.001, 10597.501, 20730.001, 60660.001], memory_state: [1359.9989999999962, 40459.999, 61189.998999999996, 61189.998999999996, 22170.499, -4346.001, -44276.001]
adj_stage_compute_performance(3): [0.19632381209271918, 0.19865379115042608, 0.19026783609929213, 0.18383856078564198, 0.16148018973025827, 0.05411651091142513, 0.006320095024834802]
layer_partition: [0, 3, 5, 6, 7, 9, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 20730.001, 20730.001, 21195.001, 0.001, 60660.001], memory_state: [1359.9989999999962, 40459.999, 61189.998999999996, 61189.998999999996, 11572.999, 16383.999, -44276.001]
adj_stage_compute_performance(4): [0.19632381209271918, 0.19865379115042608, 0.19026783609929213, 0.18383856078564198, 0.16148018973025827, 0.05411651091142513, 0.0015363269314519804]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 2, 1, 1], num_stage=7, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 32768, 16384, 16384]
stage_compute_performance: [0.1364166135952325, 0.1364166135952325, 0.1364166135952325, 0.1364166135952325, 0.18148812893538868, 0.13642270834184073, 0.13642270834184073]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 10]
stage_memory_demand: [64582.501, 24192.501, 24192.501, 24192.501, 41460.001, 24192.501, 96962.501], memory_state: [17337.499000000003, 57727.498999999996, 57727.498999999996, 57727.498999999996, -8692.000999999997, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.1730383434008145, 0.21626890373460012, 0.1934997768273909, 0.17735828310443974, 0.1290955759518514, 0.08315116688950211, 0.02074652228829624]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 24192.501, 20730.001, 24192.501, 72770.001], memory_state: [17337.499000000003, 33534.999, 33534.999, 57727.498999999996, 12037.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.1856880265166272, 0.22900247348746167, 0.2021219603139934, 0.18354156756974138, 0.13269862770684615, 0.05068156642778861, 0.004203929020892841]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 48385.001, 20730.001, 0.001, 72770.001], memory_state: [17337.499000000003, 33534.999, 33534.999, 33534.999, 12037.999, 16383.999, -56386.001000000004]
adj_stage_compute_performance(4): [0.1856880265166272, 0.22900247348746167, 0.2021219603139934, 0.18354156756974138, 0.13269862770684615, 0.05068156642778861, 0.0008518545405884696]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 32768, 16384, 16384]
stage_compute_performance: [0.13869151949828298, 0.13869151949828298, 0.13869151949828298, 0.13869151949828298, 0.16783849024309047, 0.13869771588188887, 0.13869771588188887]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 10]
stage_memory_demand: [64582.501, 24192.501, 24192.501, 24192.501, 26075.001, 24192.501, 96962.501], memory_state: [17337.499000000003, 57727.498999999996, 57727.498999999996, 57727.498999999996, 6692.999, -7808.501, -80578.501]
adj_stage_compute_performance(2): [0.1759239592981904, 0.18030379565221344, 0.17208911732888652, 0.16550524040552195, 0.19389895491811704, 0.08453780943557594, 0.021092494708938876]
layer_partition: [0, 2, 4, 5, 6, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 24192.501, 24192.501, 26075.001, 24192.501, 72770.001], memory_state: [17337.499000000003, 33534.999, 57727.498999999996, 57727.498999999996, 6692.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(3): [0.18903328448083542, 0.1910768762199771, 0.18028295918786713, 0.17185795164969148, 0.1999539432299733, 0.051526740571932954, 0.004274034433229279]
layer_partition: [0, 2, 4, 6, 7, 9, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 24192.501, 26075.001, 0.001, 72770.001], memory_state: [17337.499000000003, 33534.999, 33534.999, 57727.498999999996, 6692.999, 16383.999, -56386.001000000004]
adj_stage_compute_performance(4): [0.18903328448083542, 0.1910768762199771, 0.18028295918786713, 0.17185795164969148, 0.1999539432299733, 0.051526740571932954, 0.0008660602071260884]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 2, 1, 1], num_stage=7, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 32768, 16384, 16384]
stage_compute_performance: [0.13674493524666312, 0.13674493524666312, 0.13674493524666312, 0.13674493524666312, 0.2706946547221993, 0.0911628021455742, 0.0911628021455742]
layer_partition: [0, 2, 3, 4, 5, 8, 9, 10]
stage_memory_demand: [76685.001, 31295.001, 31295.001, 31295.001, 72577.501, 31295.001, 130420.001], memory_state: [5234.998999999996, 50624.998999999996, 50624.998999999996, 50624.998999999996, -39809.501000000004, -14911.001, -114036.001]
adj_stage_compute_performance(2): [0.14608000194727314, 0.2614344398841572, 0.22571355648764588, 0.20043906301930833, 0.10999428323308243, 0.0429541515374222, 0.010307086374871129]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 24192.501, 0.001, 130420.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 19329.999000000003, 8575.499, 16383.999, -114036.001]
adj_stage_compute_performance(3): [0.14608000194727314, 0.2614344398841572, 0.22571355648764588, 0.20043906301930833, 0.10999428323308243, 0.0429541515374222, 0.0011653440552365868]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 24192.501, 0.001, 130420.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 19329.999000000003, 8575.499, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.14608000194727314, 0.2614344398841572, 0.22571355648764588, 0.20043906301930833, 0.10999428323308243, 0.0429541515374222, 0.0001317566107126208]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 32768, 16384, 16384]
stage_compute_performance: [0.1525008003417175, 0.1525008003417175, 0.1525008003417175, 0.1525008003417175, 0.18666348667512161, 0.10166665597900422, 0.10166665597900422]
layer_partition: [0, 2, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [76685.001, 31295.001, 62590.001, 31295.001, 20210.001, 31295.001, 161715.001], memory_state: [5234.998999999996, 50624.998999999996, 19329.999000000003, 50624.998999999996, 12557.999, -14911.001, -145331.001]
adj_stage_compute_performance(2): [0.1629114611864385, 0.19560304570139384, 0.18657656713080908, 0.17946160798517252, 0.21279376901634947, 0.047903364579026685, 0.00927023364025459]
layer_partition: [0, 2, 4, 6, 7, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 40420.001, 0.001, 130420.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 50624.998999999996, -7652.000999999997, 16383.999, -114036.001]
adj_stage_compute_performance(3): [0.1740328190175422, 0.2165888459038584, 0.2010634803718154, 0.18974277444361398, 0.15525837322010375, 0.04995887676762498, 0.0010481149832665473]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 20210.001, 0.001, 130420.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 19329.999000000003, 12557.999, 16383.999, -114036.001]
adj_stage_compute_performance(4): [0.1740328190175422, 0.2165888459038584, 0.2010634803718154, 0.18974277444361398, 0.15525837322010375, 0.04995887676762498, 0.00011850240897678877]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 2, 1, 1], num_stage=7, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 2, 1, 1], num_stage=7, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 2, 1, 1], num_stage=7, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 2, 1, 1], num_stage=7, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 2, 1, 1], num_stage=7, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[1, 1, 1, 1, 1, 1, 2], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 16384, 16384, 32768]
stage_compute_performance: [0.16033417386664783, 0.16033417386664783, 0.16033417386664783, 0.16033417386664783, 0.10695560210059711, 0.10695560210059711, 0.1447521003322144]
layer_partition: [0, 2, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [59830.001, 20730.001, 41460.001, 20730.001, 20730.001, 20730.001, 41757.501], memory_state: [22089.999000000003, 61189.998999999996, 40459.999, 61189.998999999996, -4346.001, -4346.001, -8989.500999999997]
adj_stage_compute_performance(2): [0.1972605624700009, 0.18802896531916263, 0.18110526745603392, 0.17591249405868742, 0.07607932707454114, 0.07607932707454114, 0.10223104925070592]
layer_partition: [0, 3, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [80560.001, 20730.001, 41460.001, 20730.001, 20730.001, 20730.001, 31160.001], memory_state: [1359.9989999999962, 61189.998999999996, 40459.999, 61189.998999999996, -4346.001, -4346.001, 1607.9989999999998]
adj_stage_compute_performance(3): [0.20059067871092098, 0.20207837180490695, 0.19129705169499772, 0.18347177701955233, 0.05411651091142513, 0.05411651091142513, 0.10562068012064449]
layer_partition: [0, 3, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [80560.001, 20730.001, 41460.001, 20730.001, 20730.001, 20730.001, 31160.001], memory_state: [1359.9989999999962, 61189.998999999996, 40459.999, 61189.998999999996, -4346.001, -4346.001, 1607.9989999999998]
adj_stage_compute_performance(4): [0.20397701335677298, 0.211929207156149, 0.1982670339015361, 0.18856706765651915, 0.03849398865419786, 0.03849398865419786, 0.10788829061260716]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[1, 1, 1, 1, 1, 1, 2], num_stage=7, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 16384, 16384, 32768]
stage_compute_performance: [0.1364166135952325, 0.1364166135952325, 0.1364166135952325, 0.1364166135952325, 0.13642270834184073, 0.13642270834184073, 0.18148812893538868]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 10]
stage_memory_demand: [64582.501, 24192.501, 24192.501, 24192.501, 48385.001, 24192.501, 81390.001], memory_state: [17337.499000000003, 57727.498999999996, 57727.498999999996, 57727.498999999996, -32001.000999999997, -7808.501, -48622.001000000004]
adj_stage_compute_performance(2): [0.1730383434008145, 0.23464360431065703, 0.20663510495003398, 0.186779314323489, 0.041575584304017, 0.08315116688950211, 0.06576118248308332]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 48385.001, 0.001, 24192.501, 60660.001], memory_state: [17337.499000000003, 33534.999, 33534.999, 33534.999, 16383.999, -7808.501, -27892.000999999997]
adj_stage_compute_performance(3): [0.19100152484487523, 0.25400017120382823, 0.21893464880448707, 0.19517077210682135, 0.043029439710641236, 0.05068156642778861, 0.03197125210804245]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [88775.001, 48385.001, 48385.001, 24192.501, 0.001, 0.001, 20730.001], memory_state: [-6855.001000000004, 33534.999, 33534.999, 57727.498999999996, 16383.999, 16383.999, 12037.999]
adj_stage_compute_performance(4): [0.15862754452419506, 0.26762846819011266, 0.2269226955683558, 0.20032772764562834, 0.04388685051845842, 0.05163671086478365, 0.032535311913053526]
layer_partition: None
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 16384, 16384, 32768]
stage_compute_performance: [0.13869151949828298, 0.13869151949828298, 0.13869151949828298, 0.13869151949828298, 0.13869771588188887, 0.13869771588188887, 0.16783849024309047]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 10]
stage_memory_demand: [64582.501, 24192.501, 24192.501, 24192.501, 48385.001, 24192.501, 57202.501], memory_state: [17337.499000000003, 57727.498999999996, 57727.498999999996, 57727.498999999996, -32001.000999999997, -7808.501, -24434.500999999997]
adj_stage_compute_performance(2): [0.1759239592981904, 0.22284327911261548, 0.19884819906194237, 0.18183760240630087, 0.04226890559138318, 0.08453780943557594, 0.08653045578299155]
layer_partition: [0, 2, 4, 6, 7, 7, 8, 9]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 24192.501, 0.001, 24192.501, 13037.501], memory_state: [17337.499000000003, 33534.999, 33534.999, 57727.498999999996, 16383.999, -7808.501, 19730.499]
adj_stage_compute_performance(3): [0.1844145992438346, 0.231515180310452, 0.20468775426306823, 0.1860084949833599, 0.043044338878461104, 0.051526740571932954, 0.08804400130779659]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 48385.001, 0.001, 0.001, 13037.501], memory_state: [17337.499000000003, 33534.999, 33534.999, 33534.999, 16383.999, 16383.999, 19730.499]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [1, 1, 1, 1, 1, 1, 2], num_stage: 7, batches: 64, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
execution_cost: 7877.820620880127, fb_sync_cost: 5207.039999999997, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 1.0156521739130435
cost: 13159.641722577964


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[1, 1, 1, 1, 1, 1, 2], num_stage=7, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 16384, 16384, 32768]
stage_compute_performance: [0.13674493524666312, 0.13674493524666312, 0.13674493524666312, 0.13674493524666312, 0.0911628021455742, 0.0911628021455742, 0.2706946547221993]
layer_partition: [0, 2, 3, 4, 5, 6, 7, 10]
stage_memory_demand: [76685.001, 31295.001, 31295.001, 31295.001, 31295.001, 31295.001, 121155.001], memory_state: [5234.998999999996, 50624.998999999996, 50624.998999999996, 50624.998999999996, -14911.001, -14911.001, -88387.001]
adj_stage_compute_performance(2): [0.14608000194727314, 0.2665279865478689, 0.22934791067980115, 0.2030409581263391, 0.0429541515374222, 0.0429541515374222, 0.06589171008585376]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 0.001, 0.001, 24192.501], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 19329.999000000003, 16383.999, 16383.999, 8575.499]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [1, 1, 1, 1, 1, 1, 2], num_stage: 7, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)], layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
execution_cost: 8102.989848480224, fb_sync_cost: 3458.8799999999974, parameter_upate_costs: 8.120613098144531, dp_cost: 3.86015625, pp_cost: 2.031304347826087
cost: 11608.704340389084
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 16384, 16384, 32768]
stage_compute_performance: [0.1525008003417175, 0.1525008003417175, 0.1525008003417175, 0.1525008003417175, 0.10166665597900422, 0.10166665597900422, 0.18666348667512161]
layer_partition: [0, 2, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [76685.001, 31295.001, 62590.001, 31295.001, 31295.001, 31295.001, 79860.001], memory_state: [5234.998999999996, 50624.998999999996, 19329.999000000003, 50624.998999999996, -14911.001, -14911.001, -47092.001000000004]
adj_stage_compute_performance(2): [0.1629114611864385, 0.2542961277493116, 0.19959842409961776, 0.2095196698297805, 0.047903364579026685, 0.047903364579026685, 0.06893225831832066]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 0.001, 0.001, 20210.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 19329.999000000003, 16383.999, 16383.999, 12557.999]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [1, 1, 1, 1, 1, 1, 2], num_stage: 7, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
execution_cost: 8139.009848480225, fb_sync_cost: 1107.0720000000038, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 2.031304347826087
cost: 9289.05618413909


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[1, 1, 1, 1, 1, 1, 2], num_stage=7, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[1, 1, 1, 1, 1, 1, 2], num_stage=7, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[1, 1, 1, 1, 1, 1, 2], num_stage=7, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[1, 1, 1, 1, 1, 1, 2], num_stage=7, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[1, 1, 1, 1, 1, 1, 2], num_stage=7, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[1, 1, 1, 1, 1, 1, 1, 1], num_stage=8, batches=128, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.14996287576511716, 0.14996287576511716, 0.14996287576511716, 0.14996287576511716, 0.1000371242348828, 0.1000371242348828, 0.1000371242348828, 0.1000371242348828]
layer_partition: [0, 2, 3, 5, 6, 7, 8, 9, 10]
stage_memory_demand: [59830.001, 20730.001, 41460.001, 20730.001, 20730.001, 20730.001, 20730.001, 60660.001], memory_state: [22089.999000000003, 61189.998999999996, 40459.999, 61189.998999999996, -4346.001, -4346.001, -4346.001, -44276.001]
adj_stage_compute_performance(2): [0.20533108101867487, 0.19361612518426852, 0.18270281282948067, 0.1745178285633898, 0.071158096862508, 0.071158096862508, 0.071158096862508, 0.024317629324105812]
layer_partition: [0, 3, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 20730.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001], memory_state: [1359.9989999999962, 61189.998999999996, 40459.999, 61189.998999999996, -4346.001, 16383.999, -4346.001, -44276.001]
adj_stage_compute_performance(3): [0.20879744225735353, 0.2142335593112435, 0.1970578534888641, 0.18486198599723971, 0.05061595670428563, 0.07439269410878789, 0.05061595670428563, 0.005911276443294728]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 20730.001, 0.001, 20730.001, 0.001, 60660.001], memory_state: [1359.9989999999962, 40459.999, 40459.999, 61189.998999999996, 16383.999, -4346.001, 16383.999, -44276.001]
adj_stage_compute_performance(4): [0.2123223219637547, 0.21953521067924064, 0.20078156327088453, 0.18759559650576696, 0.05121174108673527, 0.052916780382718874, 0.05117846281437947, 0.001436948837542003]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[1, 1, 1, 1, 1, 1, 1, 1], num_stage=8, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.12499720772167071, 0.12499720772167071, 0.12499720772167071, 0.12499720772167071, 0.12500279227832933, 0.12500279227832933, 0.12500279227832933, 0.12500279227832933]
layer_partition: [0, 2, 3, 4, 5, 6, 8, 9, 10]
stage_memory_demand: [64582.501, 24192.501, 24192.501, 24192.501, 24192.501, 48385.001, 24192.501, 72770.001], memory_state: [17337.499000000003, 57727.498999999996, 57727.498999999996, 57727.498999999996, -7808.501, -32001.000999999997, -7808.501, -56386.001000000004]
adj_stage_compute_performance(2): [0.15855334027028878, 0.23335061702588555, 0.20245466497528614, 0.18055190084551848, 0.07619060029466705, 0.0380953009346705, 0.07619060029466705, 0.025329684602028973]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 8, 9]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 24192.501, 24192.501, 0.001, 0.001, 24192.501], memory_state: [17337.499000000003, 33534.999, 33534.999, 57727.498999999996, -7808.501, 16383.999, 16383.999, -7808.501]
adj_stage_compute_performance(3): [0.1679296122790676, 0.24468952748645378, 0.20971061360584067, 0.18554953228805776, 0.046439023220668355, 0.03893565885275604, 0.07779931021248801, 0.015438726127062201]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 48385.001, 0.001, 0.001, 24192.501, 72770.001], memory_state: [17337.499000000003, 33534.999, 33534.999, 33534.999, 16383.999, 16383.999, -7808.501, -56386.001000000004]
adj_stage_compute_performance(4): [0.17855625324697388, 0.2572625997468018, 0.21753453754155394, 0.19084683978816797, 0.047489424784638065, 0.03977055675759976, 0.047419549912151006, 0.0031283946248565862]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[1, 1, 1, 1, 1, 1, 1, 1], num_stage=8, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [81920, 81920, 81920, 81920, 16384, 16384, 16384, 16384]
stage_compute_performance: [0.15000032119501963, 0.15000032119501963, 0.15000032119501963, 0.15000032119501963, 0.09999967880498041, 0.09999967880498041, 0.09999967880498041, 0.09999967880498041]
layer_partition: [0, 2, 3, 5, 6, 7, 8, 9, 10]
stage_memory_demand: [76685.001, 31295.001, 62590.001, 31295.001, 31295.001, 31295.001, 31295.001, 130420.001], memory_state: [5234.998999999996, 50624.998999999996, 19329.999000000003, 50624.998999999996, -14911.001, -14911.001, -14911.001, -114036.001]
adj_stage_compute_performance(2): [0.1602402836546355, 0.26962315235479756, 0.1963257088348027, 0.21845028740332673, 0.04711791713273054, 0.04711791713273054, 0.04711791713273054, 0.011306204972247462]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 0.001, 0.001, 0.001, 31295.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 19329.999000000003, 16383.999, 16383.999, 16383.999, -14911.001]
adj_stage_compute_performance(3): [0.1602402836546355, 0.26962315235479756, 0.1963257088348027, 0.21845028740332673, 0.04711791713273054, 0.04711791713273054, 0.04711791713273054, 0.005327265400591366]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 0.001, 0.001, 0.001, 31295.001], memory_state: [5234.998999999996, 19329.999000000003, 19329.999000000003, 19329.999000000003, 16383.999, 16383.999, 16383.999, -14911.001]
adj_stage_compute_performance(4): [0.1602402836546355, 0.26962315235479756, 0.1963257088348027, 0.21845028740332673, 0.04711791713273054, 0.04711791713273054, 0.04711791713273054, 0.002510104559222096]
layer_partition: None


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[1, 1, 1, 1, 1, 1, 1, 1], num_stage=8, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[1, 1, 1, 1, 1, 1, 1, 1], num_stage=8, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[1, 1, 1, 1, 1, 1, 1, 1], num_stage=8, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[1, 1, 1, 1, 1, 1, 1, 1], num_stage=8, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[1, 1, 1, 1, 1, 1, 1, 1], num_stage=8, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4], num_stage=1, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 4), (1, 4)]
stage_memory_capacity: [65536, 327680]
stage_compute_performance: [0.3852472420414939, 0.6147527579585061]
layer_partition: [0, 4, 10]
stage_memory_demand: [28393.751, 43851.251], memory_state: [37142.248999999996, 283828.749]
layer_partition: [0, 4, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4], num_stage: 1, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4)], layer_partition: [0, 4, 10]
execution_cost: 6464.0, fb_sync_cost: 4003.2000000000044, parameter_upate_costs: 4.060306549072266, dp_cost: 0.0, pp_cost: 0.0
cost: 10602.54997940064


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4], num_stage=1, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 2), (2, 2)]
stage_memory_capacity: [65536, 327680]
stage_compute_performance: [0.34185441921994075, 0.6581455807800592]
layer_partition: [0, 4, 10]
stage_memory_demand: [53682.501, 84147.501], memory_state: [11853.499000000003, 243532.499]
layer_partition: [0, 4, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4], num_stage: 1, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2)], layer_partition: [0, 4, 10]
execution_cost: 6350.719999999999, fb_sync_cost: -65.27999999999884, parameter_upate_costs: 8.120613098144531, dp_cost: 9.540234375, pp_cost: 0.0
cost: 6368.7456838989265


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4], num_stage=1, batches=32, gbs=128)
valid_strategies: [(4, 1), (4, 1)]
stage_memory_capacity: [65536, 327680]
stage_compute_performance: [0.40014849693953125, 0.5998515030604687]
layer_partition: [0, 4, 10]
stage_memory_demand: [25500.001, 37500.001], memory_state: [40035.998999999996, 290179.999]
layer_partition: [0, 4, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4], num_stage: 1, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1)], layer_partition: [0, 4, 10]
execution_cost: 4259.129745483398, fb_sync_cost: 5183.870544433594, parameter_upate_costs: 16.241226196289062, dp_cost: 28.620703125, pp_cost: 0.0
cost: 9520.684637451172


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4], num_stage=1, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1)]
stage_memory_capacity: [65536, 327680]
stage_compute_performance: [0.5000111691133173, 0.49998883088668283]
layer_partition: [0, 5, 10]
stage_memory_demand: [34000.001, 47500.001], memory_state: [31535.999000000003, 280179.999]
layer_partition: [0, 5, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4], num_stage: 1, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1)], layer_partition: [0, 5, 10]
execution_cost: 3777.12, fb_sync_cost: 1729.4399999999987, parameter_upate_costs: 20.301532745361328, dp_cost: 34.410937499999996, pp_cost: 0.0
cost: 5577.683679351805


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4], num_stage=1, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1)]
stage_memory_capacity: [65536, 327680]
stage_compute_performance: [0.39999871521992153, 0.6000012847800784]
layer_partition: [0, 4, 10]
stage_memory_demand: [34100.001, 61480.001], memory_state: [31435.999000000003, 266199.999]
layer_partition: [0, 4, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4], num_stage: 1, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1)], layer_partition: [0, 4, 10]
execution_cost: 4209.5199999999995, fb_sync_cost: 2511.4400000000023, parameter_upate_costs: 16.241226196289062, dp_cost: 28.620703125, pp_cost: 0.0
cost: 6774.027533874513


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4], num_stage=1, batches=4, gbs=128)
invalid_strategy: dp_deg(4), batches(4), mbs(0)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4], num_stage=1, batches=2, gbs=128)
invalid_strategy: dp_deg(4), batches(2), mbs(0)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4], num_stage=1, batches=1, gbs=128)
invalid_strategy: dp_deg(4), batches(1), mbs(0)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4], num_stage=2, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 4), (1, 4)]
stage_memory_capacity: [65536, 327680]
stage_compute_performance: [0.3852472420414939, 0.6147527579585061]
layer_partition: [0, 4, 10]
stage_memory_demand: [28393.751, 43851.251], memory_state: [37142.248999999996, 283828.749]
layer_partition: [0, 4, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4], num_stage: 2, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4)], layer_partition: [0, 4, 10]
execution_cost: 6632.561767578125, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 6.090459823608398, dp_cost: 0.0, pp_cost: 0.08695652173913043
cost: 8923.031786462536


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4], num_stage=2, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 2), (2, 2)]
stage_memory_capacity: [65536, 327680]
stage_compute_performance: [0.34185441921994075, 0.6581455807800592]
layer_partition: [0, 4, 10]
stage_memory_demand: [53682.501, 84147.501], memory_state: [11853.499000000003, 243532.499]
layer_partition: [0, 4, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4], num_stage: 2, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2)], layer_partition: [0, 4, 10]
execution_cost: 6435.262036056518, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 12.180919647216797, dp_cost: 14.565684442934781, pp_cost: 0.08695652173913043
cost: 8536.198379871534


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4], num_stage=2, batches=32, gbs=128)
valid_strategies: [(4, 1), (4, 1)]
stage_memory_capacity: [65536, 327680]
stage_compute_performance: [0.40014849693953125, 0.5998515030604687]
layer_partition: [0, 4, 10]
stage_memory_demand: [25500.001, 37500.001], memory_state: [40035.998999999996, 290179.999]
layer_partition: [0, 4, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4], num_stage: 2, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1)], layer_partition: [0, 4, 10]
execution_cost: 4867.499507427216, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 24.361839294433594, dp_cost: 43.697053328804344, pp_cost: 0.08695652173913043
cost: 6761.53112927727


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4], num_stage=2, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1)]
stage_memory_capacity: [65536, 327680]
stage_compute_performance: [0.5000111691133173, 0.49998883088668283]
layer_partition: [0, 5, 10]
stage_memory_demand: [34000.001, 47500.001], memory_state: [31535.999000000003, 280179.999]
layer_partition: [0, 5, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4], num_stage: 2, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1)], layer_partition: [0, 5, 10]
execution_cost: 4013.8181079101564, fb_sync_cost: 1729.0931701660156, parameter_upate_costs: 20.301532745361328, dp_cost: 37.4033203125, pp_cost: 0.17391304347826086
cost: 5817.201253283956


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4], num_stage=2, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1)]
stage_memory_capacity: [65536, 327680]
stage_compute_performance: [0.39999871521992153, 0.6000012847800784]
layer_partition: [0, 4, 10]
stage_memory_demand: [34100.001, 61480.001], memory_state: [31435.999000000003, 266199.999]
layer_partition: [0, 4, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4], num_stage: 2, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1)], layer_partition: [0, 4, 10]
execution_cost: 5197.349744262696, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 24.361839294433594, dp_cost: 43.697053328804344, pp_cost: 0.34782608695652173
cost: 6948.288010519277


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4], num_stage=2, batches=4, gbs=128)
invalid_strategy: dp_deg(4), batches(4), mbs(0)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4], num_stage=2, batches=2, gbs=128)
invalid_strategy: dp_deg(4), batches(2), mbs(0)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4], num_stage=2, batches=1, gbs=128)
invalid_strategy: dp_deg(4), batches(1), mbs(0)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 2, 2], num_stage=3, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 4), (1, 2), (1, 2)]
stage_memory_capacity: [65536, 163840, 163840]
stage_compute_performance: [0.3393336959471241, 0.330333152026438, 0.330333152026438]
layer_partition: [0, 4, 7, 10]
stage_memory_demand: [28393.751, 31792.501, 52355.001], memory_state: [37142.248999999996, 132047.499, 111484.99900000001]
layer_partition: [0, 4, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 2, 2], num_stage: 3, batches: 128, gbs: 128, strategies: [(1, 4), (1, 2), (1, 2)], layer_partition: [0, 4, 7, 10]
execution_cost: 6550.257289886475, fb_sync_cost: 4016.9158935546875, parameter_upate_costs: 6.090459823608398, dp_cost: 0.0, pp_cost: 0.17391304347826086
cost: 10704.727229159811


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 2, 2], num_stage=3, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 2), (2, 1), (2, 1)]
stage_memory_capacity: [65536, 163840, 163840]
stage_compute_performance: [0.3110136242055267, 0.34449318789723665, 0.34449318789723665]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [43085.001, 18000.001, 25500.001], memory_state: [22450.999000000003, 145839.999, 138339.999]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 2, 2], num_stage: 3, batches: 64, gbs: 128, strategies: [(2, 2), (2, 1), (2, 1)], layer_partition: [0, 3, 6, 10]
execution_cost: 5847.034074287414, fb_sync_cost: 3586.126708984375, parameter_upate_costs: 16.241226196289062, dp_cost: 20.739724864130434, pp_cost: 0.17391304347826086
cost: 9535.960483801467


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 2, 2], num_stage=3, batches=32, gbs=128)
valid_strategies: [(4, 1), (2, 1), (2, 1)]
stage_memory_capacity: [65536, 163840, 163840]
stage_compute_performance: [0.3994708293772433, 0.30026458531137834, 0.30026458531137834]
layer_partition: [0, 4, 7, 10]
stage_memory_demand: [25500.001, 22500.001, 32500.001], memory_state: [40035.998999999996, 141339.999, 131339.999]
layer_partition: [0, 4, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 2, 2], num_stage: 3, batches: 32, gbs: 128, strategies: [(4, 1), (2, 1), (2, 1)], layer_partition: [0, 4, 7, 10]
execution_cost: 5902.3667941093445, fb_sync_cost: 3458.1863403320312, parameter_upate_costs: 16.241226196289062, dp_cost: 28.620703125, pp_cost: 0.2608695652173913
cost: 9438.498351540773


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 2, 2], num_stage=3, batches=16, gbs=128)
valid_strategies: [(4, 1), (2, 1), (2, 1)]
stage_memory_capacity: [65536, 163840, 163840]
stage_compute_performance: [0.49743173901350834, 0.25128413049324577, 0.25128413049324577]
layer_partition: [0, 5, 7, 10]
stage_memory_demand: [34000.001, 18000.001, 34480.001], memory_state: [31535.999000000003, 145839.999, 129359.99900000001]
layer_partition: [0, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 2, 2], num_stage: 3, batches: 16, gbs: 128, strategies: [(4, 1), (2, 1), (2, 1)], layer_partition: [0, 5, 7, 10]
execution_cost: 4244.449263687134, fb_sync_cost: 3348.651885986328, parameter_upate_costs: 20.301532745361328, dp_cost: 34.410937499999996, pp_cost: 0.5217391304347826
cost: 7664.746568155703


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 2, 2], num_stage=3, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 2, 2], num_stage=3, batches=4, gbs=128)
invalid_strategy: dp_deg(4), batches(4), mbs(0)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 2, 2], num_stage=3, batches=2, gbs=128)
invalid_strategy: dp_deg(4), batches(2), mbs(0)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 2, 2], num_stage=3, batches=1, gbs=128)
invalid_strategy: dp_deg(4), batches(1), mbs(0)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[2, 4, 2], num_stage=3, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 4), (1, 2)]
stage_memory_capacity: [32768, 196608, 163840]
stage_compute_performance: [0.2039609265863347, 0.40336905092014846, 0.39267002249351685]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [43085.001, 17107.501, 62952.501], memory_state: [-10317.000999999997, 179500.499, 100887.49900000001]
adj_stage_compute_performance(2): [0.13960896689181726, 0.44412812287565284, 0.41224236570766]
layer_partition: [0, 2, 6, 10]
stage_memory_demand: [32487.501, 22810.001, 62952.501], memory_state: [280.4989999999998, 173797.999, 100887.49900000001]
layer_partition: [0, 2, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 4, 2], num_stage: 3, batches: 128, gbs: 128, strategies: [(1, 2), (1, 4), (1, 2)], layer_partition: [0, 2, 6, 10]
data loadbalancer: [1]
execution_cost: 8440.936365432739, fb_sync_cost: 4016.9158935546875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.17391304347826086
cost: 12597.436457980612


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[2, 4, 2], num_stage=3, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 1), (2, 2), (2, 1)]
stage_memory_capacity: [32768, 196608, 163840]
stage_compute_performance: [0.25957459242046815, 0.3513043422484879, 0.3891210653310439]
layer_partition: [0, 3, 6, 10]
stage_memory_demand: [19500.001, 63585.001000000004, 25500.001], memory_state: [13267.999, 133022.999, 138339.999]
layer_partition: [0, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 4, 2], num_stage: 3, batches: 64, gbs: 128, strategies: [(2, 1), (2, 2), (2, 1)], layer_partition: [0, 3, 6, 10]
data loadbalancer: [1, 1]
execution_cost: 6417.770014762878, fb_sync_cost: 3586.126708984375, parameter_upate_costs: 16.241226196289062, dp_cost: 20.739724864130434, pp_cost: 0.17391304347826086
cost: 10106.696424276932


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[2, 4, 2], num_stage=3, batches=32, gbs=128)
valid_strategies: [(2, 1), (4, 1), (2, 1)]
stage_memory_capacity: [32768, 196608, 163840]
stage_compute_performance: [0.30027397217549395, 0.39946547052543335, 0.30026055729907275]
layer_partition: [0, 4, 7, 10]
stage_memory_demand: [26500.001, 72000.001, 32500.001], memory_state: [6267.999, 124607.999, 131339.999]
layer_partition: [0, 4, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 4, 2], num_stage: 3, batches: 32, gbs: 128, strategies: [(2, 1), (4, 1), (2, 1)], layer_partition: [0, 4, 7, 10]
data loadbalancer: [1, 1, 1, 1]
execution_cost: 5921.888015003204, fb_sync_cost: 3458.1863403320312, parameter_upate_costs: 16.241226196289062, dp_cost: 19.08046875, pp_cost: 0.2608695652173913
cost: 9448.479338059633


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[2, 4, 2], num_stage=3, batches=16, gbs=128)
valid_strategies: [(2, 1), (4, 1), (2, 1)]
stage_memory_capacity: [32768, 196608, 163840]
stage_compute_performance: [0.18284110698081804, 0.5428957643519156, 0.2742631286672664]
layer_partition: [0, 3, 7, 10]
stage_memory_demand: [25100.001, 120000.001, 34480.001], memory_state: [7667.999, 76607.999, 129359.99900000001]
layer_partition: [0, 3, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 4, 2], num_stage: 3, batches: 16, gbs: 128, strategies: [(2, 1), (4, 1), (2, 1)], layer_partition: [0, 3, 7, 10]
data loadbalancer: [2, 2, 2, 2]
execution_cost: 6091.091460647583, fb_sync_cost: 3348.651885986328, parameter_upate_costs: 16.241226196289062, dp_cost: 25.17493206521739, pp_cost: 0.5217391304347826
cost: 9498.092453132296


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[2, 4, 2], num_stage=3, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[2, 4, 2], num_stage=3, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[2, 4, 2], num_stage=3, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[2, 4, 2], num_stage=3, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[2, 2, 4], num_stage=3, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 2), (1, 4)]
stage_memory_capacity: [32768, 32768, 327680]
stage_compute_performance: [0.19395438767522766, 0.19395438767522766, 0.6120912246495447]
layer_partition: [0, 2, 4, 10]
stage_memory_demand: [32487.501, 21195.001, 43851.251], memory_state: [280.4989999999998, 11572.999, 283828.749]
layer_partition: [0, 2, 4, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 4], num_stage: 3, batches: 128, gbs: 128, strategies: [(1, 2), (1, 2), (1, 4)], layer_partition: [0, 2, 4, 10]
execution_cost: 8405.652357559204, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 6.090459823608398, dp_cost: 0.0, pp_cost: 0.16695652173913045
cost: 10696.202376443614


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[2, 2, 4], num_stage=3, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 1), (2, 1), (2, 2)]
stage_memory_capacity: [32768, 32768, 327680]
stage_compute_performance: [0.21712857038716996, 0.21712857038716996, 0.5657428592256601]
layer_partition: [0, 3, 5, 10]
stage_memory_demand: [19500.001, 12000.001, 73550.001], memory_state: [13267.999, 20767.999, 254129.999]
layer_partition: [0, 3, 5, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 4], num_stage: 3, batches: 64, gbs: 128, strategies: [(2, 1), (2, 1), (2, 2)], layer_partition: [0, 3, 5, 10]
execution_cost: 5841.728762626648, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 12.180919647216797, dp_cost: 15.2203125, pp_cost: 0.16695652173913045
cost: 7943.399734498728


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[2, 2, 4], num_stage=3, batches=32, gbs=128)
valid_strategies: [(2, 1), (2, 1), (4, 1)]
stage_memory_capacity: [32768, 32768, 327680]
stage_compute_performance: [0.2503585922771058, 0.2503585922771058, 0.4992828154457884]
layer_partition: [0, 3, 5, 10]
stage_memory_demand: [19000.001, 15000.001, 31500.001], memory_state: [13767.999, 17767.999, 296179.999]
layer_partition: [0, 3, 5, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 4], num_stage: 3, batches: 32, gbs: 128, strategies: [(2, 1), (2, 1), (4, 1)], layer_partition: [0, 3, 5, 10]
execution_cost: 4026.2158740234377, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 20.301532745361328, dp_cost: 37.4033203125, pp_cost: 0.3339130434782609
cost: 5910.1404128298545


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[2, 2, 4], num_stage=3, batches=16, gbs=128)
valid_strategies: [(2, 1), (2, 1), (4, 1)]
stage_memory_capacity: [32768, 32768, 327680]
stage_compute_performance: [0.20123876138864472, 0.20123876138864472, 0.5975224772227105]
layer_partition: [0, 2, 4, 10]
stage_memory_demand: [16100.001, 18000.001, 55000.001], memory_state: [16667.999, 14767.999, 272679.999]
layer_partition: [0, 2, 4, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 4], num_stage: 3, batches: 16, gbs: 128, strategies: [(2, 1), (2, 1), (4, 1)], layer_partition: [0, 2, 4, 10]
execution_cost: 6066.662658157348, fb_sync_cost: 1729.0931701660156, parameter_upate_costs: 24.361839294433594, dp_cost: 43.697053328804344, pp_cost: 0.6678260869565218
cost: 7880.8937561400035


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[2, 2, 4], num_stage=3, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[2, 2, 4], num_stage=3, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[2, 2, 4], num_stage=3, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[2, 2, 4], num_stage=3, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 2, 2, 2], num_stage=4, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 2), (1, 2), (1, 2)]
stage_memory_capacity: [32768, 32768, 163840, 163840]
stage_compute_performance: [0.17092720960997038, 0.17092720960997038, 0.3290727903900296, 0.3290727903900296]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [32487.501, 10597.501, 31792.501, 62952.501], memory_state: [280.4989999999998, 22170.499, 132047.499, 100887.49900000001]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 2, 2], num_stage: 4, batches: 128, gbs: 128, strategies: [(1, 2), (1, 2), (1, 2), (1, 2)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 6628.1382813262935, fb_sync_cost: 4016.9158935546875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.2539130434782609
cost: 10784.718373874166


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 2, 2, 2], num_stage=4, batches=64, gbs=128)
valid_strategies: [(2, 1), (2, 1), (2, 1), (2, 1)]
stage_memory_capacity: [32768, 32768, 163840, 163840]
stage_compute_performance: [0.2000742484697656, 0.2000742484697656, 0.2999257515302343, 0.2999257515302343]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [19500.001, 12000.001, 12000.001, 19500.001], memory_state: [13267.999, 20767.999, 151839.999, 144339.999]
layer_partition: [0, 3, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 2, 2], num_stage: 4, batches: 64, gbs: 128, strategies: [(2, 1), (2, 1), (2, 1), (2, 1)], layer_partition: [0, 3, 5, 7, 10]
execution_cost: 5892.4666204452515, fb_sync_cost: 3586.126708984375, parameter_upate_costs: 12.180919647216797, dp_cost: 16.543902853260867, pp_cost: 0.2539130434782609
cost: 9573.216901399363


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 2, 2, 2], num_stage=4, batches=32, gbs=128)
valid_strategies: [(2, 1), (2, 1), (2, 1), (2, 1)]
stage_memory_capacity: [32768, 32768, 163840, 163840]
stage_compute_performance: [0.25000558455665867, 0.25000558455665867, 0.24999441544334142, 0.24999441544334142]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [19000.001, 15000.001, 15000.001, 32500.001], memory_state: [13767.999, 17767.999, 148839.999, 131339.999]
layer_partition: [0, 3, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 2, 2], num_stage: 4, batches: 32, gbs: 128, strategies: [(2, 1), (2, 1), (2, 1), (2, 1)], layer_partition: [0, 3, 5, 7, 10]
execution_cost: 4142.035328216552, fb_sync_cost: 3458.1863403320312, parameter_upate_costs: 12.180919647216797, dp_cost: 16.543902853260867, pp_cost: 0.5078260869565218
cost: 7662.276735348909


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 2, 2, 2], num_stage=4, batches=16, gbs=128)
valid_strategies: [(2, 1), (2, 1), (2, 1), (2, 1)]
stage_memory_capacity: [32768, 32768, 163840, 163840]
stage_compute_performance: [0.1999993576099608, 0.1999993576099608, 0.30000064239003926, 0.30000064239003926]
layer_partition: [0, 3, 5, 7, 10]
stage_memory_demand: [25100.001, 18000.001, 18000.001, 34480.001], memory_state: [7667.999, 14767.999, 145839.999, 129359.99900000001]
layer_partition: [0, 3, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 2, 2], num_stage: 4, batches: 16, gbs: 128, strategies: [(2, 1), (2, 1), (2, 1), (2, 1)], layer_partition: [0, 3, 5, 7, 10]
execution_cost: 6438.469263687133, fb_sync_cost: 3348.651885986328, parameter_upate_costs: 12.180919647216797, dp_cost: 16.543902853260867, pp_cost: 1.0156521739130435
cost: 9833.272833454297


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 2, 2, 2], num_stage=4, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 2, 2, 2], num_stage=4, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 2, 2, 2], num_stage=4, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 2, 2, 2], num_stage=4, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 1, 1, 1, 1], num_stage=5, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 4), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [65536, 81920, 81920, 81920, 81920]
stage_compute_performance: [0.30861367519475297, 0.17284658120131174, 0.17284658120131174, 0.17284658120131174, 0.17284658120131174]
layer_partition: [0, 4, 5, 6, 8, 10]
stage_memory_demand: [28393.751, 6000.001, 6000.001, 12000.001, 13500.001], memory_state: [37142.248999999996, 75919.999, 75919.999, 69919.999, 68419.999]
layer_partition: [0, 4, 5, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 1, 1, 1, 1], num_stage: 5, batches: 128, gbs: 128, strategies: [(1, 4), (1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 4, 5, 6, 8, 10]
execution_cost: 7693.480694770813, fb_sync_cost: 7172.25341796875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.34782608695652173
cost: 15005.492224776226


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 1, 1, 1, 1], num_stage=5, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(2, 2), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [65536, 81920, 81920, 81920, 81920]
stage_compute_performance: [0.3104087953149997, 0.1723978011712501, 0.1723978011712501, 0.1723978011712501, 0.1723978011712501]
layer_partition: [0, 4, 5, 6, 8, 10]
stage_memory_demand: [53682.501, 7500.001, 7500.001, 15000.001, 25000.001], memory_state: [11853.499000000003, 74419.999, 74419.999, 66919.999, 56919.998999999996]
layer_partition: [0, 4, 5, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 1, 1, 1, 1], num_stage: 5, batches: 64, gbs: 128, strategies: [(2, 2), (1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 4, 5, 6, 8, 10]
execution_cost: 7810.9912361907955, fb_sync_cost: 6916.3726806640625, parameter_upate_costs: 8.120613098144531, dp_cost: 9.540234375, pp_cost: 0.6086956521739131
cost: 14811.278296405957


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 1, 1, 1, 1], num_stage=5, batches=32, gbs=128)
valid_strategies: [(4, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [65536, 81920, 81920, 81920, 81920]
stage_compute_performance: [0.39699823627360364, 0.1507504409315991, 0.1507504409315991, 0.1507504409315991, 0.1507504409315991]
layer_partition: [0, 4, 6, 7, 8, 10]
stage_memory_demand: [25500.001, 18000.001, 9000.001, 9000.001, 25480.001], memory_state: [40035.998999999996, 63919.998999999996, 72919.999, 72919.999, 56439.998999999996]
layer_partition: [0, 4, 6, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 1, 1, 1, 1], num_stage: 5, batches: 32, gbs: 128, strategies: [(4, 1), (1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 4, 6, 7, 8, 10]
execution_cost: 7944.066442012787, fb_sync_cost: 6697.303771972656, parameter_upate_costs: 16.241226196289062, dp_cost: 28.620703125, pp_cost: 1.1304347826086956
cost: 14720.18499630223


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 1, 1, 1, 1], num_stage=5, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 1, 1, 1, 1], num_stage=5, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 1, 1, 1, 1], num_stage=5, batches=4, gbs=128)
invalid_strategy: dp_deg(4), batches(4), mbs(0)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 1, 1, 1, 1], num_stage=5, batches=2, gbs=128)
invalid_strategy: dp_deg(4), batches(2), mbs(0)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 1, 1, 1, 1], num_stage=5, batches=1, gbs=128)
invalid_strategy: dp_deg(4), batches(1), mbs(0)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 4, 1, 1], num_stage=5, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 4), (1, 1), (1, 1)]
stage_memory_capacity: [16384, 16384, 196608, 81920, 81920]
stage_compute_performance: [0.13029818184245864, 0.13029818184245864, 0.3487508620473526, 0.19532638713386505, 0.19532638713386505]
layer_partition: [0, 2, 3, 6, 8, 10]
stage_memory_demand: [13500.001, 6000.001, 17107.501, 12000.001, 13500.001], memory_state: [2883.999, 10383.999, 179500.499, 69919.999, 68419.999]
layer_partition: [0, 2, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 4, 1, 1], num_stage: 5, batches: 128, gbs: 128, strategies: [(1, 1), (1, 1), (1, 4), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 6, 8, 10]
data loadbalancer: [1]
execution_cost: 7721.760656318665, fb_sync_cost: 7172.25341796875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.3408695652173913
cost: 15033.765229802339


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 4, 1, 1], num_stage=5, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(1, 1), (1, 1), (2, 2), (1, 1), (1, 1)]
stage_memory_capacity: [16384, 16384, 196608, 81920, 81920]
stage_compute_performance: [0.1724028476706497, 0.1724028476706497, 0.31040401366883, 0.17239514549493526, 0.17239514549493526]
layer_partition: [0, 2, 4, 7, 8, 10]
stage_memory_demand: [11500.001, 15000.001, 63585.001000000004, 7500.001, 25000.001], memory_state: [4883.999, 1383.9989999999998, 133022.999, 74419.999, 56919.998999999996]
layer_partition: [0, 2, 4, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 4, 1, 1], num_stage: 5, batches: 64, gbs: 128, strategies: [(1, 1), (1, 1), (2, 2), (1, 1), (1, 1)], layer_partition: [0, 2, 4, 7, 8, 10]
data loadbalancer: [1, 1]
execution_cost: 7809.452453918457, fb_sync_cost: 6916.3726806640625, parameter_upate_costs: 8.120613098144531, dp_cost: 6.293733016304348, pp_cost: 0.5947826086956522
cost: 14806.479099731445


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 4, 1, 1], num_stage=5, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (4, 1), (1, 1), (1, 1)]
stage_memory_capacity: [16384, 16384, 196608, 81920, 81920]
stage_compute_performance: [0.11172863703826845, 0.11172863703826845, 0.44135502046880615, 0.16759385272732846, 0.16759385272732846]
layer_partition: [0, 2, 3, 7, 8, 10]
stage_memory_demand: [16100.001, 9000.001, 96000.001, 9000.001, 25480.001], memory_state: [283.9989999999998, 7383.999, 100607.999, 72919.999, 56439.998999999996]
layer_partition: [0, 2, 3, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 4, 1, 1], num_stage: 5, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (4, 1), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 7, 8, 10]
data loadbalancer: [1, 1, 1, 1]
execution_cost: 6251.055127944946, fb_sync_cost: 6697.303771972656, parameter_upate_costs: 16.241226196289062, dp_cost: 25.17493206521739, pp_cost: 1.102608695652174
cost: 13023.700085087652


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 4, 1, 1], num_stage=5, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 4, 1, 1], num_stage=5, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 4, 1, 1], num_stage=5, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 4, 1, 1], num_stage=5, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 4, 1, 1], num_stage=5, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 4], num_stage=5, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 4)]
stage_memory_capacity: [16384, 16384, 16384, 16384, 327680]
stage_compute_performance: [0.12090317000761379, 0.12090317000761379, 0.12090317000761379, 0.12090317000761379, 0.5163873199695448]
layer_partition: [0, 2, 3, 4, 5, 10]
stage_memory_demand: [13500.001, 6000.001, 6000.001, 6000.001, 38148.751], memory_state: [2883.999, 10383.999, 10383.999, 10383.999, 289531.249]
layer_partition: [0, 2, 3, 4, 5, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 1, 1, 4], num_stage: 5, batches: 128, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 4)], layer_partition: [0, 2, 3, 4, 5, 10]
execution_cost: 5879.475403308868, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.3269565217391304
cost: 8172.215575467814


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 4], num_stage=5, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 2)]
stage_memory_capacity: [16384, 16384, 16384, 16384, 327680]
stage_compute_performance: [0.13393550409406507, 0.13393550409406507, 0.13393550409406507, 0.13393550409406507, 0.4642579836237398]
layer_partition: [0, 2, 3, 4, 5, 10]
stage_memory_demand: [11500.001, 7500.001, 7500.001, 7500.001, 73550.001], memory_state: [4883.999, 8883.999, 8883.999, 8883.999, 254129.999]
layer_partition: [0, 2, 3, 4, 5, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 1, 1, 4], num_stage: 5, batches: 64, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 2)], layer_partition: [0, 2, 3, 4, 5, 10]
execution_cost: 4569.13884765625, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 10.150766372680664, dp_cost: 12.4677734375, pp_cost: 0.6539130434782608
cost: 6666.514083713034


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 4], num_stage=5, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (4, 1)]
stage_memory_capacity: [16384, 16384, 16384, 16384, 327680]
stage_compute_performance: [0.1007892166802829, 0.1007892166802829, 0.1007892166802829, 0.1007892166802829, 0.5968431332788685]
layer_partition: [0, 2, 3, 3, 4, 10]
stage_memory_demand: [16100.001, 9000.001, 0.001, 9000.001, 37500.001], memory_state: [283.9989999999998, 7383.999, 16383.999, 7383.999, 290179.999]
layer_partition: [0, 2, 3, 3, 4, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 1, 1, 4], num_stage: 5, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (4, 1)], layer_partition: [0, 2, 3, 3, 4, 10]
execution_cost: 6145.330053215026, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 24.361839294433594, dp_cost: 43.697053328804344, pp_cost: 1.3078260869565217
cost: 8040.582544630298


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 4], num_stage=5, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 4], num_stage=5, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 4], num_stage=5, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 4], num_stage=5, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 4], num_stage=5, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[2, 2, 2, 1, 1], num_stage=5, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 2), (1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [32768, 32768, 163840, 81920, 81920]
stage_compute_performance: [0.16285278923198981, 0.16285278923198981, 0.31352774024484087, 0.18038334064558972, 0.18038334064558972]
layer_partition: [0, 2, 3, 6, 8, 10]
stage_memory_demand: [32487.501, 10597.501, 31792.501, 12000.001, 13500.001], memory_state: [280.4989999999998, 22170.499, 132047.499, 69919.999, 68419.999]
layer_partition: [0, 2, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 2, 1, 1], num_stage: 5, batches: 128, gbs: 128, strategies: [(1, 2), (1, 2), (1, 2), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 6, 8, 10]
execution_cost: 7701.208211402893, fb_sync_cost: 7172.25341796875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.3408695652173913
cost: 15013.212784886568


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[2, 2, 2, 1, 1], num_stage=5, batches=64, gbs=128)
valid_strategies: [(2, 1), (2, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [32768, 32768, 163840, 81920, 81920]
stage_compute_performance: [0.19990468800045877, 0.19990468800045877, 0.29967156813794055, 0.15025952793057093, 0.15025952793057093]
layer_partition: [0, 3, 5, 7, 8, 10]
stage_memory_demand: [19500.001, 12000.001, 12000.001, 7500.001, 25000.001], memory_state: [13267.999, 20767.999, 151839.999, 74419.999, 56919.998999999996]
layer_partition: [0, 3, 5, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 2, 1, 1], num_stage: 5, batches: 64, gbs: 128, strategies: [(2, 1), (2, 1), (2, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 5, 7, 8, 10]
execution_cost: 5951.423005104065, fb_sync_cost: 6916.3726806640625, parameter_upate_costs: 12.180919647216797, dp_cost: 15.2203125, pp_cost: 0.42782608695652175
cost: 12961.269580428081


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[2, 2, 2, 1, 1], num_stage=5, batches=32, gbs=128)
valid_strategies: [(2, 1), (2, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [32768, 32768, 163840, 81920, 81920]
stage_compute_performance: [0.2493590594025154, 0.2493590594025154, 0.2493479191730038, 0.1259669810109827, 0.1259669810109827]
layer_partition: [0, 3, 5, 7, 8, 10]
stage_memory_demand: [19000.001, 15000.001, 15000.001, 9000.001, 25480.001], memory_state: [13767.999, 17767.999, 148839.999, 72919.999, 56439.998999999996]
layer_partition: [0, 3, 5, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 2, 1, 1], num_stage: 5, batches: 32, gbs: 128, strategies: [(2, 1), (2, 1), (2, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 5, 7, 8, 10]
execution_cost: 4256.844657821655, fb_sync_cost: 6697.303771972656, parameter_upate_costs: 12.180919647216797, dp_cost: 15.2203125, pp_cost: 0.8556521739130435
cost: 11015.227732328332


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[2, 2, 2, 1, 1], num_stage=5, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[2, 2, 2, 1, 1], num_stage=5, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[2, 2, 2, 1, 1], num_stage=5, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[2, 2, 2, 1, 1], num_stage=5, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[2, 2, 2, 1, 1], num_stage=5, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[1, 1, 2, 2, 2], num_stage=5, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 2), (1, 2)]
stage_memory_capacity: [16384, 16384, 32768, 163840, 163840]
stage_compute_performance: [0.11676081282436179, 0.11676081282436179, 0.1580223247860017, 0.3042280247826374, 0.3042280247826374]
layer_partition: [0, 2, 3, 4, 7, 10]
stage_memory_demand: [13500.001, 6000.001, 10597.501, 31792.501, 52355.001], memory_state: [2883.999, 10383.999, 22170.499, 132047.499, 111484.99900000001]
layer_partition: [0, 2, 3, 4, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 2, 2, 2], num_stage: 5, batches: 128, gbs: 128, strategies: [(1, 1), (1, 1), (1, 2), (1, 2), (1, 2)], layer_partition: [0, 2, 3, 4, 7, 10]
execution_cost: 6621.093240737915, fb_sync_cost: 4016.9158935546875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.3339130434782609
cost: 10777.753333285787


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[1, 1, 2, 2, 2], num_stage=5, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1), (2, 1), (2, 1)]
stage_memory_capacity: [16384, 16384, 32768, 163840, 163840]
stage_compute_performance: [0.13663296228036942, 0.13663296228036942, 0.1817678374558298, 0.2724831189917157, 0.2724831189917157]
layer_partition: [0, 2, 3, 5, 7, 10]
stage_memory_demand: [11500.001, 7500.001, 12000.001, 12000.001, 19500.001], memory_state: [4883.999, 8883.999, 20767.999, 151839.999, 144339.999]
layer_partition: [0, 2, 3, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 2, 2, 2], num_stage: 5, batches: 64, gbs: 128, strategies: [(1, 1), (1, 1), (2, 1), (2, 1), (2, 1)], layer_partition: [0, 2, 3, 5, 7, 10]
execution_cost: 5902.3093315124515, fb_sync_cost: 3586.126708984375, parameter_upate_costs: 12.180919647216797, dp_cost: 16.543902853260867, pp_cost: 0.49391304347826087
cost: 9583.299612466562


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[1, 1, 2, 2, 2], num_stage=5, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1), (2, 1), (2, 1)]
stage_memory_capacity: [16384, 16384, 32768, 163840, 163840]
stage_compute_performance: [0.09167753652499377, 0.09167753652499377, 0.2722230834434679, 0.2722109217532723, 0.2722109217532723]
layer_partition: [0, 2, 3, 5, 7, 10]
stage_memory_demand: [16100.001, 9000.001, 15000.001, 15000.001, 32500.001], memory_state: [283.9989999999998, 7383.999, 17767.999, 148839.999, 131339.999]
layer_partition: [0, 2, 3, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 2, 2, 2], num_stage: 5, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (2, 1), (2, 1), (2, 1)], layer_partition: [0, 2, 3, 5, 7, 10]
execution_cost: 6176.359256744385, fb_sync_cost: 3458.1863403320312, parameter_upate_costs: 12.180919647216797, dp_cost: 16.543902853260867, pp_cost: 0.9878260869565217
cost: 9697.08066387674


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[1, 1, 2, 2, 2], num_stage=5, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[1, 1, 2, 2, 2], num_stage=5, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[1, 1, 2, 2, 2], num_stage=5, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[1, 1, 2, 2, 2], num_stage=5, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[1, 1, 2, 2, 2], num_stage=5, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[2, 1, 1, 2, 2], num_stage=5, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 2), (1, 2)]
stage_memory_capacity: [32768, 16384, 16384, 163840, 163840]
stage_compute_performance: [0.1580223247860017, 0.11676081282436179, 0.11676081282436179, 0.3042280247826374, 0.3042280247826374]
layer_partition: [0, 2, 3, 4, 7, 10]
stage_memory_demand: [32487.501, 6000.001, 6000.001, 31792.501, 52355.001], memory_state: [280.4989999999998, 10383.999, 10383.999, 132047.499, 111484.99900000001]
layer_partition: [0, 2, 3, 4, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 1, 1, 2, 2], num_stage: 5, batches: 128, gbs: 128, strategies: [(1, 2), (1, 1), (1, 1), (1, 2), (1, 2)], layer_partition: [0, 2, 3, 4, 7, 10]
execution_cost: 6622.510997276306, fb_sync_cost: 4016.9158935546875, parameter_upate_costs: 6.090459823608398, dp_cost: 0.0, pp_cost: 0.3339130434782609
cost: 10777.140936549642


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[2, 1, 1, 2, 2], num_stage=5, batches=64, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1), (2, 1), (2, 1)]
stage_memory_capacity: [32768, 16384, 16384, 163840, 163840]
stage_compute_performance: [0.1817678374558298, 0.13663296228036942, 0.13663296228036942, 0.2724831189917157, 0.2724831189917157]
layer_partition: [0, 3, 4, 5, 7, 10]
stage_memory_demand: [19500.001, 7500.001, 7500.001, 12000.001, 19500.001], memory_state: [13267.999, 8883.999, 8883.999, 151839.999, 144339.999]
layer_partition: [0, 3, 4, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 1, 1, 2, 2], num_stage: 5, batches: 64, gbs: 128, strategies: [(2, 1), (1, 1), (1, 1), (2, 1), (2, 1)], layer_partition: [0, 3, 4, 5, 7, 10]
execution_cost: 5921.66291305542, fb_sync_cost: 3586.126708984375, parameter_upate_costs: 12.180919647216797, dp_cost: 16.543902853260867, pp_cost: 0.5008695652173913
cost: 9602.660150531272


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[2, 1, 1, 2, 2], num_stage=5, batches=32, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1), (2, 1), (2, 1)]
stage_memory_capacity: [32768, 16384, 16384, 163840, 163840]
stage_compute_performance: [0.27222308344346785, 0.09167753652499376, 0.09167753652499376, 0.2722109217532723, 0.2722109217532723]
layer_partition: [0, 3, 4, 5, 7, 10]
stage_memory_demand: [19000.001, 9000.001, 9000.001, 15000.001, 32500.001], memory_state: [13767.999, 7383.999, 7383.999, 148839.999, 131339.999]
layer_partition: [0, 3, 4, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 1, 1, 2, 2], num_stage: 5, batches: 32, gbs: 128, strategies: [(2, 1), (1, 1), (1, 1), (2, 1), (2, 1)], layer_partition: [0, 3, 4, 5, 7, 10]
execution_cost: 6124.509256744384, fb_sync_cost: 3458.1863403320312, parameter_upate_costs: 12.180919647216797, dp_cost: 16.543902853260867, pp_cost: 1.0017391304347827
cost: 9645.244576920219


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[2, 1, 1, 2, 2], num_stage=5, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[2, 1, 1, 2, 2], num_stage=5, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[2, 1, 1, 2, 2], num_stage=5, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[2, 1, 1, 2, 2], num_stage=5, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[2, 1, 1, 2, 2], num_stage=5, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[2, 2, 1, 1, 2], num_stage=5, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 2), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [32768, 32768, 81920, 81920, 163840]
stage_compute_performance: [0.16285278923198981, 0.16285278923198981, 0.18038334064558972, 0.18038334064558972, 0.31352774024484087]
layer_partition: [0, 2, 3, 4, 6, 10]
stage_memory_demand: [32487.501, 10597.501, 6000.001, 12000.001, 62952.501], memory_state: [280.4989999999998, 22170.499, 75919.999, 69919.999, 100887.49900000001]
layer_partition: [0, 2, 3, 4, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 1, 1, 2], num_stage: 5, batches: 128, gbs: 128, strategies: [(1, 2), (1, 2), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 2, 3, 4, 6, 10]
execution_cost: 7701.150990943908, fb_sync_cost: 4016.9158935546875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.3408695652173913
cost: 11857.81804001352


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[2, 2, 1, 1, 2], num_stage=5, batches=64, gbs=128)
valid_strategies: [(2, 1), (2, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [32768, 32768, 81920, 81920, 163840]
stage_compute_performance: [0.19990468800045877, 0.19990468800045877, 0.15025952793057093, 0.15025952793057093, 0.29967156813794055]
layer_partition: [0, 3, 5, 6, 7, 10]
stage_memory_demand: [19500.001, 12000.001, 7500.001, 7500.001, 19500.001], memory_state: [13267.999, 20767.999, 74419.999, 74419.999, 144339.999]
layer_partition: [0, 3, 5, 6, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 1, 1, 2], num_stage: 5, batches: 64, gbs: 128, strategies: [(2, 1), (2, 1), (1, 1), (1, 1), (2, 1)], layer_partition: [0, 3, 5, 6, 7, 10]
execution_cost: 5951.17743396759, fb_sync_cost: 3586.126708984375, parameter_upate_costs: 12.180919647216797, dp_cost: 16.543902853260867, pp_cost: 0.5147826086956522
cost: 9632.18858448692


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[2, 2, 1, 1, 2], num_stage=5, batches=32, gbs=128)
valid_strategies: [(2, 1), (2, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [32768, 32768, 81920, 81920, 163840]
stage_compute_performance: [0.2493590594025154, 0.2493590594025154, 0.1259669810109827, 0.1259669810109827, 0.2493479191730038]
layer_partition: [0, 3, 5, 6, 7, 10]
stage_memory_demand: [19000.001, 15000.001, 9000.001, 9000.001, 32500.001], memory_state: [13767.999, 17767.999, 72919.999, 72919.999, 131339.999]
layer_partition: [0, 3, 5, 6, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 1, 1, 2], num_stage: 5, batches: 32, gbs: 128, strategies: [(2, 1), (2, 1), (1, 1), (1, 1), (2, 1)], layer_partition: [0, 3, 5, 6, 7, 10]
execution_cost: 4257.439934082031, fb_sync_cost: 3458.1863403320312, parameter_upate_costs: 12.180919647216797, dp_cost: 16.543902853260867, pp_cost: 1.0295652173913044
cost: 7778.2030803448215


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[2, 2, 1, 1, 2], num_stage=5, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[2, 2, 1, 1, 2], num_stage=5, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[2, 2, 1, 1, 2], num_stage=5, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[2, 2, 1, 1, 2], num_stage=5, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[2, 2, 1, 1, 2], num_stage=5, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 2, 1, 1, 1, 1], num_stage=6, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 2), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [32768, 32768, 81920, 81920, 81920, 81920]
stage_compute_performance: [0.15550681210276332, 0.15550681210276332, 0.1722465939486183, 0.1722465939486183, 0.1722465939486183, 0.1722465939486183]
layer_partition: [0, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [32487.501, 10597.501, 6000.001, 12000.001, 12000.001, 13500.001], memory_state: [280.4989999999998, 22170.499, 75919.999, 69919.999, 69919.999, 68419.999]
layer_partition: [0, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 1, 1, 1, 1], num_stage: 6, batches: 128, gbs: 128, strategies: [(1, 2), (1, 2), (1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 4, 6, 8, 10]
execution_cost: 7739.218689422607, fb_sync_cost: 7172.25341796875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.42782608695652175
cost: 15051.31021942802


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 2, 1, 1, 1, 1], num_stage=6, batches=64, gbs=128)
valid_strategies: [(2, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [32768, 32768, 81920, 81920, 81920, 81920]
stage_compute_performance: [0.19973541468862166, 0.19973541468862166, 0.15013229265568917, 0.15013229265568917, 0.15013229265568917, 0.15013229265568917]
layer_partition: [0, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [19500.001, 12000.001, 7500.001, 7500.001, 7500.001, 25000.001], memory_state: [13267.999, 20767.999, 74419.999, 74419.999, 74419.999, 56919.998999999996]
layer_partition: [0, 3, 5, 6, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 1, 1, 1, 1], num_stage: 6, batches: 64, gbs: 128, strategies: [(2, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 5, 6, 7, 8, 10]
execution_cost: 6010.133818626404, fb_sync_cost: 6916.3726806640625, parameter_upate_costs: 12.180919647216797, dp_cost: 15.2203125, pp_cost: 0.688695652173913
cost: 13020.241263515638


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 2, 1, 1, 1, 1], num_stage=6, batches=32, gbs=128)
valid_strategies: [(2, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [32768, 32768, 81920, 81920, 81920, 81920]
stage_compute_performance: [0.24871586950675417, 0.24871586950675417, 0.12564206524662289, 0.12564206524662289, 0.12564206524662289, 0.12564206524662289]
layer_partition: [0, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [19000.001, 15000.001, 9000.001, 9000.001, 9000.001, 25480.001], memory_state: [13767.999, 17767.999, 72919.999, 72919.999, 72919.999, 56439.998999999996]
layer_partition: [0, 3, 5, 6, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 2, 1, 1, 1, 1], num_stage: 6, batches: 32, gbs: 128, strategies: [(2, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 5, 6, 7, 8, 10]
execution_cost: 4372.249263687134, fb_sync_cost: 6697.303771972656, parameter_upate_costs: 12.180919647216797, dp_cost: 15.2203125, pp_cost: 1.377391304347826
cost: 11131.154077324245


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 2, 1, 1, 1, 1], num_stage=6, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 2, 1, 1, 1, 1], num_stage=6, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 2, 1, 1, 1, 1], num_stage=6, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 2, 1, 1, 1, 1], num_stage=6, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 2, 1, 1, 1, 1], num_stage=6, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 2, 2, 1, 1], num_stage=6, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [16384, 16384, 32768, 163840, 81920, 81920]
stage_compute_performance: [0.11164333239984786, 0.11164333239984786, 0.15109640388696682, 0.2908940908731875, 0.16736142022007494, 0.16736142022007494]
layer_partition: [0, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [13500.001, 6000.001, 10597.501, 21195.001, 12000.001, 13500.001], memory_state: [2883.999, 10383.999, 22170.499, 142644.999, 69919.999, 68419.999]
layer_partition: [0, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 2, 2, 1, 1], num_stage: 6, batches: 128, gbs: 128, strategies: [(1, 1), (1, 1), (1, 2), (1, 2), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 4, 6, 8, 10]
execution_cost: 7738.976326942444, fb_sync_cost: 7172.25341796875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.42086956521739133
cost: 15051.060900426119


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 2, 2, 1, 1], num_stage=6, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [16384, 16384, 32768, 163840, 81920, 81920]
stage_compute_performance: [0.13652775436292594, 0.13652775436292594, 0.18162787550727974, 0.27227330592019056, 0.1365216549233389, 0.1365216549233389]
layer_partition: [0, 2, 3, 5, 7, 8, 10]
stage_memory_demand: [11500.001, 7500.001, 12000.001, 12000.001, 7500.001, 25000.001], memory_state: [4883.999, 8883.999, 20767.999, 151839.999, 74419.999, 56919.998999999996]
layer_partition: [0, 2, 3, 5, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 2, 2, 1, 1], num_stage: 6, batches: 64, gbs: 128, strategies: [(1, 1), (1, 1), (2, 1), (2, 1), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 5, 7, 8, 10]
execution_cost: 5961.265716171265, fb_sync_cost: 6916.3726806640625, parameter_upate_costs: 8.120613098144531, dp_cost: 8.39164402173913, pp_cost: 0.6678260869565218
cost: 12960.463316467949


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 2, 2, 1, 1], num_stage=6, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [16384, 16384, 32768, 163840, 81920, 81920]
stage_compute_performance: [0.09141944479199314, 0.09141944479199314, 0.2714567176571278, 0.27144459020467265, 0.13712990127710664, 0.13712990127710664]
layer_partition: [0, 2, 3, 5, 7, 8, 10]
stage_memory_demand: [16100.001, 9000.001, 15000.001, 15000.001, 9000.001, 25480.001], memory_state: [283.9989999999998, 7383.999, 17767.999, 148839.999, 72919.999, 56439.998999999996]
layer_partition: [0, 2, 3, 5, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 2, 2, 1, 1], num_stage: 6, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (2, 1), (2, 1), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 5, 7, 8, 10]
execution_cost: 6292.174657821655, fb_sync_cost: 6697.303771972656, parameter_upate_costs: 8.120613098144531, dp_cost: 8.39164402173913, pp_cost: 1.3356521739130436
cost: 13040.148757301


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 2, 2, 1, 1], num_stage=6, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 2, 2, 1, 1], num_stage=6, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 2, 2, 1, 1], num_stage=6, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 2, 2, 1, 1], num_stage=6, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 2, 2, 1, 1], num_stage=6, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[2, 1, 1, 2, 1, 1], num_stage=6, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [32768, 16384, 16384, 163840, 81920, 81920]
stage_compute_performance: [0.15109640388696682, 0.11164333239984786, 0.11164333239984786, 0.2908940908731875, 0.16736142022007494, 0.16736142022007494]
layer_partition: [0, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [32487.501, 6000.001, 6000.001, 21195.001, 12000.001, 13500.001], memory_state: [280.4989999999998, 10383.999, 10383.999, 142644.999, 69919.999, 68419.999]
layer_partition: [0, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 1, 1, 2, 1, 1], num_stage: 6, batches: 128, gbs: 128, strategies: [(1, 2), (1, 1), (1, 1), (1, 2), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 4, 6, 8, 10]
execution_cost: 7740.3940834808345, fb_sync_cost: 7172.25341796875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.42086956521739133
cost: 15052.47865696451


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[2, 1, 1, 2, 1, 1], num_stage=6, batches=64, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [32768, 16384, 16384, 163840, 81920, 81920]
stage_compute_performance: [0.18162787550727974, 0.13652775436292597, 0.13652775436292597, 0.2722733059201906, 0.13652165492333893, 0.13652165492333893]
layer_partition: [0, 3, 4, 5, 7, 8, 10]
stage_memory_demand: [19500.001, 7500.001, 7500.001, 12000.001, 7500.001, 25000.001], memory_state: [13267.999, 8883.999, 8883.999, 151839.999, 74419.999, 56919.998999999996]
layer_partition: [0, 3, 4, 5, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 1, 1, 2, 1, 1], num_stage: 6, batches: 64, gbs: 128, strategies: [(2, 1), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 4, 5, 7, 8, 10]
execution_cost: 5980.619297714234, fb_sync_cost: 6916.3726806640625, parameter_upate_costs: 12.180919647216797, dp_cost: 15.2203125, pp_cost: 0.6747826086956522
cost: 12990.71282955999


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[2, 1, 1, 2, 1, 1], num_stage=6, batches=32, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [32768, 16384, 16384, 163840, 81920, 81920]
stage_compute_performance: [0.27145671765712776, 0.09141944479199313, 0.09141944479199313, 0.2714445902046726, 0.13712990127710661, 0.13712990127710661]
layer_partition: [0, 3, 4, 5, 7, 8, 10]
stage_memory_demand: [19000.001, 9000.001, 9000.001, 15000.001, 9000.001, 25480.001], memory_state: [13767.999, 7383.999, 7383.999, 148839.999, 72919.999, 56439.998999999996]
layer_partition: [0, 3, 4, 5, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 1, 1, 2, 1, 1], num_stage: 6, batches: 32, gbs: 128, strategies: [(2, 1), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 4, 5, 7, 8, 10]
execution_cost: 6240.324657821655, fb_sync_cost: 6697.303771972656, parameter_upate_costs: 12.180919647216797, dp_cost: 15.2203125, pp_cost: 1.3495652173913044
cost: 12999.20164537181


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[2, 1, 1, 2, 1, 1], num_stage=6, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[2, 1, 1, 2, 1, 1], num_stage=6, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[2, 1, 1, 2, 1, 1], num_stage=6, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[2, 1, 1, 2, 1, 1], num_stage=6, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[2, 1, 1, 2, 1, 1], num_stage=6, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[1, 1, 2, 1, 1, 2], num_stage=6, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [16384, 16384, 32768, 81920, 81920, 163840]
stage_compute_performance: [0.11164333239984786, 0.11164333239984786, 0.15109640388696682, 0.16736142022007494, 0.16736142022007494, 0.2908940908731875]
layer_partition: [0, 2, 3, 4, 5, 7, 10]
stage_memory_demand: [13500.001, 6000.001, 10597.501, 6000.001, 12000.001, 52355.001], memory_state: [2883.999, 10383.999, 22170.499, 75919.999, 69919.999, 111484.99900000001]
layer_partition: [0, 2, 3, 4, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 2, 1, 1, 2], num_stage: 6, batches: 128, gbs: 128, strategies: [(1, 1), (1, 1), (1, 2), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 2, 3, 4, 5, 7, 10]
execution_cost: 7738.9191064834595, fb_sync_cost: 4016.9158935546875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.42086956521739133
cost: 11895.666155553072


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[1, 1, 2, 1, 1, 2], num_stage=6, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [16384, 16384, 32768, 81920, 81920, 163840]
stage_compute_performance: [0.13652775436292594, 0.13652775436292594, 0.1816278755072797, 0.1365216549233389, 0.1365216549233389, 0.27227330592019056]
layer_partition: [0, 2, 3, 5, 6, 7, 10]
stage_memory_demand: [11500.001, 7500.001, 12000.001, 7500.001, 7500.001, 19500.001], memory_state: [4883.999, 8883.999, 20767.999, 74419.999, 74419.999, 144339.999]
layer_partition: [0, 2, 3, 5, 6, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 2, 1, 1, 2], num_stage: 6, batches: 64, gbs: 128, strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (2, 1)], layer_partition: [0, 2, 3, 5, 6, 7, 10]
execution_cost: 5961.02014503479, fb_sync_cost: 3586.126708984375, parameter_upate_costs: 12.180919647216797, dp_cost: 16.543902853260867, pp_cost: 0.7547826086956522
cost: 9642.27129555412


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[1, 1, 2, 1, 1, 2], num_stage=6, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [16384, 16384, 32768, 81920, 81920, 163840]
stage_compute_performance: [0.09141944479199314, 0.09141944479199314, 0.2714567176571278, 0.13712990127710664, 0.13712990127710664, 0.27144459020467265]
layer_partition: [0, 2, 3, 5, 6, 7, 10]
stage_memory_demand: [16100.001, 9000.001, 15000.001, 9000.001, 9000.001, 32500.001], memory_state: [283.9989999999998, 7383.999, 17767.999, 72919.999, 72919.999, 131339.999]
layer_partition: [0, 2, 3, 5, 6, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 2, 1, 1, 2], num_stage: 6, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (2, 1)], layer_partition: [0, 2, 3, 5, 6, 7, 10]
execution_cost: 6291.763862609863, fb_sync_cost: 3458.1863403320312, parameter_upate_costs: 12.180919647216797, dp_cost: 16.543902853260867, pp_cost: 1.5095652173913043
cost: 9813.007008872653


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[1, 1, 2, 1, 1, 2], num_stage=6, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[1, 1, 2, 1, 1, 2], num_stage=6, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[1, 1, 2, 1, 1, 2], num_stage=6, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[1, 1, 2, 1, 1, 2], num_stage=6, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[1, 1, 2, 1, 1, 2], num_stage=6, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[1, 1, 1, 1, 2, 2], num_stage=6, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 2), (1, 2)]
stage_memory_capacity: [16384, 16384, 16384, 16384, 163840, 163840]
stage_compute_performance: [0.10856428519358498, 0.10856428519358498, 0.10856428519358498, 0.10856428519358498, 0.28287142961283007, 0.28287142961283007]
layer_partition: [0, 2, 3, 4, 5, 7, 10]
stage_memory_demand: [13500.001, 6000.001, 6000.001, 6000.001, 21195.001, 52355.001], memory_state: [2883.999, 10383.999, 10383.999, 10383.999, 142644.999, 111484.99900000001]
layer_partition: [0, 2, 3, 4, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 1, 1, 2, 2], num_stage: 6, batches: 128, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 2), (1, 2)], layer_partition: [0, 2, 3, 4, 5, 7, 10]
execution_cost: 5905.9741978645325, fb_sync_cost: 4016.9158935546875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.41391304347826086
cost: 10062.714290412405


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[1, 1, 1, 1, 2, 2], num_stage=6, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (2, 1)]
stage_memory_capacity: [16384, 16384, 16384, 16384, 163840, 163840]
stage_compute_performance: [0.1251792961385529, 0.1251792961385529, 0.1251792961385529, 0.1251792961385529, 0.2496414077228942, 0.2496414077228942]
layer_partition: [0, 2, 3, 4, 5, 7, 10]
stage_memory_demand: [11500.001, 7500.001, 7500.001, 7500.001, 12000.001, 19500.001], memory_state: [4883.999, 8883.999, 8883.999, 8883.999, 151839.999, 144339.999]
layer_partition: [0, 2, 3, 4, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 1, 1, 2, 2], num_stage: 6, batches: 64, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (2, 1)], layer_partition: [0, 2, 3, 4, 5, 7, 10]
execution_cost: 4102.382058563233, fb_sync_cost: 3586.126708984375, parameter_upate_costs: 12.180919647216797, dp_cost: 16.543902853260867, pp_cost: 0.7408695652173913
cost: 7783.6192960390845


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[1, 1, 1, 1, 2, 2], num_stage=6, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (2, 1)]
stage_memory_capacity: [16384, 16384, 16384, 16384, 163840, 163840]
stage_compute_performance: [0.10061938069432236, 0.10061938069432236, 0.10061938069432236, 0.10061938069432236, 0.29876123861135523, 0.29876123861135523]
layer_partition: [0, 2, 3, 3, 4, 7, 10]
stage_memory_demand: [16100.001, 9000.001, 0.001, 9000.001, 22500.001, 32500.001], memory_state: [283.9989999999998, 7383.999, 16383.999, 7383.999, 141339.999, 131339.999]
layer_partition: [0, 2, 3, 3, 4, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 1, 1, 2, 2], num_stage: 6, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (2, 1)], layer_partition: [0, 2, 3, 3, 4, 7, 10]
execution_cost: 6295.458989562988, fb_sync_cost: 3458.1863403320312, parameter_upate_costs: 12.180919647216797, dp_cost: 16.543902853260867, pp_cost: 1.4817391304347827
cost: 9816.67430973882


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[1, 1, 1, 1, 2, 2], num_stage=6, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[1, 1, 1, 1, 2, 2], num_stage=6, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[1, 1, 1, 1, 2, 2], num_stage=6, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[1, 1, 1, 1, 2, 2], num_stage=6, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[1, 1, 1, 1, 2, 2], num_stage=6, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[2, 1, 1, 1, 1, 2], num_stage=6, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [32768, 16384, 16384, 81920, 81920, 163840]
stage_compute_performance: [0.15109640388696682, 0.11164333239984786, 0.11164333239984786, 0.16736142022007494, 0.16736142022007494, 0.2908940908731875]
layer_partition: [0, 2, 3, 4, 5, 7, 10]
stage_memory_demand: [32487.501, 6000.001, 6000.001, 6000.001, 12000.001, 52355.001], memory_state: [280.4989999999998, 10383.999, 10383.999, 75919.999, 69919.999, 111484.99900000001]
layer_partition: [0, 2, 3, 4, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 1, 1, 1, 1, 2], num_stage: 6, batches: 128, gbs: 128, strategies: [(1, 2), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 2, 3, 4, 5, 7, 10]
execution_cost: 7740.33686302185, fb_sync_cost: 4016.9158935546875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.42086956521739133
cost: 11897.083912091462


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[2, 1, 1, 1, 1, 2], num_stage=6, batches=64, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [32768, 16384, 16384, 81920, 81920, 163840]
stage_compute_performance: [0.18162787550727974, 0.13652775436292597, 0.13652775436292597, 0.13652165492333893, 0.13652165492333893, 0.2722733059201906]
layer_partition: [0, 3, 4, 5, 6, 7, 10]
stage_memory_demand: [19500.001, 7500.001, 7500.001, 7500.001, 7500.001, 19500.001], memory_state: [13267.999, 8883.999, 8883.999, 74419.999, 74419.999, 144339.999]
layer_partition: [0, 3, 4, 5, 6, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 1, 1, 1, 1, 2], num_stage: 6, batches: 64, gbs: 128, strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)], layer_partition: [0, 3, 4, 5, 6, 7, 10]
execution_cost: 5980.373726577759, fb_sync_cost: 3586.126708984375, parameter_upate_costs: 12.180919647216797, dp_cost: 16.543902853260867, pp_cost: 0.7617391304347826
cost: 9661.631833618829


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[2, 1, 1, 1, 1, 2], num_stage=6, batches=32, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [32768, 16384, 16384, 81920, 81920, 163840]
stage_compute_performance: [0.2714567176571278, 0.09141944479199314, 0.09141944479199314, 0.13712990127710664, 0.13712990127710664, 0.27144459020467265]
layer_partition: [0, 3, 4, 5, 6, 7, 10]
stage_memory_demand: [19000.001, 9000.001, 9000.001, 9000.001, 9000.001, 32500.001], memory_state: [13767.999, 7383.999, 7383.999, 72919.999, 72919.999, 131339.999]
layer_partition: [0, 3, 4, 5, 6, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 1, 1, 1, 1, 2], num_stage: 6, batches: 32, gbs: 128, strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)], layer_partition: [0, 3, 4, 5, 6, 7, 10]
execution_cost: 6239.913862609863, fb_sync_cost: 3458.1863403320312, parameter_upate_costs: 12.180919647216797, dp_cost: 16.543902853260867, pp_cost: 1.5234782608695652
cost: 9761.170921916131


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[2, 1, 1, 1, 1, 2], num_stage=6, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[2, 1, 1, 1, 1, 2], num_stage=6, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[2, 1, 1, 1, 1, 2], num_stage=6, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[2, 1, 1, 1, 1, 2], num_stage=6, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[2, 1, 1, 1, 1, 2], num_stage=6, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 1, 1, 1, 1, 1, 1], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 2), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [32768, 16384, 16384, 81920, 81920, 81920, 81920]
stage_compute_performance: [0.1447521003322144, 0.10695560210059711, 0.10695560210059711, 0.16033417386664783, 0.16033417386664783, 0.16033417386664783, 0.16033417386664783]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 10]
stage_memory_demand: [32487.501, 6000.001, 6000.001, 6000.001, 12000.001, 6000.001, 13500.001], memory_state: [280.4989999999998, 10383.999, 10383.999, 75919.999, 69919.999, 75919.999, 68419.999]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 1, 1, 1, 1, 1, 1], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 2), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 4, 5, 7, 8, 10]
execution_cost: 7765.734402160644, fb_sync_cost: 7172.25341796875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.5078260869565218
cost: 15077.905932166057


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 1, 1, 1, 1, 1, 1], num_stage=7, batches=64, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [32768, 16384, 16384, 81920, 81920, 81920, 81920]
stage_compute_performance: [0.18148812893538868, 0.13642270834184073, 0.13642270834184073, 0.1364166135952325, 0.1364166135952325, 0.1364166135952325, 0.1364166135952325]
layer_partition: [0, 3, 4, 5, 6, 7, 8, 10]
stage_memory_demand: [19500.001, 7500.001, 7500.001, 7500.001, 7500.001, 7500.001, 25000.001], memory_state: [13267.999, 8883.999, 8883.999, 74419.999, 74419.999, 74419.999, 56919.998999999996]
layer_partition: [0, 3, 4, 5, 6, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 1, 1, 1, 1, 1, 1], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 4, 5, 6, 7, 8, 10]
execution_cost: 6039.3301112365725, fb_sync_cost: 6916.3726806640625, parameter_upate_costs: 12.180919647216797, dp_cost: 15.2203125, pp_cost: 0.9356521739130435
cost: 13049.684512647547


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 1, 1, 1, 1, 1, 1], num_stage=7, batches=32, gbs=128)
valid_strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [32768, 16384, 16384, 81920, 81920, 81920, 81920]
stage_compute_performance: [0.2706946547221992, 0.09116280214557418, 0.09116280214557418, 0.1367449352466631, 0.1367449352466631, 0.1367449352466631, 0.1367449352466631]
layer_partition: [0, 3, 4, 5, 6, 7, 8, 10]
stage_memory_demand: [19000.001, 9000.001, 9000.001, 9000.001, 9000.001, 9000.001, 25480.001], memory_state: [13767.999, 7383.999, 7383.999, 72919.999, 72919.999, 72919.999, 56439.998999999996]
layer_partition: [0, 3, 4, 5, 6, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [2, 1, 1, 1, 1, 1, 1], num_stage: 7, batches: 32, gbs: 128, strategies: [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 3, 4, 5, 6, 7, 8, 10]
execution_cost: 6355.729263687133, fb_sync_cost: 6697.303771972656, parameter_upate_costs: 12.180919647216797, dp_cost: 15.2203125, pp_cost: 1.871304347826087
cost: 13115.127990367722


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 1, 1, 1, 1, 1, 1], num_stage=7, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 1, 1, 1, 1, 1, 1], num_stage=7, batches=8, gbs=128)
invalid_strategy: dp_deg(2), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 1, 1, 1, 1, 1, 1], num_stage=7, batches=4, gbs=128)
invalid_strategy: dp_deg(2), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 1, 1, 1, 1, 1, 1], num_stage=7, batches=2, gbs=128)
invalid_strategy: dp_deg(2), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[2, 1, 1, 1, 1, 1, 1], num_stage=7, batches=1, gbs=128)
invalid_strategy: dp_deg(2), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 2, 1, 1, 1, 1], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 2), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [16384, 16384, 32768, 81920, 81920, 81920, 81920]
stage_compute_performance: [0.10695560210059711, 0.10695560210059711, 0.1447521003322144, 0.16033417386664783, 0.16033417386664783, 0.16033417386664783, 0.16033417386664783]
layer_partition: [0, 2, 3, 4, 6, 7, 8, 10]
stage_memory_demand: [13500.001, 6000.001, 10597.501, 12000.001, 6000.001, 6000.001, 13500.001], memory_state: [2883.999, 10383.999, 22170.499, 69919.999, 75919.999, 75919.999, 68419.999]
layer_partition: [0, 2, 3, 4, 6, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 2, 1, 1, 1, 1], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 1), (1, 1), (1, 2), (1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 4, 6, 7, 8, 10]
execution_cost: 7764.316645622253, fb_sync_cost: 7172.25341796875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.5078260869565218
cost: 15076.488175627666


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 2, 1, 1, 1, 1], num_stage=7, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [16384, 16384, 32768, 81920, 81920, 81920, 81920]
stage_compute_performance: [0.1364227083418407, 0.1364227083418407, 0.18148812893538865, 0.13641661359523247, 0.13641661359523247, 0.13641661359523247, 0.13641661359523247]
layer_partition: [0, 2, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [11500.001, 7500.001, 12000.001, 7500.001, 7500.001, 7500.001, 25000.001], memory_state: [4883.999, 8883.999, 20767.999, 74419.999, 74419.999, 74419.999, 56919.998999999996]
layer_partition: [0, 2, 3, 5, 6, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 2, 1, 1, 1, 1], num_stage: 7, batches: 64, gbs: 128, strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 5, 6, 7, 8, 10]
execution_cost: 6019.976529693604, fb_sync_cost: 6916.3726806640625, parameter_upate_costs: 8.120613098144531, dp_cost: 7.7203125, pp_cost: 0.928695652173913
cost: 13018.763668033765


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 2, 1, 1, 1, 1], num_stage=7, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [16384, 16384, 32768, 81920, 81920, 81920, 81920]
stage_compute_performance: [0.09116280214557418, 0.09116280214557418, 0.2706946547221992, 0.1367449352466631, 0.1367449352466631, 0.1367449352466631, 0.1367449352466631]
layer_partition: [0, 2, 3, 5, 6, 7, 8, 10]
stage_memory_demand: [16100.001, 9000.001, 15000.001, 9000.001, 9000.001, 9000.001, 25480.001], memory_state: [283.9989999999998, 7383.999, 17767.999, 72919.999, 72919.999, 72919.999, 56439.998999999996]
layer_partition: [0, 2, 3, 5, 6, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 2, 1, 1, 1, 1], num_stage: 7, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 5, 6, 7, 8, 10]
execution_cost: 6407.579263687134, fb_sync_cost: 6697.303771972656, parameter_upate_costs: 8.120613098144531, dp_cost: 7.7203125, pp_cost: 1.857391304347826
cost: 13155.403770775172


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 2, 1, 1, 1, 1], num_stage=7, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 2, 1, 1, 1, 1], num_stage=7, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 2, 1, 1, 1, 1], num_stage=7, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 2, 1, 1, 1, 1], num_stage=7, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[1, 1, 2, 1, 1, 1, 1], num_stage=7, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 2, 1, 1], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 2), (1, 1), (1, 1)]
stage_memory_capacity: [16384, 16384, 16384, 16384, 163840, 81920, 81920]
stage_compute_performance: [0.10412641904134502, 0.10412641904134502, 0.10412641904134502, 0.10412641904134502, 0.2713082756651386, 0.15609302408474063, 0.15609302408474063]
layer_partition: [0, 2, 3, 3, 4, 7, 8, 10]
stage_memory_demand: [13500.001, 6000.001, 0.001, 6000.001, 31792.501, 6000.001, 13500.001], memory_state: [2883.999, 10383.999, 16383.999, 10383.999, 132047.499, 75919.999, 68419.999]
layer_partition: [0, 2, 3, 3, 4, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 1, 1, 2, 1, 1], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 2), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 3, 4, 7, 8, 10]
execution_cost: 6658.252633571625, fb_sync_cost: 7172.25341796875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.5008695652173913
cost: 13970.4172070553


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 2, 1, 1], num_stage=7, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [16384, 16384, 16384, 16384, 163840, 81920, 81920]
stage_compute_performance: [0.12509098194656443, 0.12509098194656443, 0.12509098194656443, 0.12509098194656443, 0.24946528531375786, 0.12508539344999223, 0.12508539344999223]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 10]
stage_memory_demand: [11500.001, 7500.001, 7500.001, 7500.001, 12000.001, 7500.001, 25000.001], memory_state: [4883.999, 8883.999, 8883.999, 8883.999, 151839.999, 74419.999, 56919.998999999996]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 1, 1, 2, 1, 1], num_stage: 7, batches: 64, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 4, 5, 7, 8, 10]
execution_cost: 4163.168751068115, fb_sync_cost: 6916.3726806640625, parameter_upate_costs: 8.120613098144531, dp_cost: 8.39164402173913, pp_cost: 0.9147826086956522
cost: 11162.613307886539


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 2, 1, 1], num_stage=7, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)]
stage_memory_capacity: [16384, 16384, 16384, 16384, 163840, 81920, 81920]
stage_compute_performance: [0.10030857263612333, 0.10030857263612333, 0.10030857263612333, 0.10030857263612333, 0.2978383806112645, 0.150463664422121, 0.150463664422121]
layer_partition: [0, 2, 3, 3, 4, 7, 8, 10]
stage_memory_demand: [16100.001, 9000.001, 0.001, 9000.001, 22500.001, 9000.001, 25480.001], memory_state: [283.9989999999998, 7383.999, 16383.999, 7383.999, 141339.999, 72919.999, 56439.998999999996]
layer_partition: [0, 2, 3, 3, 4, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 1, 1, 2, 1, 1], num_stage: 7, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 3, 4, 7, 8, 10]
execution_cost: 6411.274390640258, fb_sync_cost: 6697.303771972656, parameter_upate_costs: 12.180919647216797, dp_cost: 12.587466032608695, pp_cost: 1.8295652173913044
cost: 13167.99853172302


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 2, 1, 1], num_stage=7, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 2, 1, 1], num_stage=7, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 2, 1, 1], num_stage=7, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 2, 1, 1], num_stage=7, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[1, 1, 1, 1, 2, 1, 1], num_stage=7, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[1, 1, 1, 1, 1, 1, 2], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(2), batches(128), mbs(0)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)]
stage_memory_capacity: [16384, 16384, 16384, 16384, 81920, 81920, 163840]
stage_compute_performance: [0.10412641904134502, 0.10412641904134502, 0.10412641904134502, 0.10412641904134502, 0.15609302408474063, 0.15609302408474063, 0.2713082756651386]
layer_partition: [0, 2, 3, 3, 4, 6, 7, 10]
stage_memory_demand: [13500.001, 6000.001, 0.001, 6000.001, 12000.001, 6000.001, 52355.001], memory_state: [2883.999, 10383.999, 16383.999, 10383.999, 69919.999, 75919.999, 111484.99900000001]
layer_partition: [0, 2, 3, 3, 4, 6, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 1, 1, 1, 1, 2], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)], layer_partition: [0, 2, 3, 3, 4, 6, 7, 10]
execution_cost: 7750.680960178375, fb_sync_cost: 4016.9158935546875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.5008695652173913
cost: 11907.508009247988


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[1, 1, 1, 1, 1, 1, 2], num_stage=7, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [16384, 16384, 16384, 16384, 81920, 81920, 163840]
stage_compute_performance: [0.12509098194656443, 0.12509098194656443, 0.12509098194656443, 0.12509098194656443, 0.12508539344999223, 0.12508539344999223, 0.24946528531375786]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 10]
stage_memory_demand: [11500.001, 7500.001, 7500.001, 7500.001, 15000.001, 7500.001, 13500.001], memory_state: [4883.999, 8883.999, 8883.999, 8883.999, 66919.999, 74419.999, 150339.999]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 1, 1, 1, 1, 2], num_stage: 7, batches: 64, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)], layer_partition: [0, 2, 3, 4, 5, 7, 8, 10]
execution_cost: 7859.366856880188, fb_sync_cost: 3586.126708984375, parameter_upate_costs: 8.120613098144531, dp_cost: 12.348080842391305, pp_cost: 1.0017391304347827
cost: 11532.608835361316


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[1, 1, 1, 1, 1, 1, 2], num_stage=7, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)]
stage_memory_capacity: [16384, 16384, 16384, 16384, 81920, 81920, 163840]
stage_compute_performance: [0.10030857263612336, 0.10030857263612336, 0.10030857263612336, 0.10030857263612336, 0.15046366442212103, 0.15046366442212103, 0.2978383806112646]
layer_partition: [0, 2, 3, 3, 4, 6, 7, 10]
stage_memory_demand: [16100.001, 9000.001, 0.001, 9000.001, 18000.001, 9000.001, 32500.001], memory_state: [283.9989999999998, 7383.999, 16383.999, 7383.999, 63919.998999999996, 72919.999, 131339.999]
layer_partition: [0, 2, 3, 3, 4, 6, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 1, 1, 1, 1, 2], num_stage: 7, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)], layer_partition: [0, 2, 3, 3, 4, 6, 7, 10]
execution_cost: 8221.34323638916, fb_sync_cost: 3458.1863403320312, parameter_upate_costs: 12.180919647216797, dp_cost: 16.543902853260867, pp_cost: 2.0034782608695654
cost: 11743.080295695429


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[1, 1, 1, 1, 1, 1, 2], num_stage=7, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[1, 1, 1, 1, 1, 1, 2], num_stage=7, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[1, 1, 1, 1, 1, 1, 2], num_stage=7, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[1, 1, 1, 1, 1, 1, 2], num_stage=7, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[1, 1, 1, 1, 1, 1, 2], num_stage=7, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
invalid_strategy: dp_deg(1), batches(1), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[1, 1, 1, 1, 1, 1, 1, 1], num_stage=8, batches=128, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [16384, 16384, 16384, 16384, 81920, 81920, 81920, 81920]
stage_compute_performance: [0.1000371242348828, 0.1000371242348828, 0.1000371242348828, 0.1000371242348828, 0.14996287576511716, 0.14996287576511716, 0.14996287576511716, 0.14996287576511716]
layer_partition: [0, 2, 3, 3, 4, 6, 7, 8, 10]
stage_memory_demand: [13500.001, 6000.001, 0.001, 6000.001, 12000.001, 6000.001, 6000.001, 13500.001], memory_state: [2883.999, 10383.999, 16383.999, 10383.999, 69919.999, 75919.999, 75919.999, 68419.999]
layer_partition: [0, 2, 3, 3, 4, 6, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 1, 1, 1, 1, 1, 1], num_stage: 8, batches: 128, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 3, 4, 6, 7, 8, 10]
execution_cost: 7776.078499317169, fb_sync_cost: 7172.25341796875, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 0.5878260869565217
cost: 15088.330029322582


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[1, 1, 1, 1, 1, 1, 1, 1], num_stage=8, batches=64, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [16384, 16384, 16384, 16384, 81920, 81920, 81920, 81920]
stage_compute_performance: [0.12500279227832933, 0.12500279227832933, 0.12500279227832933, 0.12500279227832933, 0.12499720772167071, 0.12499720772167071, 0.12499720772167071, 0.12499720772167071]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [11500.001, 7500.001, 7500.001, 7500.001, 15000.001, 7500.001, 7500.001, 17500.001], memory_state: [4883.999, 8883.999, 8883.999, 8883.999, 66919.999, 74419.999, 74419.999, 64419.998999999996]
layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 1, 1, 1, 1, 1, 1], num_stage: 8, batches: 64, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 4, 5, 7, 8, 9, 10]
execution_cost: 7888.967834777832, fb_sync_cost: 6916.3726806640625, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 3.1756521739130434
cost: 14882.281617139733


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[1, 1, 1, 1, 1, 1, 1, 1], num_stage=8, batches=32, gbs=128)
valid_strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)]
stage_memory_capacity: [16384, 16384, 16384, 16384, 81920, 81920, 81920, 81920]
stage_compute_performance: [0.09999967880498038, 0.09999967880498038, 0.09999967880498038, 0.09999967880498038, 0.1500003211950196, 0.1500003211950196, 0.1500003211950196, 0.1500003211950196]
layer_partition: [0, 2, 3, 3, 4, 6, 7, 8, 10]
stage_memory_demand: [16100.001, 9000.001, 0.001, 9000.001, 18000.001, 9000.001, 9000.001, 25480.001], memory_state: [283.9989999999998, 7383.999, 16383.999, 7383.999, 63919.998999999996, 72919.999, 72919.999, 56439.998999999996]
layer_partition: [0, 2, 3, 3, 4, 6, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [1, 1, 1, 1, 1, 1, 1, 1], num_stage: 8, batches: 32, gbs: 128, strategies: [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)], layer_partition: [0, 2, 3, 3, 4, 6, 7, 8, 10]
execution_cost: 8337.158637466431, fb_sync_cost: 6697.303771972656, parameter_upate_costs: 8.120613098144531, dp_cost: 0.0, pp_cost: 2.351304347826087
cost: 15077.75674509795


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[1, 1, 1, 1, 1, 1, 1, 1], num_stage=8, batches=16, gbs=128)
invalid_strategy: dp_deg(1), batches(16), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[1, 1, 1, 1, 1, 1, 1, 1], num_stage=8, batches=8, gbs=128)
invalid_strategy: dp_deg(1), batches(8), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[1, 1, 1, 1, 1, 1, 1, 1], num_stage=8, batches=4, gbs=128)
invalid_strategy: dp_deg(1), batches(4), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[1, 1, 1, 1, 1, 1, 1, 1], num_stage=8, batches=2, gbs=128)
invalid_strategy: dp_deg(1), batches(2), mbs(0)


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[1, 1, 1, 1, 1, 1, 1, 1], num_stage=8, batches=1, gbs=128)
invalid_strategy: dp_deg(1), batches(1), mbs(0)
len(costs): 112
rank, cost, node_sequence, device_groups, strategies(dp_deg, tp_deg), batches(number of batch), layer_partition
1, 5577.683679351805, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4], [(4, 1), (4, 1)], 16, [0, 5, 10]
2, 5817.201253283956, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4], [(4, 1), (4, 1)], 16, [0, 5, 10]
3, 5875.607483843929, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [2, 2, 4], [(2, 1), (2, 1), (2, 2)], 64, [0, 4, 7, 10]
4, 5910.1404128298545, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 4], [(2, 1), (2, 1), (4, 1)], 32, [0, 3, 5, 10]
5, 6368.7456838989265, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4], [(2, 2), (2, 2)], 64, [0, 4, 10]
6, 6385.8300601295805, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4], [(2, 2), (2, 2)], 64, [0, 6, 10]
7, 6666.514083713034, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 1, 1, 4], [(1, 1), (1, 1), (1, 1), (1, 1), (2, 2)], 64, [0, 2, 3, 4, 5, 10]
8, 6761.53112927727, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4], [(4, 1), (4, 1)], 32, [0, 4, 10]
9, 6774.027533874513, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4], [(4, 1), (4, 1)], 8, [0, 4, 10]
10, 6948.288010519277, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4], [(4, 1), (4, 1)], 8, [0, 4, 10]
11, 7101.084667872552, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8], [(2, 4)], 16, [0, 10]
12, 7662.276735348909, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 2, 2], [(2, 1), (2, 1), (2, 1), (2, 1)], 32, [0, 3, 5, 7, 10]
13, 7664.746568155703, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 2, 2], [(4, 1), (2, 1), (2, 1)], 16, [0, 5, 7, 10]
14, 7778.2030803448215, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 1, 1, 2], [(2, 1), (2, 1), (1, 1), (1, 1), (2, 1)], 32, [0, 3, 5, 6, 7, 10]
15, 7783.6192960390845, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 1, 1, 2, 2], [(1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (2, 1)], 64, [0, 2, 3, 4, 5, 7, 10]
16, 7828.47519318954, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [1, 1, 1, 1, 4], [(1, 1), (1, 1), (1, 1), (1, 1), (2, 2)], 64, [0, 2, 4, 5, 6, 10]
17, 7880.8937561400035, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 4], [(2, 1), (2, 1), (4, 1)], 16, [0, 2, 4, 10]
18, 7943.399734498728, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 4], [(2, 1), (2, 1), (2, 2)], 64, [0, 3, 5, 10]
19, 8040.582544630298, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 1, 1, 4], [(1, 1), (1, 1), (1, 1), (1, 1), (4, 1)], 32, [0, 2, 3, 3, 4, 10]
20, 8172.215575467814, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 1, 1, 4], [(1, 1), (1, 1), (1, 1), (1, 1), (1, 4)], 128, [0, 2, 3, 4, 5, 10]
21, 8205.577837912517, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4], [(1, 4), (1, 4)], 32, [0, 6, 10]
22, 8536.198379871534, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4], [(2, 2), (2, 2)], 64, [0, 4, 10]
23, 8580.91588883773, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [2, 2, 4], [(1, 2), (1, 2), (1, 4)], 32, [0, 3, 6, 10]
24, 8923.031786462536, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4], [(1, 4), (1, 4)], 128, [0, 4, 10]
25, 9012.208278689846, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [2, 2, 1, 1, 2], [(2, 1), (2, 1), (1, 1), (1, 1), (1, 2)], 32, [0, 5, 8, 8, 8, 9]
26, 9130.177645924448, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [2, 1, 1, 1, 1, 2], [(1, 2), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)], 32, [0, 4, 6, 8, 8, 8, 9]
27, 9154.617240193247, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [1, 1, 2, 1, 1, 2], [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (1, 2)], 32, [0, 2, 4, 8, 8, 8, 9]
28, 9185.836926618498, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [2, 1, 1, 1, 1, 2], [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)], 32, [0, 5, 6, 8, 8, 8, 9]
29, 9289.05618413909, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [1, 1, 1, 1, 1, 1, 2], [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)], 32, [0, 2, 4, 6, 8, 8, 8, 9]
30, 9438.498351540773, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 2, 2], [(4, 1), (2, 1), (2, 1)], 32, [0, 4, 7, 10]
31, 9448.479338059633, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 4, 2], [(2, 1), (4, 1), (2, 1)], 32, [0, 4, 7, 10]
32, 9498.092453132296, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 4, 2], [(2, 1), (4, 1), (2, 1)], 16, [0, 3, 7, 10]
33, 9520.684637451172, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4], [(4, 1), (4, 1)], 32, [0, 4, 10]
34, 9535.960483801467, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 2, 2], [(2, 2), (2, 1), (2, 1)], 64, [0, 3, 6, 10]
35, 9573.216901399363, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 2, 2], [(2, 1), (2, 1), (2, 1), (2, 1)], 64, [0, 3, 5, 7, 10]
36, 9583.299612466562, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 2, 2, 2], [(1, 1), (1, 1), (2, 1), (2, 1), (2, 1)], 64, [0, 2, 3, 5, 7, 10]
37, 9602.660150531272, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 1, 1, 2, 2], [(2, 1), (1, 1), (1, 1), (2, 1), (2, 1)], 64, [0, 3, 4, 5, 7, 10]
38, 9612.47630421249, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [2, 2, 1, 1, 2], [(1, 2), (1, 2), (1, 1), (1, 1), (1, 2)], 32, [0, 5, 8, 8, 8, 9]
39, 9613.755013375327, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [2, 2, 1, 1, 2], [(1, 2), (2, 1), (1, 1), (1, 1), (1, 2)], 32, [0, 5, 8, 8, 8, 9]
40, 9632.18858448692, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 1, 1, 2], [(2, 1), (2, 1), (1, 1), (1, 1), (2, 1)], 64, [0, 3, 5, 6, 7, 10]
41, 9642.27129555412, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 2, 1, 1, 2], [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (2, 1)], 64, [0, 2, 3, 5, 6, 7, 10]
42, 9645.244576920219, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 1, 1, 2, 2], [(2, 1), (1, 1), (1, 1), (2, 1), (2, 1)], 32, [0, 3, 4, 5, 7, 10]
43, 9661.631833618829, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 1, 1, 1, 1, 2], [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)], 64, [0, 3, 4, 5, 6, 7, 10]
44, 9691.59379506385, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [1, 1, 2, 1, 1, 2], [(1, 1), (1, 1), (1, 2), (1, 1), (1, 1), (1, 2)], 32, [0, 2, 4, 8, 8, 8, 9]
45, 9697.08066387674, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 2, 2, 2], [(1, 1), (1, 1), (2, 1), (2, 1), (2, 1)], 32, [0, 2, 3, 5, 7, 10]
46, 9761.170921916131, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 1, 1, 1, 1, 2], [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)], 32, [0, 3, 4, 5, 6, 7, 10]
47, 9813.007008872653, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 2, 1, 1, 2], [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (2, 1)], 32, [0, 2, 3, 5, 6, 7, 10]
48, 9816.67430973882, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 1, 1, 2, 2], [(1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (2, 1)], 32, [0, 2, 3, 3, 4, 7, 10]
49, 9833.272833454297, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 2, 2], [(2, 1), (2, 1), (2, 1), (2, 1)], 16, [0, 3, 5, 7, 10]
50, 10062.714290412405, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 1, 1, 2, 2], [(1, 1), (1, 1), (1, 1), (1, 1), (1, 2), (1, 2)], 128, [0, 2, 3, 4, 5, 7, 10]
51, 10106.696424276932, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 4, 2], [(2, 1), (2, 2), (2, 1)], 64, [0, 3, 6, 10]
52, 10193.462775447677, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [1, 1, 1, 1, 4], [(1, 1), (1, 1), (1, 1), (1, 1), (1, 4)], 32, [0, 2, 4, 5, 6, 10]
53, 10576.583355006342, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8], [(2, 4)], 64, [0, 10]
54, 10602.54997940064, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4], [(1, 4), (1, 4)], 128, [0, 4, 10]
55, 10690.786005099757, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [2, 2, 4], [(1, 2), (1, 2), (1, 4)], 128, [0, 3, 6, 10]
56, 10696.202376443614, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 4], [(1, 2), (1, 2), (1, 4)], 128, [0, 2, 4, 10]
57, 10704.727229159811, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 2, 2], [(1, 4), (1, 2), (1, 2)], 128, [0, 4, 7, 10]
58, 10777.140936549642, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 1, 1, 2, 2], [(1, 2), (1, 1), (1, 1), (1, 2), (1, 2)], 128, [0, 2, 3, 4, 7, 10]
59, 10777.753333285787, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 2, 2, 2], [(1, 1), (1, 1), (1, 2), (1, 2), (1, 2)], 128, [0, 2, 3, 4, 7, 10]
60, 10784.718373874166, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 2, 2], [(1, 2), (1, 2), (1, 2), (1, 2)], 128, [0, 2, 3, 6, 10]
61, 10860.359139978165, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4], [(1, 4), (1, 4)], 128, [0, 6, 10]
62, 11015.227732328332, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 2, 1, 1], [(2, 1), (2, 1), (2, 1), (1, 1), (1, 1)], 32, [0, 3, 5, 7, 8, 10]
63, 11131.154077324245, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 1, 1, 1, 1], [(2, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)], 32, [0, 3, 5, 6, 7, 8, 10]
64, 11162.613307886539, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 1, 1, 2, 1, 1], [(1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)], 64, [0, 2, 3, 4, 5, 7, 8, 10]
65, 11327.99627868984, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [2, 2, 1, 1, 2], [(2, 1), (2, 1), (1, 1), (1, 1), (2, 1)], 32, [0, 5, 8, 8, 8, 9]
66, 11470.40524019324, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [1, 1, 2, 1, 1, 2], [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (2, 1)], 32, [0, 2, 4, 8, 8, 8, 9]
67, 11501.624926618491, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [2, 1, 1, 1, 1, 2], [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)], 32, [0, 5, 7, 8, 8, 8, 9]
68, 11532.608835361316, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 1, 1, 1, 1, 2], [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)], 64, [0, 2, 3, 4, 5, 7, 8, 10]
69, 11571.600936793451, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8], [(2, 4)], 32, [0, 10]
70, 11608.704340389084, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [1, 1, 1, 1, 1, 1, 2], [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)], 32, [0, 2, 4, 6, 8, 8, 8, 9]
71, 11743.080295695429, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 1, 1, 1, 1, 2], [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)], 32, [0, 2, 3, 3, 4, 6, 7, 10]
72, 11783.754149844955, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [2, 2, 1, 1, 2], [(1, 2), (2, 1), (1, 1), (1, 1), (1, 2)], 64, [0, 4, 7, 7, 7, 9]
73, 11835.282928587876, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [1, 1, 1, 1, 4], [(1, 1), (1, 1), (1, 1), (1, 1), (1, 4)], 128, [0, 2, 4, 5, 6, 10]
74, 11857.81804001352, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 1, 1, 2], [(1, 2), (1, 2), (1, 1), (1, 1), (1, 2)], 128, [0, 2, 3, 4, 6, 10]
75, 11895.666155553072, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 2, 1, 1, 2], [(1, 1), (1, 1), (1, 2), (1, 1), (1, 1), (1, 2)], 128, [0, 2, 3, 4, 5, 7, 10]
76, 11897.083912091462, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 1, 1, 1, 1, 2], [(1, 2), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)], 128, [0, 2, 3, 4, 5, 7, 10]
77, 11907.508009247988, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 1, 1, 1, 1, 2], [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)], 128, [0, 2, 3, 3, 4, 6, 7, 10]
78, 12597.436457980612, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 4, 2], [(1, 2), (1, 4), (1, 2)], 128, [0, 2, 6, 10]
79, 12960.463316467949, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 2, 2, 1, 1], [(1, 1), (1, 1), (2, 1), (2, 1), (1, 1), (1, 1)], 64, [0, 2, 3, 5, 7, 8, 10]
80, 12961.269580428081, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 2, 1, 1], [(2, 1), (2, 1), (2, 1), (1, 1), (1, 1)], 64, [0, 3, 5, 7, 8, 10]
81, 12990.71282955999, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 1, 1, 2, 1, 1], [(2, 1), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)], 64, [0, 3, 4, 5, 7, 8, 10]
82, 12999.20164537181, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 1, 1, 2, 1, 1], [(2, 1), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)], 32, [0, 3, 4, 5, 7, 8, 10]
83, 13018.763668033765, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 2, 1, 1, 1, 1], [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)], 64, [0, 2, 3, 5, 6, 7, 8, 10]
84, 13020.241263515638, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 1, 1, 1, 1], [(2, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)], 64, [0, 3, 5, 6, 7, 8, 10]
85, 13023.700085087652, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 4, 1, 1], [(1, 1), (1, 1), (4, 1), (1, 1), (1, 1)], 32, [0, 2, 3, 7, 8, 10]
86, 13040.148757301, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 2, 2, 1, 1], [(1, 1), (1, 1), (2, 1), (2, 1), (1, 1), (1, 1)], 32, [0, 2, 3, 5, 7, 8, 10]
87, 13049.684512647547, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 1, 1, 1, 1, 1, 1], [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)], 64, [0, 3, 4, 5, 6, 7, 8, 10]
88, 13077.459003897955, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [1, 1, 2, 1, 1, 2], [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (1, 2)], 64, [0, 2, 4, 7, 7, 7, 9]
89, 13115.127990367722, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 1, 1, 1, 1, 1, 1], [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)], 32, [0, 3, 4, 5, 6, 7, 8, 10]
90, 13155.403770775172, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 2, 1, 1, 1, 1], [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1)], 32, [0, 2, 3, 5, 6, 7, 8, 10]
91, 13159.641722577964, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [1, 1, 1, 1, 1, 1, 2], [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)], 64, [0, 2, 4, 6, 8, 8, 8, 9]
92, 13167.99853172302, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 1, 1, 2, 1, 1], [(1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (1, 1), (1, 1)], 32, [0, 2, 3, 3, 4, 7, 8, 10]
93, 13792.525555426553, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [2, 2, 1, 1, 2], [(1, 2), (1, 2), (1, 1), (1, 1), (1, 2)], 64, [0, 5, 8, 8, 8, 9]
94, 13872.564924097474, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [2, 1, 1, 1, 1, 2], [(1, 2), (1, 1), (1, 1), (1, 1), (1, 1), (1, 2)], 64, [0, 5, 7, 8, 8, 8, 9]
95, 13970.4172070553, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 1, 1, 2, 1, 1], [(1, 1), (1, 1), (1, 1), (1, 1), (1, 2), (1, 1), (1, 1)], 128, [0, 2, 3, 3, 4, 7, 8, 10]
96, 14720.18499630223, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 1, 1, 1, 1], [(4, 1), (1, 1), (1, 1), (1, 1), (1, 1)], 32, [0, 4, 6, 7, 8, 10]
97, 14806.479099731445, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 4, 1, 1], [(1, 1), (1, 1), (2, 2), (1, 1), (1, 1)], 64, [0, 2, 4, 7, 8, 10]
98, 14811.278296405957, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 1, 1, 1, 1], [(2, 2), (1, 1), (1, 1), (1, 1), (1, 1)], 64, [0, 4, 5, 6, 8, 10]
99, 14882.281617139733, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 1, 1, 1, 1, 1, 1], [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)], 64, [0, 2, 3, 4, 5, 7, 8, 9, 10]
100, 15005.492224776226, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 1, 1, 1, 1], [(1, 4), (1, 1), (1, 1), (1, 1), (1, 1)], 128, [0, 4, 5, 6, 8, 10]
101, 15013.212784886568, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 2, 1, 1], [(1, 2), (1, 2), (1, 2), (1, 1), (1, 1)], 128, [0, 2, 3, 6, 8, 10]
102, 15033.765229802339, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 4, 1, 1], [(1, 1), (1, 1), (1, 4), (1, 1), (1, 1)], 128, [0, 2, 3, 6, 8, 10]
103, 15051.060900426119, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 2, 2, 1, 1], [(1, 1), (1, 1), (1, 2), (1, 2), (1, 1), (1, 1)], 128, [0, 2, 3, 4, 6, 8, 10]
104, 15051.31021942802, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 2, 1, 1, 1, 1], [(1, 2), (1, 2), (1, 1), (1, 1), (1, 1), (1, 1)], 128, [0, 2, 3, 4, 6, 8, 10]
105, 15052.47865696451, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 1, 1, 2, 1, 1], [(1, 2), (1, 1), (1, 1), (1, 2), (1, 1), (1, 1)], 128, [0, 2, 3, 4, 6, 8, 10]
106, 15076.488175627666, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 2, 1, 1, 1, 1], [(1, 1), (1, 1), (1, 2), (1, 1), (1, 1), (1, 1), (1, 1)], 128, [0, 2, 3, 4, 6, 7, 8, 10]
107, 15077.75674509795, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 1, 1, 1, 1, 1, 1], [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)], 32, [0, 2, 3, 3, 4, 6, 7, 8, 10]
108, 15077.905932166057, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [2, 1, 1, 1, 1, 1, 1], [(1, 2), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)], 128, [0, 2, 3, 4, 5, 7, 8, 10]
109, 15088.330029322582, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [1, 1, 1, 1, 1, 1, 1, 1], [(1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1), (1, 1)], 128, [0, 2, 3, 3, 4, 6, 7, 8, 10]
110, 18242.69214389055, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [1, 1, 2, 1, 1, 2], [(1, 1), (1, 1), (2, 1), (1, 1), (1, 1), (2, 1)], 64, [0, 2, 4, 8, 8, 8, 9]
111, 18272.78530252954, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [2, 1, 1, 1, 1, 2], [(2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1)], 64, [0, 5, 7, 8, 8, 8, 9]
112, 18955.458396117996, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [2, 2, 1, 1, 2], [(1, 2), (2, 1), (1, 1), (1, 1), (2, 1)], 64, [0, 5, 8, 8, 8, 9]
